{"ast":null,"code":"import _classCallCheck from \"/mnt/d/thinkpad_desktop_files/portfolio_web/react-portfolio-site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/mnt/d/thinkpad_desktop_files/portfolio_web/react-portfolio-site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"/mnt/d/thinkpad_desktop_files/portfolio_web/react-portfolio-site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"/mnt/d/thinkpad_desktop_files/portfolio_web/react-portfolio-site/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";\nimport * as React from 'react';\nimport { withInner } from 'typescript-plugin-inner-jsx/withInner';\n/**\n * Provides automatic validation for a wrapped component.\n * @param validate The validation function.\n * @returns A constructor function taking a component to be wrapped with the validation.\n */\n\nexport function withValidation(validate) {\n  return function (Component) {\n    return withInner( /*#__PURE__*/function (_React$PureComponent) {\n      _inherits(Validator, _React$PureComponent);\n\n      var _super = _createSuper(Validator);\n\n      function Validator(props) {\n        var _this;\n\n        _classCallCheck(this, Validator);\n\n        _this = _super.call(this, props);\n\n        _this.validate = function (e) {\n          var _this$props = _this.props,\n              onChange = _this$props.onChange,\n              onError = _this$props.onError,\n              onSuccess = _this$props.onSuccess;\n          var error = validate(e);\n\n          if (error !== _this.state.error) {\n            var notify = error ? onError : onSuccess;\n\n            _this.setState({\n              error: error\n            });\n\n            if (typeof notify === 'function') {\n              notify();\n            }\n          }\n\n          if (typeof onChange === 'function') {\n            onChange(e);\n          }\n        };\n\n        _this.state = {\n          error: undefined\n        };\n        return _this;\n      }\n\n      _createClass(Validator, [{\n        key: \"render\",\n        value: function render() {\n          var _this$state$error = this.state.error,\n              error = _this$state$error === void 0 ? this.props.error : _this$state$error;\n          return React.createElement(Component, Object.assign({}, this.props, {\n            error: error,\n            onChange: this.validate\n          }));\n        }\n      }]);\n\n      return Validator;\n    }(React.PureComponent), {\n      Component: Component\n    });\n  };\n}","map":{"version":3,"sources":["../../../src/hoc/withValidation.tsx"],"names":[],"mappings":";;;;AAAA,OAAO,KAAK,KAAZ,MAAuB,OAAvB;AACA,SAAS,SAAT,QAA0B,uCAA1B;AAkBA;;;;;;AAKA,OAAM,SAAU,cAAV,CAAqC,QAArC,EAA8F;AAChG,SAAO,UAA4C,SAA5C,EAAsF;AACzF,WAAO,SAAS;AAAA;;AAAA;;AACZ,yBAAY,KAAZ,EAA0C;AAAA;;AAAA;;AACtC,kCAAM,KAAN;;AAKJ,cAAA,QAAA,GAAW,UAAC,CAAD,EAAkB;AAAA,4BACgB,MAAK,KADrB;AAAA,cACjB,QADiB,eACjB,QADiB;AAAA,cACP,OADO,eACP,OADO;AAAA,cACE,SADF,eACE,SADF;AAEzB,cAAM,KAAK,GAAG,QAAQ,CAAC,CAAD,CAAtB;;AACA,cAAI,KAAK,KAAK,MAAK,KAAL,CAAW,KAAzB,EAAgC;AAC5B,gBAAM,MAAM,GAAG,KAAK,GAAG,OAAH,GAAa,SAAjC;;AACA,kBAAK,QAAL,CAAc;AACV,cAAA,KAAK,EAAL;AADU,aAAd;;AAGA,gBAAI,OAAO,MAAP,KAAkB,UAAtB,EAAkC;AAC9B,cAAA,MAAM;AACT;AACJ;;AACD,cAAI,OAAO,QAAP,KAAoB,UAAxB,EAAoC;AAChC,YAAA,QAAQ,CAAC,CAAD,CAAR;AACH;AACJ,SAfD;;AAJI,cAAK,KAAL,GAAa;AACT,UAAA,KAAK,EAAE;AADE,SAAb;AAFsC;AAKzC;;AANW;AAAA;AAAA,iCAuBN;AAAA,kCACmC,KAAK,KADxC,CACM,KADN;AAAA,cACM,KADN,kCACc,KAAK,KAAL,CAAW,KADzB;AAEF,iBAAO,KAAA,CAAA,aAAA,CAAC,SAAD,EAAU,MAAA,CAAA,MAAA,CAAA,EAAA,EAAK,KAAK,KAAV,EAAe;AAAE,YAAA,KAAK,EAAE,KAAT;AAAgB,YAAA,QAAQ,EAAE,KAAK;AAA/B,WAAf,CAAV,CAAP;AACH;AA1BW;;AAAA;AAAA,MAAyB,KAAK,CAAC,aAA/B,GA2Bb;AAAE,MAAA,SAAS,EAAT;AAAF,KA3Ba,CAAhB;AA4BH,GA7BD;AA8BH","sourcesContent":["import * as React from 'react';\nimport { withInner } from 'typescript-plugin-inner-jsx/withInner';\nexport interface BaseInputProps<TEventArgs> {\n    /**\n     * Event emitted once the value changes.\n     */\n    onChange?(e: TEventArgs): void;\n    /**\n     * The currently displayed error message.\n     */\n    error?: React.ReactChild;\n}\nexport interface ValidatorProps {\n    onSuccess?(): void;\n    onError?(): void;\n}\nexport interface ValidatorState {\n    error: React.ReactChild | undefined;\n}\n/**\n * Provides automatic validation for a wrapped component.\n * @param validate The validation function.\n * @returns A constructor function taking a component to be wrapped with the validation.\n */\nexport function withValidation<TEventArgs>(validate: (e: TEventArgs) => React.ReactChild | undefined) {\n    return <TProps extends BaseInputProps<TEventArgs>>(Component: React.ComponentType<TProps>) => {\n        return withInner(class Validator extends React.PureComponent<TProps & ValidatorProps, ValidatorState> {\n            constructor(props: TProps & ValidatorProps) {\n                super(props);\n                this.state = {\n                    error: undefined,\n                };\n            }\n            validate = (e: TEventArgs) => {\n                const { onChange, onError, onSuccess } = this.props;\n                const error = validate(e);\n                if (error !== this.state.error) {\n                    const notify = error ? onError : onSuccess;\n                    this.setState({\n                        error,\n                    });\n                    if (typeof notify === 'function') {\n                        notify();\n                    }\n                }\n                if (typeof onChange === 'function') {\n                    onChange(e);\n                }\n            };\n            render() {\n                const { error = this.props.error } = this.state;\n                return <Component {...this.props} error={error} onChange={this.validate}/>;\n            }\n        }, { Component });\n    };\n}\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}
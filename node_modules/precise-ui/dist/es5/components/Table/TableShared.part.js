"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = require("react");
var styled_1 = require("../../utils/styled");
var textStyles_1 = require("../../textStyles");
var IncreaseDecrease_1 = require("../IncreaseDecrease");
var distance_1 = require("../../distance");
var StyledIncreaseDecrease = styled_1.default(IncreaseDecrease_1.IncreaseDecrease)(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n  margin-left: ", ";\n"], ["\n  margin-left: ", ";\n"])), distance_1.distance.xsmall);
var HeaderLabel = styled_1.default.div(templateObject_2 || (templateObject_2 = __makeTemplateObject(["\n  font-size: 0;\n  white-space: nowrap;\n\n  > span {\n    ", "\n\n    display: inline-block;\n    vertical-align: middle;\n  }\n"], ["\n  font-size: 0;\n  white-space: nowrap;\n\n  > span {\n    ", "\n\n    display: inline-block;\n    vertical-align: middle;\n  }\n"])), textStyles_1.getFontStyle({ size: 'small' }));
exports.StyledTableHead = styled_1.default.thead(templateObject_3 || (templateObject_3 = __makeTemplateObject(["\n  ", "\n  \n  color: ", ";\n"], ["\n  ", "\n  \n  color: ", ";\n"])), textStyles_1.getFontStyle({ weight: 'bold' }), styled_1.themed(function (_a) {
    var theme = _a.theme;
    return theme.text6 || theme.text1;
}));
exports.StyledTableFoot = styled_1.default.tfoot(templateObject_4 || (templateObject_4 = __makeTemplateObject(["\n  ", "\n"], ["\n  ", "\n"])), textStyles_1.getFontStyle({ size: 'xSmall' }));
exports.StyledTableHeaderRow = styled_1.default.tr(templateObject_5 || (templateObject_5 = __makeTemplateObject([""], [""])));
exports.StyledTableRow = styled_1.default.tr(styled_1.themed(function (_a) {
    var _b = _a.theme, ui3 = _b.ui3, ui4 = _b.ui4, text1 = _b.text1;
    return styled_1.css(templateObject_6 || (templateObject_6 = __makeTemplateObject(["\n      border-bottom: 1px solid ", ";\n      color: ", ";\n\n      &:hover {\n        background: ", ";\n      }\n    "], ["\n      border-bottom: 1px solid ", ";\n      color: ", ";\n\n      &:hover {\n        background: ", ";\n      }\n    "])), ui4, text1, ui3);
}));
exports.StyledTableHeader = styled_1.default('th')(templateObject_7 || (templateObject_7 = __makeTemplateObject(["\n  text-align: left;\n  border-bottom: 1px solid ", ";\n  cursor: ", ";\n  box-sizing: border-box;\n  ", ";\n"], ["\n  text-align: left;\n  border-bottom: 1px solid ", ";\n  cursor: ", ";\n  box-sizing: border-box;\n  ", ";\n"])), styled_1.themed(function (_a) {
    var theme = _a.theme;
    return theme.ui5;
}), function (_a) {
    var sortable = _a.sortable;
    return (sortable ? 'pointer' : 'default');
}, function (_a) {
    var width = _a.width;
    return (width && "width: " + width) || '';
});
exports.getDefaultHeaderCellRenderer = function (sort) { return function (_a) {
    var value = _a.value, sorting = _a.sorting, column = _a.column, key = _a.key;
    if (column !== -1) {
        return (React.createElement(HeaderLabel, null,
            React.createElement("span", null, value),
            sorting !== false && (React.createElement(StyledIncreaseDecrease, { value: sorting ? (sorting === 'descending' ? 'decrease' : 'increase') : undefined, onIncrease: function (e) {
                    e.stopPropagation();
                    sort(key, 'ascending');
                }, onDecrease: function (e) {
                    e.stopPropagation();
                    sort(key, 'descending');
                } }))));
    }
    return value;
}; };
function defaultCellRenderer(_a) {
    var value = _a.value;
    switch (typeof value) {
        case 'boolean':
        case 'number':
        case 'string':
            return value.toString();
        case 'object':
            if (value) {
                return value.toString();
            }
            break;
    }
    return '';
}
exports.defaultCellRenderer = defaultCellRenderer;
function defaultBodyRenderer(e) {
    var TableBody = e.table;
    return React.createElement(TableBody, __assign({}, e.props), e.rows);
}
exports.defaultBodyRenderer = defaultBodyRenderer;
function getColumns(data, columns) {
    return (columns ||
        Object.keys(data[0] || {}).reduce(function (columns, key) {
            columns[key] = {
                header: key,
                sortable: true,
            };
            return columns;
        }, {}));
}
exports.getColumns = getColumns;
function handleDataClickedEvent(tableCellEvent, handler) {
    return function (e) {
        e.preventDefault();
        var row = tableCellEvent.row, column = tableCellEvent.column, key = tableCellEvent.key, data = tableCellEvent.data;
        if (typeof handler === 'function') {
            handler(__assign({}, tableCellEvent, { value: data && (column === -1 ? row + 1 : data[key]) }));
        }
    };
}
exports.handleDataClickedEvent = handleDataClickedEvent;
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFibGVTaGFyZWQucGFydC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1RhYmxlL1RhYmxlU2hhcmVkLnBhcnQudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsNkJBQStCO0FBRS9CLDZDQUF5RDtBQUN6RCwrQ0FBZ0Q7QUFDaEQsd0RBQXVEO0FBQ3ZELDJDQUEwQztBQUMxQyxJQUFNLHNCQUFzQixHQUFHLGdCQUFNLENBQUMsbUNBQWdCLENBQUMsNkZBQUMsbUJBQ3ZDLEVBQWUsS0FDL0IsS0FEZ0IsbUJBQVEsQ0FBQyxNQUFNLENBQy9CLENBQUM7QUFDRixJQUFNLFdBQVcsR0FBRyxnQkFBTSxDQUFDLEdBQUcsd01BQUMsK0RBS3pCLEVBQStCLG9FQUtwQyxLQUxLLHlCQUFZLENBQUMsRUFBRSxJQUFJLEVBQUUsT0FBTyxFQUFFLENBQUMsQ0FLcEMsQ0FBQztBQUNXLFFBQUEsZUFBZSxHQUFHLGdCQUFNLENBQUMsS0FBSyxtR0FBQyxNQUN4QyxFQUFnQyxpQkFFekIsRUFBaUQsS0FDM0QsS0FIRyx5QkFBWSxDQUFDLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxDQUFDLEVBRXpCLGVBQU0sQ0FBQyxVQUFDLEVBQVM7UUFBUCxnQkFBSztJQUFPLE9BQUEsS0FBSyxDQUFDLEtBQUssSUFBSSxLQUFLLENBQUMsS0FBSztBQUExQixDQUEwQixDQUFDLEVBQzFEO0FBQ1csUUFBQSxlQUFlLEdBQUcsZ0JBQU0sQ0FBQyxLQUFLLCtFQUFDLE1BQ3hDLEVBQWdDLElBQ25DLEtBREcseUJBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUNsQztBQUNXLFFBQUEsb0JBQW9CLEdBQUcsZ0JBQU0sQ0FBQyxFQUFFLHFFQUFDLEVBQUUsS0FBQztBQUNwQyxRQUFBLGNBQWMsR0FBRyxnQkFBTSxDQUFDLEVBQUUsQ0FBQyxlQUFNLENBQUMsVUFBQyxF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WixPQUFPLENBQUMsR0FBRyxDQUFDLEdBQUc7Z0JBQ1gsTUFBTSxFQUFFLEdBQUc7Z0JBQ1gsUUFBUSxFQUFFLElBQUk7YUFDakIsQ0FBQztZQUNGLE9BQU8sT0FBTyxDQUFDO1FBQ25CLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ2hCLENBQUM7QUFYRCxnQ0FXQztBQUNELFNBQWdCLHNCQUFzQixDQUFJLGNBQWlDLEVBQUUsT0FBc0M7SUFDL0csT0FBTyxVQUFzQyxDQUFzQjtRQUMvRCxDQUFDLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDWCxJQUFBLHdCQUFHLEVBQUUsOEJBQU0sRUFBRSx3QkFBRyxFQUFFLDBCQUFJLENBQW9CO1FBQ2xELElBQUksT0FBTyxPQUFPLEtBQUssVUFBVSxFQUFFO1lBQy9CLE9BQU8sY0FDQSxjQUFjLElBQ2pCLEtBQUssRUFBRSxJQUFJLElBQUksQ0FBQyxNQUFNLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEdBQUcsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUN0RCxDQUFDO1NBQ047SUFDTCxDQUFDLENBQUM7QUFDTixDQUFDO0FBWEQsd0RBV0MiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyBUYWJsZUJvZHlSZW5kZXJFdmVudCwgQ29sdW1uLCBUYWJsZUNvbHVtbnMsIFRhYmxlQ2VsbFJlbmRlckV2ZW50LCBUYWJsZUNlbGxFdmVudCwgVGFibGVQcm9wcywgfSBmcm9tICcuL1RhYmxlLnR5cGVzLnBhcnQnO1xuaW1wb3J0IHN0eWxlZCwgeyB0aGVtZWQsIGNzcyB9IGZyb20gJy4uLy4uL3V0aWxzL3N0eWxlZCc7XG5pbXBvcnQgeyBnZXRGb250U3R5bGUgfSBmcm9tICcuLi8uLi90ZXh0U3R5bGVzJztcbmltcG9ydCB7IEluY3JlYXNlRGVjcmVhc2UgfSBmcm9tICcuLi9JbmNyZWFzZURlY3JlYXNlJztcbmltcG9ydCB7IGRpc3RhbmNlIH0gZnJvbSAnLi4vLi4vZGlzdGFuY2UnO1xuY29uc3QgU3R5bGVkSW5jcmVhc2VEZWNyZWFzZSA9IHN0eWxlZChJbmNyZWFzZURlY3JlYXNlKSBgXG4gIG1hcmdpbi1sZWZ0OiAke2Rpc3RhbmNlLnhzbWFsbH07XG5gO1xuY29uc3QgSGVhZGVyTGFiZWwgPSBzdHlsZWQuZGl2IGBcbiAgZm9udC1zaXplOiAwO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuXG4gID4gc3BhbiB7XG4gICAgJHtnZXRGb250U3R5bGUoeyBzaXplOiAnc21hbGwnIH0pfVxuXG4gICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7XG4gIH1cbmA7XG5leHBvcnQgY29uc3QgU3R5bGVkVGFibGVIZWFkID0gc3R5bGVkLnRoZWFkIGBcbiAgJHtnZXRGb250U3R5bGUoeyB3ZWlnaHQ6ICdib2xkJyB9KX1cbiAgXG4gIGNvbG9yOiAke3RoZW1lZCgoeyB0aGVtZSB9KSA9PiB0aGVtZS50ZXh0NiB8fCB0aGVtZS50ZXh0MSl9O1xuYDtcbmV4cG9ydCBjb25zdCBTdHlsZWRUYWJsZUZvb3QgPSBzdHlsZWQudGZvb3QgYFxuICAke2dldEZvbnRTdHlsZSh7IHNpemU6ICd4U21hbGwnIH0pfVxuYDtcbmV4cG9ydCBjb25zdCBTdHlsZWRUYWJsZUhlYWRlclJvdyA9IHN0eWxlZC50ciBgYDtcbmV4cG9ydCBjb25zdCBTdHlsZWRUYWJsZVJvdyA9IHN0eWxlZC50cih0aGVtZWQoKHsgdGhlbWU6IHsgdWkzLCB1aTQsIHRleHQxIH0gfSkgPT4gY3NzIGBcbiAgICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAke3VpNH07XG4gICAgICBjb2xvcjogJHt0ZXh0MX07XG5cbiAgICAgICY6aG92ZXIge1xuICAgICAgICBiYWNrZ3JvdW5kOiAke3VpM307XG4gICAgICB9XG4gICAgYCkpO1xuZXhwb3J0IGludGVyZmFjZSBUYWJsZUhlYWRlclByb3BzIHtcbiAgICBzb3J0YWJsZT86IGJvb2xlYW47XG4gICAgd2lkdGg/OiBzdHJpbmc7XG59XG5leHBvcnQgY29uc3QgU3R5bGVkVGFibGVIZWFkZXIgPSBzdHlsZWQoJ3RoJyk8VGFibGVIZWFkZXJQcm9wcz4gYFxuICB0ZXh0LWFsaWduOiBsZWZ0O1xuICBib3JkZXItYm90dG9tOiAxcHggc29saWQgJHt0aGVtZWQoKHsgdGhlbWUgfSkgPT4gdGhlbWUudWk1KX07XG4gIGN1cnNvcjogJHsoeyBzb3J0YWJsZSB9KSA9PiAoc29ydGFibGUgPyAncG9pbnRlcicgOiAnZGVmYXVsdCcpfTtcbiAgYm94LXNpemluZzogYm9yZGVyLWJveDtcbiAgJHsoeyB3aWR0aCB9KSA9PiAod2lkdGggJiYgYHdpZHRoOiAke3dpZHRofWApIHx8ICcnfTtcbmA7XG5leHBvcnQgY29uc3QgZ2V0RGVmYXVsdEhlYWRlckNlbGxSZW5kZXJlciA9IChzb3J0OiAoa2V5OiBzdHJpbmcsIG9yZGVyOiAnYXNjZW5kaW5nJyB8ICdkZXNjZW5kaW5nJykgPT4gdm9pZCkgPT4gPFQgZXh0ZW5kcyB7fT4oeyB2YWx1ZSwgc29ydGluZywgY29sdW1uLCBrZXksIH06IFRhYmxlQ2VsbFJlbmRlckV2ZW50PFQ+KTogUmVhY3QuUmVhY3ROb2RlID0+IHtcbiAgICBpZiAoY29sdW1uICE9PSAtMSkge1xuICAgICAgICByZXR1cm4gKDxIZWFkZXJMYWJlbD5cbiAgICAgICAgPHNwYW4+e3ZhbHVlfTwvc3Bhbj5cbiAgICAgICAge3NvcnRpbmcgIT09IGZhbHNlICYmICg8U3R5bGVkSW5jcmVhc2VEZWNyZWFzZSB2YWx1ZT17c29ydGluZyA/IChzb3J0aW5nID09PSAnZGVzY2VuZGluZycgPyAnZGVjcmVhc2UnIDogJ2luY3JlYXNlJykgOiB1bmRlZmluZWR9IG9uSW5jcmVhc2U9e2UgPT4ge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHNvcnQoa2V5LCAnYXNjZW5kaW5nJyk7XG4gICAgICAgIH19IG9uRGVjcmVhc2U9e2UgPT4ge1xuICAgICAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTtcbiAgICAgICAgICAgIHNvcnQoa2V5LCAnZGVzY2VuZGluZycpO1xuICAgICAgICB9fS8+KX1cbiAgICAgIDwvSGVhZGVyTGFiZWw+KTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xufTtcbmV4cG9ydCBmdW5jdGlvbiBkZWZhdWx0Q2VsbFJlbmRlcmVyPFQ+KHsgdmFsdWUgfTogVGFibGVDZWxsUmVuZGVyRXZlbnQ8VD4pOiBSZWFjdC5SZWFjdE5vZGUge1xuICAgIHN3aXRjaCAodHlwZW9mIHZhbHVlKSB7XG4gICAgICAgIGNhc2UgJ2Jvb2xlYW4nOlxuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlLnRvU3RyaW5nKCk7XG4gICAgICAgIGNhc2UgJ29iamVjdCc6XG4gICAgICAgICAgICBpZiAodmFsdWUpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUudG9TdHJpbmcoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICByZXR1cm4gJyc7XG59XG5leHBvcnQgZnVuY3Rpb24gZGVmYXVsdEJvZHlSZW5kZXJlcihlOiBUYWJsZUJvZHlSZW5kZXJFdmVudCkge1xuICAgIGNvbnN0IFRhYmxlQm9keSA9IGUudGFibGU7XG4gICAgcmV0dXJuIDxUYWJsZUJvZHkgey4uLmUucHJvcHN9PntlLnJvd3N9PC9UYWJsZUJvZHk+O1xufVxuZXhwb3J0IGZ1bmN0aW9uIGdldENvbHVtbnM8VD4oZGF0YTogQXJyYXk8VD4sIGNvbHVtbnM/OiBUYWJsZUNvbHVtbnMpIHtcbiAgICByZXR1cm4gKGNvbHVtbnMgfHxcbiAgICAgICAgT2JqZWN0LmtleXMoZGF0YVswXSB8fCB7fSkucmVkdWNlPHtcbiAgICAgICAgICAgIFtrZXk6IHN0cmluZ106IENvbHVtbjtcbiAgICAgICAgfT4oKGNvbHVtbnMsIGtleSkgPT4ge1xuICAgICAgICAgICAgY29sdW1uc1trZXldID0ge1xuICAgICAgICAgICAgICAgIGhlYWRlcjoga2V5LFxuICAgICAgICAgICAgICAgIHNvcnRhYmxlOiB0cnVlLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHJldHVybiBjb2x1bW5zO1xuICAgICAgICB9LCB7fSkpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGhhbmRsZURhdGFDbGlja2VkRXZlbnQ8VD4odGFibGVDZWxsRXZlbnQ6IFRhYmxlQ2VsbEV2ZW50PFQ+LCBoYW5kbGVyPzogVGFibGVQcm9wczxUPlsnb25EYXRhQ2xpY2snXSkge1xuICAgIHJldHVybiA8RSBleHRlbmRzIEhUTUxFbGVtZW50ID0gSFRNTEVsZW1lbnQ+KGU6IFJlYWN0Lk1vdXNlRXZlbnQ8RT4pID0+IHtcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBjb25zdCB7IHJvdywgY29sdW1uLCBrZXksIGRhdGEgfSA9IHRhYmxlQ2VsbEV2ZW50O1xuICAgICAgICBpZiAodHlwZW9mIGhhbmRsZXIgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGhhbmRsZXIoe1xuICAgICAgICAgICAgICAgIC4uLnRhYmxlQ2VsbEV2ZW50LFxuICAgICAgICAgICAgICAgIHZhbHVlOiBkYXRhICYmIChjb2x1bW4gPT09IC0xID8gcm93ICsgMSA6IGRhdGFba2V5XSksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH07XG59XG4iXX0=
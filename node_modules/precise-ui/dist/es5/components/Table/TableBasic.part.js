"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = require("react");
var memoize_one_1 = require("memoize-one");
var styled_1 = require("../../utils/styled");
var sort_1 = require("../../utils/sort");
var distance_1 = require("../../distance");
var TableShared_part_1 = require("./TableShared.part");
var textStyles_1 = require("../../textStyles");
var StyledTable = styled_1.default.table(styled_1.themed(function (_a) {
    var theme = _a.theme, borderless = _a.borderless, condensed = _a.condensed;
    return styled_1.css(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n    ", "\n\n    table-layout: ", ";\n    border-collapse: collapse;\n    width: 100%;\n    color: ", ";\n    border: ", ";\n\n    > thead > tr > th,\n    > tbody > tr > td {\n      padding: ", ";\n\n      &:not(:last-child) {\n        padding-right: 0;\n      }\n    }\n    "], ["\n    ", "\n\n    table-layout: ", ";\n    border-collapse: collapse;\n    width: 100%;\n    color: ", ";\n    border: ", ";\n\n    > thead > tr > th,\n    > tbody > tr > td {\n      padding: ", ";\n\n      &:not(:last-child) {\n        padding-right: 0;\n      }\n    }\n    "])), textStyles_1.getFontStyle({ size: 'small', lineHeight: 'xSmall' }), theme.tableLayout, theme.text6, borderless ? 'none' : theme.tableBorder, condensed ? distance_1.distance.small + " " + distance_1.distance.large : theme.tableHeadPadding);
}));
var StyledTableBody = styled_1.default.tbody(templateObject_2 || (templateObject_2 = __makeTemplateObject([""], [""])));
var TableHost = Object.assign((function (_a) {
    var head = _a.head, foot = _a.foot, theme = _a.theme, children = _a.children, props = __rest(_a, ["head", "foot", "theme", "children"]);
    return (React.createElement(StyledTable, __assign({ theme: theme }, props),
        head,
        React.createElement(StyledTableBody, { theme: theme }, children),
        foot));
}), { inner: {
        get StyledTable() { return StyledTable; },
        get StyledTableBody() { return StyledTableBody; }
    } });
var HiddenCell = styled_1.default.td(templateObject_3 || (templateObject_3 = __makeTemplateObject(["\n  display: none;\n"], ["\n  display: none;\n"])));
var StyledTableCell = styled_1.default.td(templateObject_4 || (templateObject_4 = __makeTemplateObject(["\n  text-align: left;\n"], ["\n  text-align: left;\n"])));
var StyledPlaceholderCell = styled_1.default(StyledTableCell)(templateObject_5 || (templateObject_5 = __makeTemplateObject(["\n  text-align: center;\n"], ["\n  text-align: center;\n"])));
function defaultRowKeyGetter(_a) {
    var key = _a.key;
    return key;
}
function normalizeSortBy(sortBy) {
    if (!sortBy) {
        return undefined;
    }
    if (typeof sortBy === 'string') {
        if (sortBy[0] === '-') {
            return {
                columnKey: sortBy.substr(1),
                order: 'descending',
            };
        }
        else {
            return {
                columnKey: sortBy,
                order: 'ascending',
            };
        }
    }
    return {
        columnKey: sortBy.columnKey,
        order: sortBy.order || 'ascending',
    };
}
var TableBasic = /** @class */ (function (_super) {
    __extends(TableBasic, _super);
    function TableBasic(props) {
        var _this = _super.call(this, props) || this;
        _this.getIndices = memoize_one_1.default(function (data, grouping, sorting) { return sorting
            ? sort_1.sortObjectList(data, sorting.columnKey, sorting.order, grouping)
            : sort_1.sortObjectList(data, undefined, undefined, grouping); });
        _this.defaultHeadRenderer = function (_a) {
            var columns = _a.columns, sortBy = _a.sortBy, keys = _a.keys;
            var onSort = _this.props.onSort;
            var defaultHeaderCellRenderer = TableShared_part_1.getDefaultHeaderCellRenderer(function (columnKey, order) {
                _this.setState({
                    sorting: {
                        columnKey: columnKey,
                        order: order,
                    },
                }, function () {
                    if (typeof onSort === 'function') {
                        onSort({
                            column: keys.indexOf(columnKey),
                            key: columnKey,
                            order: order,
                        });
                    }
                });
            });
            var _b = _this.props, indexed = _b.indexed, theme = _b.theme, _c = _b.headerCellRenderer, headerCellRenderer = _c === void 0 ? defaultHeaderCellRenderer : _c;
            return (React.createElement(TableShared_part_1.StyledTableHead, { theme: theme },
                React.createElement(TableShared_part_1.StyledTableHeaderRow, { theme: theme },
                    indexed && (React.createElement(TableShared_part_1.StyledTableHeader, { onClick: function (e) { return _this.headerClicked(e, -1, '#'); }, theme: theme }, headerCellRenderer({
                        column: -1,
                        key: '',
                        row: -1,
                        value: '#',
                        render: defaultHeaderCellRenderer,
                    }))),
                    keys.map(function (key, cell) {
                        var column = columns[key];
                        var hidden = typeof column !== 'string' && column.hidden;
                        if (!hidden) {
                            var name_1 = typeof column === 'string' ? column : column.header;
                            var width = typeof column === 'string' ? undefined : column.width;
                            var sortable = _this.isSortable(key, columns);
                            var direction = sortable && sortBy && (sortBy.columnKey !== key ? undefined : sortBy.order);
                            return (React.createElement(TableShared_part_1.StyledTableHeader, { sortable: sortable, width: width, key: key, onClick: function (e) { return _this.headerClicked(e, cell, key); }, theme: theme }, headerCellRenderer({
                                column: cell,
                                key: key,
                                row: -1,
                                sorting: direction,
                                value: name_1,
                                render: defaultHeaderCellRenderer,
                            })));
                        }
                        return React.createElement(HiddenCell, { key: key });
                    }))));
        };
        _this.defaultFootRenderer = function (_a) {
            var columns = _a.columns, keys = _a.keys, sortBy = _a.sortBy;
            var _b = _this.props, indexed = _b.indexed, theme = _b.theme, _c = _b.footerCellRenderer, footerCellRenderer = _c === void 0 ? TableShared_part_1.defaultCellRenderer : _c;
            return (React.createElement(TableShared_part_1.StyledTableFoot, { theme: theme },
                React.createElement(TableShared_part_1.StyledTableRow, { theme: theme },
                    indexed && (React.createElement(StyledTableCell, { onClick: function (e) { return _this.footerClicked(e, -1, '#'); }, theme: theme }, footerCellRenderer({
                        column: -1,
                        key: '',
                        row: -1,
                        value: '',
                        render: TableShared_part_1.defaultCellRenderer,
                    }))),
                    keys.map(function (key, i) {
                        var column = columns[key];
                        var sortable = _this.isSortable(key, columns);
                        var direction = sortable && sortBy && (sortBy.columnKey !== key ? undefined : sortBy.order);
                        var hidden = typeof column !== 'string' && column.hidden;
                        if (!hidden) {
                            var name_2 = typeof column === 'string' ? undefined : column.footer;
                            return (React.createElement(StyledTableCell, { key: key, theme: theme, onClick: function (e) { return _this.footerClicked(e, i, key); } }, footerCellRenderer({
                                column: i,
                                key: key,
                                row: -1,
                                value: name_2,
                                sorting: direction,
                                render: TableShared_part_1.defaultCellRenderer,
                            })));
                        }
                        return React.createElement(HiddenCell, { key: key });
                    }))));
        };
        _this.defaultRowRenderer = function (_a) {
            var cells = _a.cells, index = _a.index;
            var theme = _this.props.theme;
            return (React.createElement(TableShared_part_1.StyledTableRow, { key: index, theme: theme }, cells));
        };
        _this.state = {
            controlledSorting: false,
        };
        return _this;
    }
    TableBasic.getDerivedStateFromProps = function (props, state) {
        var controlledSorting = props.sortBy !== undefined || state.controlledSorting;
        if (controlledSorting) {
            return {
                sorting: normalizeSortBy(props.sortBy),
                controlledSorting: controlledSorting,
            };
        }
        return state;
    };
    TableBasic.prototype.isSortable = function (key, cols) {
        var sortBy = this.props.sortBy;
        var col = cols[key];
        return !sortBy && (!col || (typeof col !== 'string' && col.sortable));
    };
    TableBasic.prototype.headerClicked = function (e, column, key) {
        var _this = this;
        var _a = this.props, onHeaderClick = _a.onHeaderClick, onSort = _a.onSort, _b = _a.data, data = _b === void 0 ? [] : _b, columns = _a.columns;
        e.preventDefault();
        if (typeof onHeaderClick === 'function') {
            onHeaderClick({
                column: column,
                key: key,
                row: -1,
            });
        }
        else if (this.isSortable(key, TableShared_part_1.getColumns(data, columns))) {
            this.setState(function (_a) {
                var sorting = _a.sorting;
                var isAscending = sorting && sorting.order === 'descending' && sorting.columnKey === key;
                var order = sorting && sorting.columnKey === key ? 'descending' : 'ascending';
                var newSortingValue = undefined;
                if (!isAscending && column !== -1) {
                    newSortingValue = {
                        columnKey: key,
                        order: order,
                    };
                }
                return { sorting: newSortingValue };
            }, function () {
                if (typeof onSort === 'function') {
                    onSort({
                        column: column,
                        key: key,
                        order: _this.state.sorting && _this.state.sorting.order,
                    });
                }
            });
        }
    };
    TableBasic.prototype.footerClicked = function (e, column, key) {
        e.preventDefault();
        var onFooterClick = this.props.onFooterClick;
        if (typeof onFooterClick === 'function') {
            onFooterClick({
                column: column,
                key: key,
                row: -1,
            });
        }
    };
    TableBasic.prototype.renderCells = function (keys, rowIndex) {
        var _a = this.props, _b = _a.data, data = _b === void 0 ? [] : _b, _c = _a.cellRenderer, cellRenderer = _c === void 0 ? TableShared_part_1.defaultCellRenderer : _c, indexed = _a.indexed, theme = _a.theme, columns = _a.columns, onDataClick = _a.onDataClick;
        var cols = TableShared_part_1.getColumns(data, columns);
        var row = data[rowIndex];
        var cells = keys.map(function (key, cell) {
            var column = cols[key];
            var hidden = typeof column !== 'string' && column.hidden;
            if (!hidden) {
                return (React.createElement(StyledTableCell, { key: key, onClick: TableShared_part_1.handleDataClickedEvent({ row: rowIndex, column: cell, key: key, data: row }, onDataClick), theme: theme }, cellRenderer({
                    column: cell,
                    key: key,
                    data: row,
                    row: rowIndex,
                    value: row[key],
                    render: TableShared_part_1.defaultCellRenderer,
                })));
            }
            return React.createElement(HiddenCell, { key: key });
        });
        if (indexed) {
            cells.unshift(React.createElement(StyledTableCell, { key: "index#", onClick: TableShared_part_1.handleDataClickedEvent({ row: rowIndex, column: -1, key: '__indexed', data: row }, onDataClick), theme: theme }, rowIndex + 1));
        }
        return cells;
    };
    TableBasic.prototype.renderRows = function (keys) {
        var _this = this;
        var _a = this.props, data = _a.data, groupBy = _a.groupBy, indexed = _a.indexed, placeholder = _a.placeholder, _b = _a.rowRenderer, rowRenderer = _b === void 0 ? this.defaultRowRenderer : _b, _c = _a.getRowKey, getRowKey = _c === void 0 ? defaultRowKeyGetter : _c, theme = _a.theme;
        var indices = this.getIndices(data, groupBy, this.state.sorting);
        var cols = keys.length + (indexed ? 1 : 0);
        var state = {};
        if (indices.length === 0) {
            return placeholder
                ? [
                    React.createElement(TableShared_part_1.StyledTableRow, { theme: theme, key: "placeholder" },
                        React.createElement(StyledPlaceholderCell, { colSpan: cols, theme: theme }, placeholder)),
                ]
                : [];
        }
        else {
            return indices.map(function (index) {
                var cells = _this.renderCells(keys, index);
                var renderData = { theme: theme, index: index, cells: cells, data: data[index], key: index.toString(), state: state };
                renderData.key = getRowKey(renderData);
                return rowRenderer(renderData);
            });
        }
    };
    TableBasic.prototype.renderHead = function (keys) {
        var _a = this.props, _b = _a.headRenderer, headRenderer = _b === void 0 ? this.defaultHeadRenderer : _b, groupBy = _a.groupBy, _c = _a.data, data = _c === void 0 ? [] : _c, columns = _a.columns;
        var sorting = this.state.sorting;
        return headRenderer({
            columns: TableShared_part_1.getColumns(data, columns),
            sortBy: sorting,
            groupBy: groupBy,
            data: data,
            keys: keys,
        });
    };
    TableBasic.prototype.renderFoot = function (keys) {
        var _a = this.props, _b = _a.footRenderer, footRenderer = _b === void 0 ? this.defaultFootRenderer : _b, groupBy = _a.groupBy, _c = _a.data, data = _c === void 0 ? [] : _c, columns = _a.columns;
        var sorting = this.state.sorting;
        return footRenderer({
            columns: TableShared_part_1.getColumns(data, columns),
            sortBy: sorting,
            groupBy: groupBy,
            data: data,
            keys: keys,
        });
    };
    TableBasic.prototype.render = function () {
        var _a = this.props, _b = _a.data, data = _b === void 0 ? [] : _b, columns = _a.columns, noHeader = _a.noHeader, theme = _a.theme, _c = _a.bodyRenderer, bodyRenderer = _c === void 0 ? TableShared_part_1.defaultBodyRenderer : _c, _1 = _a.cellRenderer, _2 = _a.indexed, _3 = _a.sortBy, _4 = _a.onDataClick, _5 = _a.onFooterClick, _6 = _a.onHeaderClick, _7 = _a.placeholder, _8 = _a.columns, _9 = _a.groupBy, _10 = _a.headRenderer, _11 = _a.footRenderer, _12 = _a.headerCellRenderer, _13 = _a.footerCellRenderer, _14 = _a.onSort, props = __rest(_a, ["data", "columns", "noHeader", "theme", "bodyRenderer", "cellRenderer", "indexed", "sortBy", "onDataClick", "onFooterClick", "onHeaderClick", "placeholder", "columns", "groupBy", "headRenderer", "footRenderer", "headerCellRenderer", "footerCellRenderer", "onSort"]);
        var cols = TableShared_part_1.getColumns(data, columns);
        var keys = Object.keys(cols);
        var showFooter = keys.filter(function (key) {
            var col = cols[key];
            return typeof col === 'object' && !!col.footer && !col.hidden;
        }).length > 0;
        var rows = this.renderRows(keys);
        return bodyRenderer({
            table: TableHost,
            props: __assign({ theme: theme, head: !noHeader && this.renderHead(keys), foot: showFooter && this.renderFoot(keys) }, props),
            rows: rows,
            mode: 'table',
        });
    };
    TableBasic.inner = {
        get StyledTableHead() { return TableShared_part_1.StyledTableHead; },
        get StyledTableHeaderRow() { return TableShared_part_1.StyledTableHeaderRow; },
        get StyledTableHeader() { return TableShared_part_1.StyledTableHeader; },
        get HiddenCell() { return HiddenCell; },
        get StyledTableFoot() { return TableShared_part_1.StyledTableFoot; },
        get StyledTableRow() { return TableShared_part_1.StyledTableRow; },
        get StyledTableCell() { return StyledTableCell; },
        get StyledPlaceholderCell() { return StyledPlaceholderCell; }
    };
    return TableBasic;
}(React.Component));
exports.TableBasic = TableBasic;
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFibGVCYXNpYy5wYXJ0LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2NvbXBvbmVudHMvVGFibGUvVGFibGVCYXNpYy5wYXJ0LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQSw2QkFBK0I7QUFDL0IsMkNBQWtDO0FBQ2xDLDZDQUF5RDtBQUN6RCx5Q0FBa0Q7QUFDbEQsMkNBQTBDO0FBRzFDLHVEQUE0TztBQUM1TywrQ0FBZ0Q7QUFTaEQsSUFBTSxXQUFXLEdBQUcsZ0JBQU0sQ0FBQyxLQUFLLENBQW1CLGVBQU0sQ0FBQyxVQUFDLEVBQWdDO1FBQTlCLGdCQUFLLEVBQUUsMEJBQVUsRUFBRSx3QkFBUztJQUFPLE9BQUEsWUFBRyx5VkFBQyxRQUM5RixFQUFxRCx3QkFFdkMsRUFBaUIsa0VBR3hCLEVBQVcsaUJBQ1YsRUFBdUMsdUVBSXBDLEVBQTBFLGtGQU10RixLQWhCQyx5QkFBWSxDQUFDLEVBQUUsSUFBSSxFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsUUFBUSxFQUFFLENBQUMsRUFFdkMsS0FBSyxDQUFDLFdBQVcsRUFHeEIsS0FBSyxDQUFDLEtBQUssRUFDVixVQUFVLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLFdBQVcsRUFJcEMsU0FBUyxDQUFDLENBQUMsQ0FBSSxtQkFBUSxDQUFDLEtBQUssU0FBSSxtQkFBUSxDQUFDLEtBQU8sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLGdCQUFnQjtBQVhLLENBaUIzRixDQUFDLENBQUMsQ0FBQztBQUNSLElBQU0sZUFBZSxHQUFHLGdCQUFNLENBQUMsS0FBSyxxRUFBQyxFQUFFLElBQUEsQ0FBQztBQUt4QyxJQUFNLFNBQVMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFFLENBQUMsVUFBQyxFQUF5QztJQUF2QyxJQUFBLGNBQUksRUFBRSxjQUFJLEVBQUUs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LFVBQVUsS0FBSyxPQUFPLFVBQStCLENBQUMsQ0FBQyxDQUFDO1FBQzVELElBQUksZUFBZSxLQUFLLE9BQU8sa0NBQXlDLENBQUMsQ0FBQyxDQUFDO1FBQzNFLElBQUksY0FBYyxLQUFLLE9BQU8saUNBQXVDLENBQUMsQ0FBQyxDQUFDO1FBQ3hFLElBQUksZUFBZSxLQUFLLE9BQU8sZUFBeUMsQ0FBQyxDQUFDLENBQUM7UUFDM0UsSUFBSSxxQkFBcUIsS0FBSyxPQUFPLHFCQUFxRCxDQUFDLENBQUMsQ0FBQztLQUNoRyxDQUFDO0lBQ04saUJBQUM7Q0FBQSxBQS9RRCxDQUFtQyxLQUFLLENBQUMsU0FBUyxHQStRakQ7QUEvUVksZ0NBQVUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgbWVtb2l6ZSBmcm9tICdtZW1vaXplLW9uZSc7XG5pbXBvcnQgc3R5bGVkLCB7IHRoZW1lZCwgY3NzIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3R5bGVkJztcbmltcG9ydCB7IHNvcnRPYmplY3RMaXN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvc29ydCc7XG5pbXBvcnQgeyBkaXN0YW5jZSB9IGZyb20gJy4uLy4uL2Rpc3RhbmNlJztcbmltcG9ydCB7IFJlZlByb3BzLCBTdGFuZGFyZFByb3BzIH0gZnJvbSAnLi4vLi4vY29tbW9uJztcbmltcG9ydCB7IFRhYmxlUm93RXZlbnQsIFRhYmxlUHJvcHMsIFRhYmxlU29ydGluZywgVGFibGVDb2x1bW5zLCBUYWJsZVNlY3Rpb25SZW5kZXJFdmVudCB9IGZyb20gJy4vVGFibGUudHlwZXMucGFydCc7XG5pbXBvcnQgeyBkZWZhdWx0Q2VsbFJlbmRlcmVyLCBTdHlsZWRUYWJsZUhlYWQsIFN0eWxlZFRhYmxlSGVhZGVyUm93LCBTdHlsZWRUYWJsZUhlYWRlciwgU3R5bGVkVGFibGVSb3csIFN0eWxlZFRhYmxlRm9vdCwgZGVmYXVsdEJvZHlSZW5kZXJlciwgZ2V0Q29sdW1ucywgZ2V0RGVmYXVsdEhlYWRlckNlbGxSZW5kZXJlciwgaGFuZGxlRGF0YUNsaWNrZWRFdmVudCwgfSBmcm9tICcuL1RhYmxlU2hhcmVkLnBhcnQnO1xuaW1wb3J0IHsgZ2V0Rm9udFN0eWxlIH0gZnJvbSAnLi4vLi4vdGV4dFN0eWxlcyc7XG5leHBvcnQgaW50ZXJmYWNlIFRhYmxlQmFzaWNTdGF0ZSB7XG4gICAgc29ydGluZz86IFRhYmxlU29ydGluZztcbiAgICBjb250cm9sbGVkU29ydGluZzogYm9vbGVhbjtcbn1cbmludGVyZmFjZSBTdHlsZWRUYWJsZVByb3BzIHtcbiAgICBjb25kZW5zZWQ/OiBib29sZWFuO1xuICAgIGJvcmRlcmxlc3M/OiBib29sZWFuO1xufVxuY29uc3QgU3R5bGVkVGFibGUgPSBzdHlsZWQudGFibGU8U3R5bGVkVGFibGVQcm9wcz4odGhlbWVkKCh7IHRoZW1lLCBib3JkZXJsZXNzLCBjb25kZW5zZWQgfSkgPT4gY3NzIGBcbiAgICAke2dldEZvbnRTdHlsZSh7IHNpemU6ICdzbWFsbCcsIGxpbmVIZWlnaHQ6ICd4U21hbGwnIH0pfVxuXG4gICAgdGFibGUtbGF5b3V0OiAke3RoZW1lLnRhYmxlTGF5b3V0fTtcbiAgICBib3JkZXItY29sbGFwc2U6IGNvbGxhcHNlO1xuICAgIHdpZHRoOiAxMDAlO1xuICAgIGNvbG9yOiAke3RoZW1lLnRleHQ2fTtcbiAgICBib3JkZXI6ICR7Ym9yZGVybGVzcyA/ICdub25lJyA6IHRoZW1lLnRhYmxlQm9yZGVyfTtcblxuICAgID4gdGhlYWQgPiB0ciA+IHRoLFxuICAgID4gdGJvZHkgPiB0ciA+IHRkIHtcbiAgICAgIHBhZGRpbmc6ICR7Y29uZGVuc2VkID8gYCR7ZGlzdGFuY2Uuc21hbGx9ICR7ZGlzdGFuY2UubGFyZ2V9YCA6IHRoZW1lLnRhYmxlSGVhZFBhZGRpbmd9O1xuXG4gICAgICAmOm5vdCg6bGFzdC1jaGlsZCkge1xuICAgICAgICBwYWRkaW5nLXJpZ2h0OiAwO1xuICAgICAgfVxuICAgIH1cbiAgICBgKSk7XG5jb25zdCBTdHlsZWRUYWJsZUJvZHkgPSBzdHlsZWQudGJvZHkgYGA7XG5pbnRlcmZhY2UgVGFibGVIb3N0UHJvcHMgZXh0ZW5kcyBTdGFuZGFyZFByb3BzIHtcbiAgICBoZWFkOiBSZWFjdC5SZWFjdE5vZGU7XG4gICAgZm9vdDogUmVhY3QuUmVhY3ROb2RlO1xufVxuY29uc3QgVGFibGVIb3N0ID0gT2JqZWN0LmFzc2lnbigoKCh7IGhlYWQsIGZvb3QsIHRoZW1lLCBjaGlsZHJlbiwgLi4ucHJvcHMgfSkgPT4gKDxTdHlsZWRUYWJsZSB0aGVtZT17dGhlbWV9IHsuLi5wcm9wc30+XG4gICAge2hlYWR9XG4gICAgPFN0eWxlZFRhYmxlQm9keSB0aGVtZT17dGhlbWV9PntjaGlsZHJlbn08L1N0eWxlZFRhYmxlQm9keT5cbiAgICB7Zm9vdH1cbiAgPC9TdHlsZWRUYWJsZT4pKSBhcyBSZWFjdC5TRkM8VGFibGVIb3N0UHJvcHM+KSwgeyBpbm5lcjoge1xuICAgICAgICBnZXQgU3R5bGVkVGFibGUoKSB7IHJldHVybiBTdHlsZWRUYWJsZSBhcyB0eXBlb2YgU3R5bGVkVGFibGU7IH0sXG4gICAgICAgIGdldCBTdHlsZWRUYWJsZUJvZHkoKSB7IHJldHVybiBTdHlsZWRUYWJsZUJvZHkgYXMgdHlwZW9mIFN0eWxlZFRhYmxlQm9keTsgfVxuICAgIH0gfSk7XG5jb25zdCBIaWRkZW5DZWxsID0gc3R5bGVkLnRkIGBcbiAgZGlzcGxheTogbm9uZTtcbmA7XG5jb25zdCBTdHlsZWRUYWJsZUNlbGwgPSBzdHlsZWQudGQgYFxuICB0ZXh0LWFsaWduOiBsZWZ0O1xuYDtcbmNvbnN0IFN0eWxlZFBsYWNlaG9sZGVyQ2VsbCA9IHN0eWxlZChTdHlsZWRUYWJsZUNlbGwpIGBcbiAgdGV4dC1hbGlnbjogY2VudGVyO1xuYDtcbmZ1bmN0aW9uIGRlZmF1bHRSb3dLZXlHZXR0ZXI8VD4oeyBrZXkgfTogVGFibGVSb3dFdmVudDxUPikge1xuICAgIHJldHVybiBrZXk7XG59XG5mdW5jdGlvbiBub3JtYWxpemVTb3J0Qnkoc29ydEJ5PzogVGFibGVTb3J0aW5nIHwgc3RyaW5nKTogVGFibGVTb3J0aW5nIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXNvcnRCeSkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIHNvcnRCeSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgaWYgKHNvcnRCeVswXSA9PT0gJy0nKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGNvbHVtbktleTogc29ydEJ5LnN1YnN0cigxKSxcbiAgICAgICAgICAgICAgICBvcmRlcjogJ2Rlc2NlbmRpbmcnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgY29sdW1uS2V5OiBzb3J0QnksXG4gICAgICAgICAgICAgICAgb3JkZXI6ICdhc2NlbmRpbmcnLFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgICBjb2x1bW5LZXk6IHNvcnRCeS5jb2x1bW5LZXksXG4gICAgICAgIG9yZGVyOiBzb3J0Qnkub3JkZXIgfHwgJ2FzY2VuZGluZycsXG4gICAgfTtcbn1cbmV4cG9ydCBjbGFzcyBUYWJsZUJhc2ljPFQ+IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFRhYmxlUHJvcHM8VD4gJiBSZWZQcm9wcywgVGFibGVCYXNpY1N0YXRlPiB7XG4gICAgY29uc3RydWN0b3IocHJvcHM6IFRhYmxlUHJvcHM8VD4gJiBSZWZQcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBjb250cm9sbGVkU29ydGluZzogZmFsc2UsXG4gICAgICAgIH07XG4gICAgfVxuICAgIHN0YXRpYyBnZXREZXJpdmVkU3RhdGVGcm9tUHJvcHMocHJvcHM6IFRhYmxlUHJvcHM8YW55Piwgc3RhdGU6IFRhYmxlQmFzaWNTdGF0ZSkge1xuICAgICAgICBjb25zdCBjb250cm9sbGVkU29ydGluZyA9IHByb3BzLnNvcnRCeSAhPT0gdW5kZWZpbmVkIHx8IHN0YXRlLmNvbnRyb2xsZWRTb3J0aW5nO1xuICAgICAgICBpZiAoY29udHJvbGxlZFNvcnRpbmcpIHtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgc29ydGluZzogbm9ybWFsaXplU29ydEJ5KHByb3BzLnNvcnRCeSksXG4gICAgICAgICAgICAgICAgY29udHJvbGxlZFNvcnRpbmcsXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdGF0ZTtcbiAgICB9XG4gICAgcHJpdmF0ZSBnZXRJbmRpY2VzID0gbWVtb2l6ZSgoZGF0YTogQXJyYXk8VD4sIGdyb3VwaW5nPzoga2V5b2YgVCwgc29ydGluZz86IFRhYmxlU29ydGluZykgPT4gc29ydGluZ1xuICAgICAgICA/IHNvcnRPYmplY3RMaXN0KGRhdGEsIHNvcnRpbmcuY29sdW1uS2V5IGFzIGtleW9mIFQsIHNvcnRpbmcub3JkZXIsIGdyb3VwaW5nKVxuICAgICAgICA6IHNvcnRPYmplY3RMaXN0KGRhdGEsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBncm91cGluZykpO1xuICAgIHByaXZhdGUgaXNTb3J0YWJsZShrZXk6IHN0cmluZywgY29sczogVGFibGVDb2x1bW5zKSB7XG4gICAgICAgIGNvbnN0IHsgc29ydEJ5IH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBjb2wgPSBjb2xzW2tleV07XG4gICAgICAgIHJldHVybiAhc29ydEJ5ICYmICghY29sIHx8ICh0eXBlb2YgY29sICE9PSAnc3RyaW5nJyAmJiBjb2wuc29ydGFibGUpKTtcbiAgICB9XG4gICAgcHJpdmF0ZSBoZWFkZXJDbGlja2VkKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTFRhYmxlQ2VsbEVsZW1lbnQ+LCBjb2x1bW46IG51bWJlciwga2V5OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgeyBvbkhlYWRlckNsaWNrLCBvblNvcnQsIGRhdGEgPSBbXSwgY29sdW1ucyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICBpZiAodHlwZW9mIG9uSGVhZGVyQ2xpY2sgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIG9uSGVhZGVyQ2xpY2soe1xuICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgcm93OiAtMSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHRoaXMuaXNTb3J0YWJsZShrZXksIGdldENvbHVtbnMoZGF0YSwgY29sdW1ucykpKSB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKCh7IHNvcnRpbmcgfSkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlzQXNjZW5kaW5nID0gc29ydGluZyAmJiBzb3J0aW5nLm9yZGVyID09PSAnZGVzY2VuZGluZycgJiYgc29ydGluZy5jb2x1bW5LZXkgPT09IGtleTtcbiAgICAgICAgICAgICAgICBjb25zdCBvcmRlciA9IHNvcnRpbmcgJiYgc29ydGluZy5jb2x1bW5LZXkgPT09IGtleSA/ICdkZXNjZW5kaW5nJyA6ICdhc2NlbmRpbmcnO1xuICAgICAgICAgICAgICAgIGxldCBuZXdTb3J0aW5nVmFsdWU6IFRhYmxlU29ydGluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcbiAgICAgICAgICAgICAgICBpZiAoIWlzQXNjZW5kaW5nICYmIGNvbHVtbiAhPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3U29ydGluZ1ZhbHVlID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uS2V5OiBrZXksXG4gICAgICAgICAgICAgICAgICAgICAgICBvcmRlcixcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc29ydGluZzogbmV3U29ydGluZ1ZhbHVlIH07XG4gICAgICAgICAgICB9LCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZiBvblNvcnQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICAgICAgb25Tb3J0KHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbixcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG9yZGVyOiB0aGlzLnN0YXRlLnNvcnRpbmcgJiYgdGhpcy5zdGF0ZS5zb3J0aW5nLm9yZGVyLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIGZvb3RlckNsaWNrZWQoZTogUmVhY3QuTW91c2VFdmVudDxIVE1MVGFibGVDZWxsRWxlbWVudD4sIGNvbHVtbjogbnVtYmVyLCBrZXk6IHN0cmluZykge1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIGNvbnN0IHsgb25Gb290ZXJDbGljayB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgaWYgKHR5cGVvZiBvbkZvb3RlckNsaWNrID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBvbkZvb3RlckNsaWNrKHtcbiAgICAgICAgICAgICAgICBjb2x1bW4sXG4gICAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICAgIHJvdzogLTEsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIGRlZmF1bHRIZWFkUmVuZGVyZXIgPSAoeyBjb2x1bW5zLCBzb3J0QnksIGtleXMgfTogVGFibGVTZWN0aW9uUmVuZGVyRXZlbnQ8VD4pID0+IHtcbiAgICAgICAgY29uc3QgeyBvblNvcnQgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRIZWFkZXJDZWxsUmVuZGVyZXIgPSBnZXREZWZhdWx0SGVhZGVyQ2VsbFJlbmRlcmVyKChjb2x1bW5LZXksIG9yZGVyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgICAgICAgICAgICBzb3J0aW5nOiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbktleSxcbiAgICAgICAgICAgICAgICAgICAgb3JkZXIsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0sICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodHlwZW9mIG9uU29ydCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICBvblNvcnQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBrZXlzLmluZGV4T2YoY29sdW1uS2V5KSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGtleTogY29sdW1uS2V5LFxuICAgICAgICAgICAgICAgICAgICAgICAgb3JkZXIsXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgeyBpbmRleGVkLCB0aGVtZSwgaGVhZGVyQ2VsbFJlbmRlcmVyID0gZGVmYXVsdEhlYWRlckNlbGxSZW5kZXJlciB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuICg8U3R5bGVkVGFibGVIZWFkIHRoZW1lPXt0aGVtZX0+XG4gICAgICAgIDxTdHlsZWRUYWJsZUhlYWRlclJvdyB0aGVtZT17dGhlbWV9PlxuICAgICAgICAgIHtpbmRleGVkICYmICg8U3R5bGVkVGFibGVIZWFkZXIgb25DbGljaz17ZSA9PiB0aGlzLmhlYWRlckNsaWNrZWQoZSwgLTEsICcjJyl9IHRoZW1lPXt0aGVtZX0+XG4gICAgICAgICAgICAgIHtoZWFkZXJDZWxsUmVuZGVyZXIoe1xuICAgICAgICAgICAgY29sdW1uOiAtMSxcbiAgICAgICAgICAgIGtleTogJycsXG4gICAgICAgICAgICByb3c6IC0xLFxuICAgICAgICAgICAgdmFsdWU6ICcjJyxcbiAgICAgICAgICAgIHJlbmRlcjogZGVmYXVsdEhlYWRlckNlbGxSZW5kZXJlcixcbiAgICAgICAgfSl9XG4gICAgICAgICAgICA8L1N0eWxlZFRhYmxlSGVhZGVyPil9XG4gICAgICAgICAge2tleXMubWFwKChrZXksIGNlbGwpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbHVtbiA9IGNvbHVtbnNba2V5XTtcbiAgICAgICAgICAgIGNvbnN0IGhpZGRlbiA9IHR5cGVvZiBjb2x1bW4gIT09ICdzdHJpbmcnICYmIGNvbHVtbi5oaWRkZW47XG4gICAgICAgICAgICBpZiAoIWhpZGRlbikge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWUgPSB0eXBlb2YgY29sdW1uID09PSAnc3RyaW5nJyA/IGNvbHVtbiA6IGNvbHVtbi5oZWFkZXI7XG4gICAgICAgICAgICAgICAgY29uc3Qgd2lkdGggPSB0eXBlb2YgY29sdW1uID09PSAnc3RyaW5nJyA/IHVuZGVmaW5lZCA6IGNvbHVtbi53aWR0aDtcbiAgICAgICAgICAgICAgICBjb25zdCBzb3J0YWJsZSA9IHRoaXMuaXNTb3J0YWJsZShrZXksIGNvbHVtbnMpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRpcmVjdGlvbiA9IHNvcnRhYmxlICYmIHNvcnRCeSAmJiAoc29ydEJ5LmNvbHVtbktleSAhPT0ga2V5ID8gdW5kZWZpbmVkIDogc29ydEJ5Lm9yZGVyKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDxTdHlsZWRUYWJsZUhlYWRlciBzb3J0YWJsZT17c29ydGFibGV9IHdpZHRoPXt3aWR0aH0ga2V5PXtrZXl9IG9uQ2xpY2s9e2UgPT4gdGhpcy5oZWFkZXJDbGlja2VkKGUsIGNlbGwsIGtleSl9IHRoZW1lPXt0aGVtZX0+XG4gICAgICAgICAgICAgICAgICB7aGVhZGVyQ2VsbFJlbmRlcmVyKHtcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBjZWxsLFxuICAgICAgICAgICAgICAgICAgICBrZXksXG4gICAgICAgICAgICAgICAgICAgIHJvdzogLTEsXG4gICAgICAgICAgICAgICAgICAgIHNvcnRpbmc6IGRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGVmYXVsdEhlYWRlckNlbGxSZW5kZXJlcixcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICAgICAgICA8L1N0eWxlZFRhYmxlSGVhZGVyPik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gPEhpZGRlbkNlbGwga2V5PXtrZXl9Lz47XG4gICAgICAgIH0pfVxuICAgICAgICA8L1N0eWxlZFRhYmxlSGVhZGVyUm93PlxuICAgICAgPC9TdHlsZWRUYWJsZUhlYWQ+KTtcbiAgICB9O1xuICAgIHByaXZhdGUgZGVmYXVsdEZvb3RSZW5kZXJlciA9ICh7IGNvbHVtbnMsIGtleXMsIHNvcnRCeSB9OiBUYWJsZVNlY3Rpb25SZW5kZXJFdmVudDxUPikgPT4ge1xuICAgICAgICBjb25zdCB7IGluZGV4ZWQsIHRoZW1lLCBmb290ZXJDZWxsUmVuZGVyZXIgPSBkZWZhdWx0Q2VsbFJlbmRlcmVyIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICByZXR1cm4gKDxTdHlsZWRUYWJsZUZvb3QgdGhlbWU9e3RoZW1lfT5cbiAgICAgICAgPFN0eWxlZFRhYmxlUm93IHRoZW1lPXt0aGVtZX0+XG4gICAgICAgICAge2luZGV4ZWQgJiYgKDxTdHlsZWRUYWJsZUNlbGwgb25DbGljaz17ZSA9PiB0aGlzLmZvb3RlckNsaWNrZWQoZSwgLTEsICcjJyl9IHRoZW1lPXt0aGVtZX0+XG4gICAgICAgICAgICAgIHtmb290ZXJDZWxsUmVuZGVyZXIoe1xuICAgICAgICAgICAgY29sdW1uOiAtMSxcbiAgICAgICAgICAgIGtleTogJycsXG4gICAgICAgICAgICByb3c6IC0xLFxuICAgICAgICAgICAgdmFsdWU6ICcnLFxuICAgICAgICAgICAgcmVuZGVyOiBkZWZhdWx0Q2VsbFJlbmRlcmVyLFxuICAgICAgICB9KX1cbiAgICAgICAgICAgIDwvU3R5bGVkVGFibGVDZWxsPil9XG4gICAgICAgICAge2tleXMubWFwKChrZXksIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbHVtbiA9IGNvbHVtbnNba2V5XTtcbiAgICAgICAgICAgIGNvbnN0IHNvcnRhYmxlID0gdGhpcy5pc1NvcnRhYmxlKGtleSwgY29sdW1ucyk7XG4gICAgICAgICAgICBjb25zdCBkaXJlY3Rpb24gPSBzb3J0YWJsZSAmJiBzb3J0QnkgJiYgKHNvcnRCeS5jb2x1bW5LZXkgIT09IGtleSA/IHVuZGVmaW5lZCA6IHNvcnRCeS5vcmRlcik7XG4gICAgICAgICAgICBjb25zdCBoaWRkZW4gPSB0eXBlb2YgY29sdW1uICE9PSAnc3RyaW5nJyAmJiBjb2x1bW4uaGlkZGVuO1xuICAgICAgICAgICAgaWYgKCFoaWRkZW4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lID0gdHlwZW9mIGNvbHVtbiA9PT0gJ3N0cmluZycgPyB1bmRlZmluZWQgOiBjb2x1bW4uZm9vdGVyO1xuICAgICAgICAgICAgICAgIHJldHVybiAoPFN0eWxlZFRhYmxlQ2VsbCBrZXk9e2tleX0gdGhlbWU9e3RoZW1lfSBvbkNsaWNrPXtlID0+IHRoaXMuZm9vdGVyQ2xpY2tlZChlLCBpLCBrZXkpfT5cbiAgICAgICAgICAgICAgICAgIHtmb290ZXJDZWxsUmVuZGVyZXIoe1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGksXG4gICAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgICAgcm93OiAtMSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHNvcnRpbmc6IGRpcmVjdGlvbixcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBkZWZhdWx0Q2VsbFJlbmRlcmVyLFxuICAgICAgICAgICAgICAgIH0pfVxuICAgICAgICAgICAgICAgIDwvU3R5bGVkVGFibGVDZWxsPik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gPEhpZGRlbkNlbGwga2V5PXtrZXl9Lz47XG4gICAgICAgIH0pfVxuICAgICAgICA8L1N0eWxlZFRhYmxlUm93PlxuICAgICAgPC9TdHlsZWRUYWJsZUZvb3Q+KTtcbiAgICB9O1xuICAgIHByaXZhdGUgZGVmYXVsdFJvd1JlbmRlcmVyID0gKHsgY2VsbHMsIGluZGV4IH06IFRhYmxlUm93RXZlbnQ8VD4pID0+IHtcbiAgICAgICAgY29uc3QgeyB0aGVtZSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuICg8U3R5bGVkVGFibGVSb3cga2V5PXtpbmRleH0gdGhlbWU9e3RoZW1lfT5cbiAgICAgICAge2NlbGxzfVxuICAgICAgPC9TdHlsZWRUYWJsZVJvdz4pO1xuICAgIH07XG4gICAgcHJpdmF0ZSByZW5kZXJDZWxscyhrZXlzOiBBcnJheTxzdHJpbmc+LCByb3dJbmRleDogbnVtYmVyKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSA9IFtdLCBjZWxsUmVuZGVyZXIgPSBkZWZhdWx0Q2VsbFJlbmRlcmVyLCBpbmRleGVkLCB0aGVtZSwgY29sdW1ucywgb25EYXRhQ2xpY2sgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGNvbHMgPSBnZXRDb2x1bW5zKGRhdGEsIGNvbHVtbnMpO1xuICAgICAgICBjb25zdCByb3cgPSBkYXRhW3Jvd0luZGV4XTtcbiAgICAgICAgY29uc3QgY2VsbHMgPSBrZXlzLm1hcCgoa2V5LCBjZWxsKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb2x1bW4gPSBjb2xzW2tleV07XG4gICAgICAgICAgICBjb25zdCBoaWRkZW4gPSB0eXBlb2YgY29sdW1uICE9PSAnc3RyaW5nJyAmJiBjb2x1bW4uaGlkZGVuO1xuICAgICAgICAgICAgaWYgKCFoaWRkZW4pIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gKDxTdHlsZWRUYWJsZUNlbGwga2V5PXtrZXl9IG9uQ2xpY2s9e2hhbmRsZURhdGFDbGlja2VkRXZlbnQoeyByb3c6IHJvd0luZGV4LCBjb2x1bW46IGNlbGwsIGtleSwgZGF0YTogcm93IH0sIG9uRGF0YUNsaWNrKX0gdGhlbWU9e3RoZW1lfT5cbiAgICAgICAgICAgIHtjZWxsUmVuZGVyZXIoe1xuICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGNlbGwsXG4gICAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogcm93LFxuICAgICAgICAgICAgICAgICAgICByb3c6IHJvd0luZGV4LFxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogcm93W2tleV0sXG4gICAgICAgICAgICAgICAgICAgIHJlbmRlcjogZGVmYXVsdENlbGxSZW5kZXJlcixcbiAgICAgICAgICAgICAgICB9KX1cbiAgICAgICAgICA8L1N0eWxlZFRhYmxlQ2VsbD4pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIDxIaWRkZW5DZWxsIGtleT17a2V5fS8+O1xuICAgICAgICB9KTtcbiAgICAgICAgaWYgKGluZGV4ZWQpIHtcbiAgICAgICAgICAgIGNlbGxzLnVuc2hpZnQoPFN0eWxlZFRhYmxlQ2VsbCBrZXk9XCJpbmRleCNcIiBvbkNsaWNrPXtoYW5kbGVEYXRhQ2xpY2tlZEV2ZW50KHsgcm93OiByb3dJbmRleCwgY29sdW1uOiAtMSwga2V5OiAnX19pbmRleGVkJywgZGF0YTogcm93IH0sIG9uRGF0YUNsaWNrKX0gdGhlbWU9e3RoZW1lfT5cbiAgICAgICAgICB7cm93SW5kZXggKyAxfVxuICAgICAgICA8L1N0eWxlZFRhYmxlQ2VsbD4pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjZWxscztcbiAgICB9XG4gICAgcHJpdmF0ZSByZW5kZXJSb3dzKGtleXM6IEFycmF5PHN0cmluZz4pIHtcbiAgICAgICAgY29uc3QgeyBkYXRhLCBncm91cEJ5LCBpbmRleGVkLCBwbGFjZWhvbGRlciwgcm93UmVuZGVyZXIgPSB0aGlzLmRlZmF1bHRSb3dSZW5kZXJlciwgZ2V0Um93S2V5ID0gZGVmYXVsdFJvd0tleUdldHRlciwgdGhlbWUsIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCBpbmRpY2VzID0gdGhpcy5nZXRJbmRpY2VzKGRhdGEsIGdyb3VwQnksIHRoaXMuc3RhdGUuc29ydGluZyk7XG4gICAgICAgIGNvbnN0IGNvbHMgPSBrZXlzLmxlbmd0aCArIChpbmRleGVkID8gMSA6IDApO1xuICAgICAgICBjb25zdCBzdGF0ZSA9IHt9O1xuICAgICAgICBpZiAoaW5kaWNlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIHJldHVybiBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAgICAgICA8U3R5bGVkVGFibGVSb3cgdGhlbWU9e3RoZW1lfSBrZXk9XCJwbGFjZWhvbGRlclwiPlxuICAgICAgICAgICAgICA8U3R5bGVkUGxhY2Vob2xkZXJDZWxsIGNvbFNwYW49e2NvbHN9IHRoZW1lPXt0aGVtZX0+XG4gICAgICAgICAgICAgICAge3BsYWNlaG9sZGVyfVxuICAgICAgICAgICAgICA8L1N0eWxlZFBsYWNlaG9sZGVyQ2VsbD5cbiAgICAgICAgICAgIDwvU3R5bGVkVGFibGVSb3c+LFxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICA6IFtdO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGluZGljZXMubWFwKGluZGV4ID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBjZWxscyA9IHRoaXMucmVuZGVyQ2VsbHMoa2V5cywgaW5kZXgpO1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbmRlckRhdGEgPSB7IHRoZW1lLCBpbmRleCwgY2VsbHMsIGRhdGE6IGRhdGFbaW5kZXhdLCBrZXk6IGluZGV4LnRvU3RyaW5nKCksIHN0YXRlIH07XG4gICAgICAgICAgICAgICAgcmVuZGVyRGF0YS5rZXkgPSBnZXRSb3dLZXkocmVuZGVyRGF0YSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHJvd1JlbmRlcmVyKHJlbmRlckRhdGEpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJpdmF0ZSByZW5kZXJIZWFkKGtleXM6IEFycmF5PHN0cmluZz4pIHtcbiAgICAgICAgY29uc3QgeyBoZWFkUmVuZGVyZXIgPSB0aGlzLmRlZmF1bHRIZWFkUmVuZGVyZXIsIGdyb3VwQnksIGRhdGEgPSBbXSwgY29sdW1ucyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgeyBzb3J0aW5nIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICByZXR1cm4gaGVhZFJlbmRlcmVyKHtcbiAgICAgICAgICAgIGNvbHVtbnM6IGdldENvbHVtbnMoZGF0YSwgY29sdW1ucyksXG4gICAgICAgICAgICBzb3J0Qnk6IHNvcnRpbmcsXG4gICAgICAgICAgICBncm91cEJ5LFxuICAgICAgICAgICAgZGF0YSxcbiAgICAgICAgICAgIGtleXMsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBwcml2YXRlIHJlbmRlckZvb3Qoa2V5czogQXJyYXk8c3RyaW5nPikge1xuICAgICAgICBjb25zdCB7IGZvb3RSZW5kZXJlciA9IHRoaXMuZGVmYXVsdEZvb3RSZW5kZXJlciwgZ3JvdXBCeSwgZGF0YSA9IFtdLCBjb2x1bW5zIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7IHNvcnRpbmcgfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIHJldHVybiBmb290UmVuZGVyZXIoe1xuICAgICAgICAgICAgY29sdW1uczogZ2V0Q29sdW1ucyhkYXRhLCBjb2x1bW5zKSxcbiAgICAgICAgICAgIHNvcnRCeTogc29ydGluZyxcbiAgICAgICAgICAgIGdyb3VwQnksXG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAga2V5cyxcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhID0gW10sIGNvbHVtbnMsIG5vSGVhZGVyLCB0aGVtZSwgYm9keVJlbmRlcmVyID0gZGVmYXVsdEJvZHlSZW5kZXJlciwgY2VsbFJlbmRlcmVyOiBfMSwgaW5kZXhlZDogXzIsIHNvcnRCeTogXzMsIG9uRGF0YUNsaWNrOiBfNCwgb25Gb290ZXJDbGljazogXzUsIG9uSGVhZGVyQ2xpY2s6IF82LCBwbGFjZWhvbGRlcjogXzcsIGNvbHVtbnM6IF84LCBncm91cEJ5OiBfOSwgaGVhZFJlbmRlcmVyOiBfMTAsIGZvb3RSZW5kZXJlcjogXzExLCBoZWFkZXJDZWxsUmVuZGVyZXI6IF8xMiwgZm9vdGVyQ2VsbFJlbmRlcmVyOiBfMTMsIG9uU29ydDogXzE0LCAuLi5wcm9wcyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgY29scyA9IGdldENvbHVtbnMoZGF0YSwgY29sdW1ucyk7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhjb2xzKTtcbiAgICAgICAgY29uc3Qgc2hvd0Zvb3RlciA9IGtleXMuZmlsdGVyKGtleSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjb2wgPSBjb2xzW2tleV07XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGNvbCA9PT0gJ29iamVjdCcgJiYgISFjb2wuZm9vdGVyICYmICFjb2wuaGlkZGVuO1xuICAgICAgICB9KS5sZW5ndGggPiAwO1xuICAgICAgICBjb25zdCByb3dzID0gdGhpcy5yZW5kZXJSb3dzKGtleXMpO1xuICAgICAgICByZXR1cm4gYm9keVJlbmRlcmVyKHtcbiAgICAgICAgICAgIHRhYmxlOiBUYWJsZUhvc3QsXG4gICAgICAgICAgICBwcm9wczoge1xuICAgICAgICAgICAgICAgIHRoZW1lLFxuICAgICAgICAgICAgICAgIGhlYWQ6ICFub0hlYWRlciAmJiB0aGlzLnJlbmRlckhlYWQoa2V5cyksXG4gICAgICAgICAgICAgICAgZm9vdDogc2hvd0Zvb3RlciAmJiB0aGlzLnJlbmRlckZvb3Qoa2V5cyksXG4gICAgICAgICAgICAgICAgLi4ucHJvcHMsXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgcm93cyxcbiAgICAgICAgICAgIG1vZGU6ICd0YWJsZScsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBzdGF0aWMgaW5uZXIgPSB7XG4gICAgICAgIGdldCBTdHlsZWRUYWJsZUhlYWQoKSB7IHJldHVybiBTdHlsZWRUYWJsZUhlYWQgYXMgdHlwZW9mIFN0eWxlZFRhYmxlSGVhZDsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZFRhYmxlSGVhZGVyUm93KCkgeyByZXR1cm4gU3R5bGVkVGFibGVIZWFkZXJSb3cgYXMgdHlwZW9mIFN0eWxlZFRhYmxlSGVhZGVyUm93OyB9LFxuICAgICAgICBnZXQgU3R5bGVkVGFibGVIZWFkZXIoKSB7IHJldHVybiBTdHlsZWRUYWJsZUhlYWRlciBhcyB0eXBlb2YgU3R5bGVkVGFibGVIZWFkZXI7IH0sXG4gICAgICAgIGdldCBIaWRkZW5DZWxsKCkgeyByZXR1cm4gSGlkZGVuQ2VsbCBhcyB0eXBlb2YgSGlkZGVuQ2VsbDsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZFRhYmxlRm9vdCgpIHsgcmV0dXJuIFN0eWxlZFRhYmxlRm9vdCBhcyB0eXBlb2YgU3R5bGVkVGFibGVGb290OyB9LFxuICAgICAgICBnZXQgU3R5bGVkVGFibGVSb3coKSB7IHJldHVybiBTdHlsZWRUYWJsZVJvdyBhcyB0eXBlb2YgU3R5bGVkVGFibGVSb3c7IH0sXG4gICAgICAgIGdldCBTdHlsZWRUYWJsZUNlbGwoKSB7IHJldHVybiBTdHlsZWRUYWJsZUNlbGwgYXMgdHlwZW9mIFN0eWxlZFRhYmxlQ2VsbDsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZFBsYWNlaG9sZGVyQ2VsbCgpIHsgcmV0dXJuIFN0eWxlZFBsYWNlaG9sZGVyQ2VsbCBhcyB0eXBlb2YgU3R5bGVkUGxhY2Vob2xkZXJDZWxsOyB9XG4gICAgfTtcbn1cbiJdfQ==
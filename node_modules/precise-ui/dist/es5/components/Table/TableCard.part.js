"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = require("react");
var styled_1 = require("../../utils/styled");
var List_1 = require("../List");
var ListItem_1 = require("../ListItem");
var TableShared_part_1 = require("./TableShared.part");
var distance_1 = require("../../distance");
var textStyles_1 = require("../../textStyles");
var Container = styled_1.default.div(styled_1.themed(function (_a) {
    var _b = _a.theme, ui4 = _b.ui4, text1 = _b.text1;
    return styled_1.css(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n      ", "\n\n      position: relative;\n      border: 1px solid ", ";\n      color: ", ";\n    "], ["\n      ", "\n\n      position: relative;\n      border: 1px solid ", ";\n      color: ", ";\n    "])), textStyles_1.getFontStyle({ size: 'medium' }), ui4, text1);
}));
var ContentContainer = styled_1.default.div(templateObject_2 || (templateObject_2 = __makeTemplateObject(["\n  padding: ", " ", " ", ";\n"], ["\n  padding: ", " ", " ", ";\n"])), distance_1.distance.medium, distance_1.distance.medium, distance_1.distance.large);
var PropContainer = styled_1.default.div(templateObject_3 || (templateObject_3 = __makeTemplateObject(["\n  margin-bottom: ", ";\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n"], ["\n  margin-bottom: ", ";\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n"])), distance_1.distance.medium);
PropContainer.displayName = 'PropContainer';
var PropName = styled_1.default.div(templateObject_4 || (templateObject_4 = __makeTemplateObject(["\n  ", "\n"], ["\n  ", "\n"])), textStyles_1.getFontStyle({ size: 'xSmall' }));
var PropValue = styled_1.default.div(templateObject_5 || (templateObject_5 = __makeTemplateObject(["\n  ", "\n"], ["\n  ", "\n"])), textStyles_1.getFontStyle({ weight: 'medium' }));
var PlaceholderContainer = styled_1.default.div(templateObject_6 || (templateObject_6 = __makeTemplateObject(["\n  text-align: center;\n"], ["\n  text-align: center;\n"])));
var StyledListItem = styled_1.default(ListItem_1.ListItem)(templateObject_7 || (templateObject_7 = __makeTemplateObject(["\n  padding: 0;\n  margin-bottom: ", ";\n  border: none;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n"], ["\n  padding: 0;\n  margin-bottom: ", ";\n  border: none;\n\n  &:last-child {\n    margin-bottom: 0;\n  }\n"])), distance_1.distance.xlarge);
function defaultBodyRenderer(e) {
    var CardBody = e.table;
    return React.createElement(CardBody, null, e.rows);
}
exports.defaultBodyRenderer = defaultBodyRenderer;
var TableCardHost = Object.assign((function (props) { return React.createElement(List_1.List, __assign({}, props)); }), { inner: {
        get List() { return List_1.List; }
    } });
var TableCard = /** @class */ (function (_super) {
    __extends(TableCard, _super);
    function TableCard(props) {
        var _this = _super.call(this, props) || this;
        _this.renderItem = function (_a) {
            var item = _a.item, index = _a.index, keys = _a.keys;
            var theme = _this.props.theme;
            return (React.createElement(StyledListItem, { theme: theme, key: index },
                React.createElement(Container, { theme: theme },
                    React.createElement(ContentContainer, { theme: theme }, _this.renderItemProps(item, index, keys)))));
        };
        return _this;
    }
    TableCard.prototype.getHeader = function (key) {
        var columns = this.props.columns;
        if (columns) {
            var column = columns[key];
            return typeof column === 'string' ? column : column.header;
        }
        return key;
    };
    TableCard.prototype.renderItemProps = function (item, rowIndex, keys) {
        var _this = this;
        var _a = this.props, columns = _a.columns, _b = _a.cellRenderer, cellRenderer = _b === void 0 ? TableShared_part_1.defaultCellRenderer : _b, data = _a.data, onDataClick = _a.onDataClick;
        return keys
            .map(function (key, colIndex) {
            var column = columns ? columns[key] : key;
            if (typeof column === 'string' || !column.hidden) {
                var propKey = _this.getHeader(key);
                var value = cellRenderer({
                    column: colIndex,
                    row: rowIndex,
                    key: key,
                    value: item[key],
                    data: item,
                    render: TableShared_part_1.defaultCellRenderer,
                });
                return (React.createElement(PropContainer, { key: colIndex, onClick: TableShared_part_1.handleDataClickedEvent({ row: rowIndex, column: colIndex, key: key, data: data[rowIndex] }, onDataClick) },
                    React.createElement(PropName, null, propKey),
                    React.createElement(PropValue, null, value)));
            }
            return undefined;
        })
            .filter(function (m) { return !!m; });
    };
    TableCard.prototype.render = function () {
        var _a = this.props, _b = _a.data, data = _b === void 0 ? [] : _b, columns = _a.columns, placeholder = _a.placeholder, theme = _a.theme, _c = _a.cardRenderer, cardRenderer = _c === void 0 ? this.renderItem : _c, _d = _a.bodyRenderer, bodyRenderer = _d === void 0 ? defaultBodyRenderer : _d, props = __rest(_a, ["data", "columns", "placeholder", "theme", "cardRenderer", "bodyRenderer"]);
        var keys = Object.keys(columns || data[0] || {});
        var rows = data.length === 0
            ? placeholder
                ? [
                    React.createElement(StyledListItem, { theme: theme, key: 0 },
                        React.createElement(PlaceholderContainer, { theme: theme }, placeholder)),
                ]
                : []
            : data.map(function (item, index) { return cardRenderer({ item: item, index: index, keys: keys }); });
        return bodyRenderer({
            table: TableCardHost,
            props: __assign({ theme: theme, borderless: true }, props),
            rows: rows,
            mode: 'card',
        });
    };
    TableCard.inner = {
        get StyledListItem() { return StyledListItem; },
        get Container() { return Container; },
        get ContentContainer() { return ContentContainer; },
        get PropContainer() { return PropContainer; },
        get PropName() { return PropName; },
        get PropValue() { return PropValue; },
        get PlaceholderContainer() { return PlaceholderContainer; }
    };
    return TableCard;
}(React.Component));
exports.TableCard = TableCard;
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6, templateObject_7;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGFibGVDYXJkLnBhcnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9UYWJsZS9UYWJsZUNhcmQucGFydC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsNkJBQStCO0FBQy9CLDZDQUF5RDtBQUN6RCxnQ0FBK0I7QUFDL0Isd0NBQXVDO0FBRXZDLHVEQUFpRjtBQUNqRiwyQ0FBMEM7QUFDMUMsK0NBQWdEO0FBQ2hELElBQU0sU0FBUyxHQUFHLGdCQUFNLENBQUMsR0FBRyxDQUFDLGVBQU0sQ0FBQyxVQUFDLEVBQXlCO1FBQXZCLGFBQXFCLEVBQVosWUFBRyxFQUFFLGdCQUFLO0lBQVMsT0FBQSxZQUFHLHVLQUFDLFVBQy9ELEVBQWdDLHlEQUdkLEVBQUcsa0JBQ2QsRUFBSyxTQUNmLEtBTEcseUJBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQyxFQUdkLEdBQUcsRUFDZCxLQUFLO0FBTCtDLENBTTlELENBQUMsQ0FBQyxDQUFDO0FBQ1IsSUFBTSxnQkFBZ0IsR0FBRyxnQkFBTSxDQUFDLEdBQUcsbUdBQUMsZUFDdkIsRUFBZSxHQUFJLEVBQWUsR0FBSSxFQUFjLEtBQ2hFLEtBRFksbUJBQVEsQ0FBQyxNQUFNLEVBQUksbUJBQVEsQ0FBQyxNQUFNLEVBQUksbUJBQVEsQ0FBQyxLQUFLLENBQ2hFLENBQUM7QUFDRixJQUFNLGFBQWEsR0FBRyxnQkFBTSxDQUFDLEdBQUcsK0lBQUMscUJBQ2QsRUFBZSxxREFLakMsS0FMa0IsbUJBQVEsQ0FBQyxNQUFNLENBS2pDLENBQUM7QUFDRixhQUFhLENBQUMsV0FBVyxHQUFHLGVBQWUsQ0FBQztBQUM1QyxJQUFNLFFBQVEsR0FBRyxnQkFBTSxDQUFDLEdBQUcsK0VBQUMsTUFDeEIsRUFBZ0MsSUFDbkMsS0FERyx5QkFBWSxDQUFDLEVBQUUsSUFBSSxFQUFFLFFB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Q0FBd0IsQ0FDekQ7aUJBQ2Q7Z0JBQ0QsQ0FBQyxDQUFDLEVBQUU7WUFDUixDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxVQUFDLElBQUksRUFBRSxLQUFLLElBQUssT0FBQSxZQUFZLENBQUMsRUFBRSxJQUFJLE1BQUEsRUFBRSxLQUFLLE9BQUEsRUFBRSxJQUFJLE1BQUEsRUFBRSxDQUFDLEVBQW5DLENBQW1DLENBQUMsQ0FBQztRQUNyRSxPQUFPLFlBQVksQ0FBQztZQUNoQixLQUFLLEVBQUUsYUFBYTtZQUNwQixLQUFLLGFBQ0QsS0FBSyxPQUFBLEVBQ0wsVUFBVSxFQUFFLElBQUksSUFDYixLQUFLLENBQ1g7WUFDRCxJQUFJLE1BQUE7WUFDSixJQUFJLEVBQUUsTUFBTTtTQUNmLENBQUMsQ0FBQztJQUNQLENBQUM7SUFDTSxlQUFLLEdBQUc7UUFDWCxJQUFJLGNBQWMsS0FBSyxPQUFPLGNBQXVDLENBQUMsQ0FBQyxDQUFDO1FBQ3hFLElBQUksU0FBUyxLQUFLLE9BQU8sU0FBNkIsQ0FBQyxDQUFDLENBQUM7UUFDekQsSUFBSSxnQkFBZ0IsS0FBSyxPQUFPLGdCQUEyQyxDQUFDLENBQUMsQ0FBQztRQUM5RSxJQUFJLGFBQWEsS0FBSyxPQUFPLGFBQXFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JFLElBQUksUUFBUSxLQUFLLE9BQU8sUUFBMkIsQ0FBQyxDQUFDLENBQUM7UUFDdEQsSUFBSSxTQUFTLEtBQUssT0FBTyxTQUE2QixDQUFDLENBQUMsQ0FBQztRQUN6RCxJQUFJLG9CQUFvQixLQUFLLE9BQU8sb0JBQW1ELENBQUMsQ0FBQyxDQUFDO0tBQzdGLENBQUM7SUFDTixnQkFBQztDQUFBLEFBNUVELENBQWtDLEtBQUssQ0FBQyxTQUFTLEdBNEVoRDtBQTVFWSw4QkFBUyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQsIHsgdGhlbWVkLCBjc3MgfSBmcm9tICcuLi8uLi91dGlscy9zdHlsZWQnO1xuaW1wb3J0IHsgTGlzdCB9IGZyb20gJy4uL0xpc3QnO1xuaW1wb3J0IHsgTGlzdEl0ZW0gfSBmcm9tICcuLi9MaXN0SXRlbSc7XG5pbXBvcnQgeyBUYWJsZVByb3BzLCBUYWJsZUNhcmRSZW5kZXJlckV2ZW50LCBUYWJsZUJvZHlSZW5kZXJFdmVudCB9IGZyb20gJy4vVGFibGUudHlwZXMucGFydCc7XG5pbXBvcnQgeyBkZWZhdWx0Q2VsbFJlbmRlcmVyLCBoYW5kbGVEYXRhQ2xpY2tlZEV2ZW50IH0gZnJvbSAnLi9UYWJsZVNoYXJlZC5wYXJ0JztcbmltcG9ydCB7IGRpc3RhbmNlIH0gZnJvbSAnLi4vLi4vZGlzdGFuY2UnO1xuaW1wb3J0IHsgZ2V0Rm9udFN0eWxlIH0gZnJvbSAnLi4vLi4vdGV4dFN0eWxlcyc7XG5jb25zdCBDb250YWluZXIgPSBzdHlsZWQuZGl2KHRoZW1lZCgoeyB0aGVtZTogeyB1aTQsIHRleHQxIH0gfSkgPT4gY3NzIGBcbiAgICAgICR7Z2V0Rm9udFN0eWxlKHsgc2l6ZTogJ21lZGl1bScgfSl9XG5cbiAgICAgIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICR7dWk0fTtcbiAgICAgIGNvbG9yOiAke3RleHQxfTtcbiAgICBgKSk7XG5jb25zdCBDb250ZW50Q29udGFpbmVyID0gc3R5bGVkLmRpdiBgXG4gIHBhZGRpbmc6ICR7ZGlzdGFuY2UubWVkaXVtfSAke2Rpc3RhbmNlLm1lZGl1bX0gJHtkaXN0YW5jZS5sYXJnZX07XG5gO1xuY29uc3QgUHJvcENvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBtYXJnaW4tYm90dG9tOiAke2Rpc3RhbmNlLm1lZGl1bX07XG5cbiAgJjpsYXN0LWNoaWxkIHtcbiAgICBtYXJnaW4tYm90dG9tOiAwO1xuICB9XG5gO1xuUHJvcENvbnRhaW5lci5kaXNwbGF5TmFtZSA9ICdQcm9wQ29udGFpbmVyJztcbmNvbnN0IFByb3BOYW1lID0gc3R5bGVkLmRpdiBgXG4gICR7Z2V0Rm9udFN0eWxlKHsgc2l6ZTogJ3hTbWFsbCcgfSl9XG5gO1xuY29uc3QgUHJvcFZhbHVlID0gc3R5bGVkLmRpdiBgXG4gICR7Z2V0Rm9udFN0eWxlKHsgd2VpZ2h0OiAnbWVkaXVtJyB9KX1cbmA7XG5jb25zdCBQbGFjZWhvbGRlckNvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG5gO1xuY29uc3QgU3R5bGVkTGlzdEl0ZW0gPSBzdHlsZWQoTGlzdEl0ZW0pIGBcbiAgcGFkZGluZzogMDtcbiAgbWFyZ2luLWJvdHRvbTogJHtkaXN0YW5jZS54bGFyZ2V9O1xuICBib3JkZXI6IG5vbmU7XG5cbiAgJjpsYXN0LWNoaWxkIHtcbiAgICBtYXJnaW4tYm90dG9tOiAwO1xuICB9XG5gO1xuZXhwb3J0IGZ1bmN0aW9uIGRlZmF1bHRCb2R5UmVuZGVyZXIoZTogVGFibGVCb2R5UmVuZGVyRXZlbnQpIHtcbiAgICBjb25zdCBDYXJkQm9keSA9IGUudGFibGU7XG4gICAgcmV0dXJuIDxDYXJkQm9keT57ZS5yb3dzfTwvQ2FyZEJvZHk+O1xufVxuaW50ZXJmYWNlIFRhYmxlQ2FyZEhvc3RQcm9wcyB7XG4gICAgYm9yZGVybGVzczogYm9vbGVhbjtcbn1cbmNvbnN0IFRhYmxlQ2FyZEhvc3QgPSBPYmplY3QuYXNzaWduKCgocHJvcHMgPT4gPExpc3Qgey4uLnByb3BzfS8+KSBhcyBSZWFjdC5TRkM8VGFibGVDYXJkSG9zdFByb3BzPiksIHsgaW5uZXI6IHtcbiAgICAgICAgZ2V0IExpc3QoKSB7IHJldHVybiBMaXN0IGFzIHR5cGVvZiBMaXN0OyB9XG4gICAgfSB9KTtcbmV4cG9ydCBjbGFzcyBUYWJsZUNhcmQ8VD4gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8VGFibGVQcm9wczxUPj4ge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBUYWJsZVByb3BzPFQ+KSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICB9XG4gICAgcHJpdmF0ZSByZW5kZXJJdGVtID0gKHsgaXRlbSwgaW5kZXgsIGtleXMgfTogVGFibGVDYXJkUmVuZGVyZXJFdmVudDxUPikgPT4ge1xuICAgICAgICBjb25zdCB7IHRoZW1lIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICByZXR1cm4gKDxTdHlsZWRMaXN0SXRlbSB0aGVtZT17dGhlbWV9IGtleT17aW5kZXh9PlxuICAgICAgICA8Q29udGFpbmVyIHRoZW1lPXt0aGVtZX0+XG4gICAgICAgICAgPENvbnRlbnRDb250YWluZXIgdGhlbWU9e3RoZW1lfT57dGhpcy5yZW5kZXJJdGVtUHJvcHMoaXRlbSwgaW5kZXgsIGtleXMpfTwvQ29udGVudENvbnRhaW5lcj5cbiAgICAgICAgPC9Db250YWluZXI+XG4gICAgICA8L1N0eWxlZExpc3RJdGVtPik7XG4gICAgfTtcbiAgICBwcml2YXRlIGdldEhlYWRlcihrZXk6IHN0cmluZykge1xuICAgICAgICBjb25zdCB7IGNvbHVtbnMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmIChjb2x1bW5zKSB7XG4gICAgICAgICAgICBjb25zdCBjb2x1bW4gPSBjb2x1bW5zW2tleV07XG4gICAgICAgICAgICByZXR1cm4gdHlwZW9mIGNvbHVtbiA9PT0gJ3N0cmluZycgPyBjb2x1bW4gOiBjb2x1bW4uaGVhZGVyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBrZXk7XG4gICAgfVxuICAgIHByaXZhdGUgcmVuZGVySXRlbVByb3BzKGl0ZW06IFQsIHJvd0luZGV4OiBudW1iZXIsIGtleXM6IEFycmF5PHN0cmluZz4pIHtcbiAgICAgICAgY29uc3QgeyBjb2x1bW5zLCBjZWxsUmVuZGVyZXIgPSBkZWZhdWx0Q2VsbFJlbmRlcmVyLCBkYXRhLCBvbkRhdGFDbGljayB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgcmV0dXJuIGtleXNcbiAgICAgICAgICAgIC5tYXAoKGtleSwgY29sSW5kZXgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbHVtbiA9IGNvbHVtbnMgPyBjb2x1bW5zW2tleV0gOiBrZXk7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbHVtbiA9PT0gJ3N0cmluZycgfHwgIWNvbHVtbi5oaWRkZW4pIHtcbiAgICAgICAgICAgICAgICBjb25zdCBwcm9wS2V5ID0gdGhpcy5nZXRIZWFkZXIoa2V5KTtcbiAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZSA9IGNlbGxSZW5kZXJlcih7XG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogY29sSW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIHJvdzogcm93SW5kZXgsXG4gICAgICAgICAgICAgICAgICAgIGtleSxcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IGl0ZW1ba2V5XSxcbiAgICAgICAgICAgICAgICAgICAgZGF0YTogaXRlbSxcbiAgICAgICAgICAgICAgICAgICAgcmVuZGVyOiBkZWZhdWx0Q2VsbFJlbmRlcmVyLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHJldHVybiAoPFByb3BDb250YWluZXIga2V5PXtjb2xJbmRleH0gb25DbGljaz17aGFuZGxlRGF0YUNsaWNrZWRFdmVudCh7IHJvdzogcm93SW5kZXgsIGNvbHVtbjogY29sSW5kZXgsIGtleSwgZGF0YTogZGF0YVtyb3dJbmRleF0gfSwgb25EYXRhQ2xpY2spfT5cbiAgICAgICAgICAgICAgPFByb3BOYW1lPntwcm9wS2V5fTwvUHJvcE5hbWU+XG4gICAgICAgICAgICAgIDxQcm9wVmFsdWU+e3ZhbHVlfTwvUHJvcFZhbHVlPlxuICAgICAgICAgICAgPC9Qcm9wQ29udGFpbmVyPik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9KVxuICAgICAgICAgICAgLmZpbHRlcihtID0+ICEhbSk7XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBkYXRhID0gW10sIGNvbHVtbnMsIHBsYWNlaG9sZGVyLCB0aGVtZSwgY2FyZFJlbmRlcmVyID0gdGhpcy5yZW5kZXJJdGVtLCBib2R5UmVuZGVyZXIgPSBkZWZhdWx0Qm9keVJlbmRlcmVyLCAuLi5wcm9wcyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKGNvbHVtbnMgfHwgZGF0YVswXSB8fCB7fSk7XG4gICAgICAgIGNvbnN0IHJvd3MgPSBkYXRhLmxlbmd0aCA9PT0gMFxuICAgICAgICAgICAgPyBwbGFjZWhvbGRlclxuICAgICAgICAgICAgICAgID8gW1xuICAgICAgICAgICAgICAgICAgICA8U3R5bGVkTGlzdEl0ZW0gdGhlbWU9e3RoZW1lfSBrZXk9ezB9PlxuICAgICAgICAgICAgICAgIDxQbGFjZWhvbGRlckNvbnRhaW5lciB0aGVtZT17dGhlbWV9PntwbGFjZWhvbGRlcn08L1BsYWNlaG9sZGVyQ29udGFpbmVyPlxuICAgICAgICAgICAgICA8L1N0eWxlZExpc3RJdGVtPixcbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgOiBbXVxuICAgICAgICAgICAgOiBkYXRhLm1hcCgoaXRlbSwgaW5kZXgpID0+IGNhcmRSZW5kZXJlcih7IGl0ZW0sIGluZGV4LCBrZXlzIH0pKTtcbiAgICAgICAgcmV0dXJuIGJvZHlSZW5kZXJlcih7XG4gICAgICAgICAgICB0YWJsZTogVGFibGVDYXJkSG9zdCxcbiAgICAgICAgICAgIHByb3BzOiB7XG4gICAgICAgICAgICAgICAgdGhlbWUsXG4gICAgICAgICAgICAgICAgYm9yZGVybGVzczogdHJ1ZSxcbiAgICAgICAgICAgICAgICAuLi5wcm9wcyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICByb3dzLFxuICAgICAgICAgICAgbW9kZTogJ2NhcmQnLFxuICAgICAgICB9KTtcbiAgICB9XG4gICAgc3RhdGljIGlubmVyID0ge1xuICAgICAgICBnZXQgU3R5bGVkTGlzdEl0ZW0oKSB7IHJldHVybiBTdHlsZWRMaXN0SXRlbSBhcyB0eXBlb2YgU3R5bGVkTGlzdEl0ZW07IH0sXG4gICAgICAgIGdldCBDb250YWluZXIoKSB7IHJldHVybiBDb250YWluZXIgYXMgdHlwZW9mIENvbnRhaW5lcjsgfSxcbiAgICAgICAgZ2V0IENvbnRlbnRDb250YWluZXIoKSB7IHJldHVybiBDb250ZW50Q29udGFpbmVyIGFzIHR5cGVvZiBDb250ZW50Q29udGFpbmVyOyB9LFxuICAgICAgICBnZXQgUHJvcENvbnRhaW5lcigpIHsgcmV0dXJuIFByb3BDb250YWluZXIgYXMgdHlwZW9mIFByb3BDb250YWluZXI7IH0sXG4gICAgICAgIGdldCBQcm9wTmFtZSgpIHsgcmV0dXJuIFByb3BOYW1lIGFzIHR5cGVvZiBQcm9wTmFtZTsgfSxcbiAgICAgICAgZ2V0IFByb3BWYWx1ZSgpIHsgcmV0dXJuIFByb3BWYWx1ZSBhcyB0eXBlb2YgUHJvcFZhbHVlOyB9LFxuICAgICAgICBnZXQgUGxhY2Vob2xkZXJDb250YWluZXIoKSB7IHJldHVybiBQbGFjZWhvbGRlckNvbnRhaW5lciBhcyB0eXBlb2YgUGxhY2Vob2xkZXJDb250YWluZXI7IH1cbiAgICB9O1xufVxuIl19
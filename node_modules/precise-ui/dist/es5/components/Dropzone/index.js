"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __assign = (this && this.__assign) || function () {
    __assign = Object.assign || function(t) {
        for (var s, i = 1, n = arguments.length; i < n; i++) {
            s = arguments[i];
            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
                t[p] = s[p];
        }
        return t;
    };
    return __assign.apply(this, arguments);
};
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = require("react");
var styled_1 = require("../../utils/styled");
var input_1 = require("../../utils/input");
var quarks_1 = require("../../quarks");
var withFormContext_1 = require("../../hoc/withFormContext");
var Icon_1 = require("../Icon");
var IconLink_1 = require("../IconLink");
var Spinner_1 = require("../Spinner");
var distance_1 = require("../../distance");
function getFiles(target, files) {
    if (files === void 0) { files = []; }
    target.push.apply(target, files);
    return target;
}
var StyledDropzone = styled_1.default.div(styled_1.themed(function (_a) {
    var disabled = _a.disabled, active = _a.active, theme = _a.theme;
    return styled_1.css(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n      width: 100%;\n      height: 100%;\n      min-height: 150px;\n      margin: 0 auto;\n      padding: ", ";\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      color: ", ";\n      background-repeat: no-repeat;\n      background-position: center;\n      background-size: contain;\n      background-color: ", ";\n      border: 1px ", ";\n      cursor: ", ";\n      box-sizing: border-box;\n    "], ["\n      width: 100%;\n      height: 100%;\n      min-height: 150px;\n      margin: 0 auto;\n      padding: ", ";\n      display: flex;\n      flex-direction: row;\n      justify-content: center;\n      align-items: center;\n      color: ", ";\n      background-repeat: no-repeat;\n      background-position: center;\n      background-size: contain;\n      background-color: ", ";\n      border: 1px ", ";\n      cursor: ", ";\n      box-sizing: border-box;\n    "])), distance_1.distance.medium, disabled ? theme.textDisabled : theme.text3, disabled ? theme.ui3 : active ? theme.ui2 : theme.ui1, disabled ? "solid " + theme.ui1 : "dashed " + (active ? theme.ui0 : theme.ui4), disabled ? 'no-drop' : 'pointer');
}));
var DropzoneLabel = styled_1.default.div(templateObject_2 || (templateObject_2 = __makeTemplateObject(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  flex: 1;\n  pointer-events: none;\n"], ["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n  flex: 1;\n  pointer-events: none;\n"])));
var StyledLabel = styled_1.default.span(templateObject_3 || (templateObject_3 = __makeTemplateObject(["\n  display: table-cell;\n  vertical-align: middle;\n  text-align: center;\n"], ["\n  display: table-cell;\n  vertical-align: middle;\n  text-align: center;\n"])));
var StyledAction = styled_1.default.div(templateObject_4 || (templateObject_4 = __makeTemplateObject(["\n  margin-top: ", ";\n  visibility: ", ";\n"], ["\n  margin-top: ", ";\n  visibility: ", ";\n"])), distance_1.distance.small, function (props) { return (props.active || props.disabled ? 'hidden' : 'visible'); });
var FileInput = styled_1.default.input(templateObject_5 || (templateObject_5 = __makeTemplateObject(["\n  display: none;\n"], ["\n  display: none;\n"])));
var Remove = styled_1.default.div(templateObject_6 || (templateObject_6 = __makeTemplateObject(["\n  cursor: pointer;\n  line-height: 1;\n"], ["\n  cursor: pointer;\n  line-height: 1;\n"])));
var DropzoneInt = /** @class */ (function (_super) {
    __extends(DropzoneInt, _super);
    function DropzoneInt(props) {
        var _this = _super.call(this, props) || this;
        _this.addFileEntries = function (files) {
            var _a = _this.props, multiple = _a.multiple, form = _a.form, _b = _a.name, name = _b === void 0 ? '' : _b;
            if (!_this.state.controlled) {
                if (form) {
                    form.change({
                        name: name,
                        value: multiple ? _this.state.value.concat(files) : files,
                    });
                }
                else {
                    _this.setState(function (prevState) { return ({
                        value: multiple ? prevState.value.concat(files) : files,
                        previews: [],
                    }); }, function () { return _this.notifyChanges(_this.state.value); });
                }
            }
            else {
                _this.notifyChanges(multiple ? _this.state.value.concat(files) : files);
            }
        };
        _this.onDragOver = function (e) {
            e.preventDefault();
        };
        _this.onDragEnter = function () {
            _this.setState({ over: true });
        };
        _this.onDragLeave = function () {
            _this.setState({ over: false });
        };
        _this.onOpenAction = function () {
            var onOpen = _this.props.onOpen;
            var open = true;
            if (typeof onOpen === 'function') {
                onOpen({
                    preventDefault: function () {
                        open = false;
                    },
                });
            }
            return open;
        };
        _this.onDrop = function (ev) {
            ev.preventDefault();
            _this.setState({ over: false });
            var acceptFiles = _this.onOpenAction();
            if (!_this.props.disabled && acceptFiles) {
                var droppedFiles = getFiles([], ev.dataTransfer.files);
                var files = _this.props.multiple ? droppedFiles : [droppedFiles[0]];
                _this.addFileEntries(files);
            }
        };
        _this.onClick = function (ev) {
            var files = getFiles([], ev.target.files);
            if (files) {
                _this.addFileEntries(files);
            }
            ev.preventDefault();
        };
        _this.setInputRef = function (el) {
            _this.fileInput = el;
        };
        _this.openFilePicker = function () {
            var open = _this.onOpenAction();
            if (open && _this.fileInput) {
                _this.fileInput.click();
            }
        };
        var value = props.value || props.defaultValue || [];
        _this.state = {
            over: false,
            controlled: props.value !== undefined,
            value: value,
            previews: [],
            error: props.error,
        };
        return _this;
    }
    DropzoneInt.prototype.componentDidMount = function () {
        var form = this.props.form;
        var controlled = this.state.controlled;
        if (!controlled && form) {
            form.subscribe(this);
        }
    };
    DropzoneInt.prototype.componentWillUnmount = function () {
        var form = this.props.form;
        var controlled = this.state.controlled;
        if (!controlled && form) {
            form.unsubscribe(this);
        }
    };
    DropzoneInt.prototype.UNSAFE_componentWillReceiveProps = function (e) {
        var _a = this.state, controlled = _a.controlled, value = _a.value;
        if (controlled && e.value && value !== e.value) {
            this.setState(function () { return ({
                value: e.value || [],
                previews: [],
                error: e.error,
            }); });
        }
    };
    DropzoneInt.prototype.removeFileEntry = function (f) {
        var _this = this;
        var _a = this.props, form = _a.form, _b = _a.name, name = _b === void 0 ? '' : _b;
        if (!this.state.controlled) {
            if (form) {
                form.change({
                    name: name,
                    value: this.state.value.filter(function (file) { return f !== file; }),
                });
            }
            else {
                this.setState(function (prevState) { return ({
                    value: prevState.value.filter(function (file) { return f !== file; }),
                    previews: prevState.previews.filter(function (preview) { return preview.file !== f; }),
                }); }, function () { return _this.notifyChanges(_this.state.value); });
            }
        }
        else {
            var files = this.state.value.filter(function (file) { return f !== file; });
            this.notifyChanges(files);
        }
    };
    DropzoneInt.prototype.notifyChanges = function (files) {
        var onChange = this.props.onChange;
        if (typeof onChange === 'function') {
            onChange({
                value: files,
            });
        }
    };
    DropzoneInt.prototype.renderItem = function (f) {
        var _this = this;
        return (React.createElement(quarks_1.StyledFileItem, { key: f.name, name: f.name },
            React.createElement(Remove, { onClick: function () { return _this.removeFileEntry(f); } },
                React.createElement(Icon_1.Icon, { name: "RemoveCircle", size: 1 }))));
    };
    DropzoneInt.prototype.renderPreview = function (f) {
        var _this = this;
        var preview = this.state.previews.filter(function (preview) { return preview.file === f; })[0];
        if (f.size > 1000000 || !f.type.match(/image/)) {
            return this.renderItem(f);
        }
        if (preview) {
            return (React.createElement(quarks_1.StyledFileImagePreview, { key: f.name, src: preview.data },
                React.createElement(Remove, { onClick: function () { return _this.removeFileEntry(f); } },
                    React.createElement(Icon_1.Icon, { name: "RemoveCircle", size: 1 }))));
        }
        var reader = new FileReader();
        reader.onload = (function (file) { return function () {
            var result = reader.result;
            typeof result === 'string' &&
                _this.setState(function (prevState) { return ({
                    previews: prevState.previews.concat([
                        {
                            file: file,
                            data: result,
                        },
                    ]),
                }); });
        }; })(f);
        reader.readAsDataURL(f);
        return (React.createElement(quarks_1.StyledFileImagePreview, { key: f.name },
            React.createElement(Spinner_1.Spinner, { size: "small" })));
    };
    DropzoneInt.prototype.render = function () {
        var _this = this;
        var _a = this.state, value = _a.value, over = _a.over, error = _a.error;
        var _b = this.props, _c = _b.message, message = _c === void 0 ? 'Drop files here to upload' : _c, multiple = _b.multiple, info = _b.info, _d = _b.icon, icon = _d === void 0 ? 'FileDownload' : _d, theme = _b.theme, _0 = _b.value, _1 = _b.defaultValue, disabled = _b.disabled, _2 = _b.onChange, _3 = _b.preview, _5 = _b.onInput, children = _b.children, props = __rest(_b, ["message", "multiple", "info", "icon", "theme", "value", "defaultValue", "disabled", "onChange", "preview", "onInput", "children"]);
        return (React.createElement("div", __assign({}, props),
            React.createElement(StyledDropzone, { active: over, disabled: disabled, onDrop: this.onDrop, onDragOver: this.onDragOver, onDragLeave: this.onDragLeave, onDragEnter: this.onDragEnter, onClick: this.openFilePicker },
                React.createElement(DropzoneLabel, null,
                    React.createElement(Icon_1.Icon, { name: icon, size: 2 }),
                    React.createElement(StyledLabel, null,
                        message,
                        React.createElement(FileInput, { disabled: disabled, ref: this.setInputRef, type: "file", multiple: multiple, value: "", onChange: this.onClick }),
                        React.createElement(StyledAction, { active: over, disabled: disabled },
                            React.createElement(IconLink_1.IconLink, { icon: "Add" }, children))))),
            value && value.length > 0 && (React.createElement(quarks_1.StyledFileList, null, value.map(function (file) { return (_this.props.preview ? _this.renderPreview(file) : _this.renderItem(file)); }))),
            input_1.showInputInfo(error, info)));
    };
    DropzoneInt.inner = {
        get StyledFileItem() { return quarks_1.StyledFileItem; },
        get Remove() { return Remove; },
        get Icon() { return Icon_1.Icon; },
        get StyledFileImagePreview() { return quarks_1.StyledFileImagePreview; },
        get Spinner() { return Spinner_1.Spinner; },
        get StyledDropzone() { return StyledDropzone; },
        get DropzoneLabel() { return DropzoneLabel; },
        get StyledLabel() { return StyledLabel; },
        get FileInput() { return FileInput; },
        get StyledAction() { return StyledAction; },
        get IconLink() { return IconLink_1.IconLink; },
        get StyledFileList() { return quarks_1.StyledFileList; }
    };
    return DropzoneInt;
}(React.Component));
exports.Dropzone = withFormContext_1.withFormContext(DropzoneInt);
exports.Dropzone.displayName = 'Dropzone';
var templateObject_1, templateObject_2, templateObject_3, templateObject_4, templateObject_5, templateObject_6;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9Ecm9wem9uZS9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsNkJBQStCO0FBQy9CLDZDQUF5RDtBQUN6RCwyQ0FBa0Q7QUFDbEQsdUNBQXdHO0FBQ3hHLDZEQUE4RTtBQUM5RSxnQ0FBeUM7QUFHekMsd0NBQXVDO0FBQ3ZDLHNDQUFxQztBQUNyQywyQ0FBMEM7QUEyQjFDLFNBQVMsUUFBUSxDQUFDLE1BQW1CLEVBQUUsS0FBZTtJQUFmLHNCQUFBLEVBQUEsVUFBZTtJQUNsRCxNQUFNLENBQUMsSUFBSSxPQUFYLE1BQU0sRUFBUyxLQUFLLEVBQUU7SUFDdEIsT0FBTyxNQUFNLENBQUM7QUFDbEIsQ0FBQztBQVlELElBQU0sY0FBYyxHQUFHLGdCQUFNLENBQUMsR0FBRyxDQUFzQixlQUFNLENBQUMsVUFBQyxFQUEyQjtRQUF6QixzQkFBUSxFQUFFLGtCQUFNLEVBQUUsZ0JBQUs7SUFBTyxPQUFBLFlBQUcsbWhCQUFDLDZHQUtsRixFQUFlLGdJQUtqQixFQUEyQyx1SUFJaEMsRUFBcUQsdUJBQzNELEVBQTRFLG1CQUNoRixFQUFnQyx3Q0FFM0MsS0FiWSxtQkFBUSxDQUFDLE1BQU0sRUFLakIsUUFBUSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUloQyxRQUFRLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFDM0QsUUFBUSxDQUFDLENBQUMsQ0FBQyxXQUFTLEtBQUssQ0FBQyxHQUFLLENBQUMsQ0FBQyxDQUFDLGFBQVUsTUFBTSxDQUFD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LEtBQUssQ0FBQyxTQUFTLEdBK014QztBQUNZLFFBQUEsUUFBUSxHQUFHLGlDQUFlLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDckQsZ0JBQVEsQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCwgeyB0aGVtZWQsIGNzcyB9IGZyb20gJy4uLy4uL3V0aWxzL3N0eWxlZCc7XG5pbXBvcnQgeyBzaG93SW5wdXRJbmZvIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW5wdXQnO1xuaW1wb3J0IHsgRmlsZUltYWdlUHJldmlldywgU3R5bGVkRmlsZUltYWdlUHJldmlldywgU3R5bGVkRmlsZUl0ZW0sIFN0eWxlZEZpbGVMaXN0IH0gZnJvbSAnLi4vLi4vcXVhcmtzJztcbmltcG9ydCB7IEZvcm1Db250ZXh0UHJvcHMsIHdpdGhGb3JtQ29udGV4dCB9IGZyb20gJy4uLy4uL2hvYy93aXRoRm9ybUNvbnRleHQnO1xuaW1wb3J0IHsgSWNvbiwgSWNvbk5hbWUgfSBmcm9tICcuLi9JY29uJztcbmltcG9ydCB7IElucHV0Q2hhbmdlRXZlbnQsIElucHV0UHJvcHMgfSBmcm9tICcuLi8uLi9jb21tb24nO1xuaW1wb3J0IHsgRmlsZVNlbGVjdE9wZW5FdmVudCB9IGZyb20gJy4uL0ZpbGVTZWxlY3QnO1xuaW1wb3J0IHsgSWNvbkxpbmsgfSBmcm9tICcuLi9JY29uTGluayc7XG5pbXBvcnQgeyBTcGlubmVyIH0gZnJvbSAnLi4vU3Bpbm5lcic7XG5pbXBvcnQgeyBkaXN0YW5jZSB9IGZyb20gJy4uLy4uL2Rpc3RhbmNlJztcbmV4cG9ydCB0eXBlIERyb3B6b25lT3BlbkV2ZW50ID0gRmlsZVNlbGVjdE9wZW5FdmVudDtcbmV4cG9ydCB0eXBlIERyb3B6b25lQ2hhbmdlRXZlbnQgPSBJbnB1dENoYW5nZUV2ZW50PEFycmF5PEZpbGU+PjtcbmV4cG9ydCBpbnRlcmZhY2UgRHJvcHpvbmVQcm9wcyBleHRlbmRzIElucHV0UHJvcHM8QXJyYXk8RmlsZT4+IHtcbiAgICAvKipcbiAgICAgKiBTaG93IHByZXZpZXcgaW5zdGVhZCBvZiBmaWxlIGxpc3QuXG4gICAgICovXG4gICAgcHJldmlldz86IGJvb2xlYW47XG4gICAgLyoqXG4gICAgICogQWxsb3cgYWRkaW5nIG11bHRpcGxlIGZpbGVzLlxuICAgICAqL1xuICAgIG11bHRpcGxlPzogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBPcHRpb25hbGx5IGNob29zZXMgYW4gaWNvbiB0byBkaXNwbGF5LlxuICAgICAqIEBkZWZhdWx0IFwiRmlsZURvd25sb2FkXCJcbiAgICAgKi9cbiAgICBpY29uPzogSWNvbk5hbWU7XG4gICAgLyoqXG4gICAgICogRXZlbnQgZmlyZWQgd2hlbiB0aGUgZmlsZSBwaWNrZXIgc2hvdWxkIGJlIG9wZW5lZC5cbiAgICAgKi9cbiAgICBvbk9wZW4/KGU6IERyb3B6b25lT3BlbkV2ZW50KTogdm9pZDtcbiAgICAvKipcbiAgICAgKiBNZXNzYWdlIGZvciBkcmFnZ2luZyBmaWxlcyB0byBzaG93IG9uIGRyb3AgYXJlYS5cbiAgICAgKiBAZGVmYXVsdCBcIkRyb3AgZmlsZXMgaGVyZSB0byB1cGxvYWRcIlxuICAgICAqL1xuICAgIG1lc3NhZ2U/OiBzdHJpbmc7XG59XG5mdW5jdGlvbiBnZXRGaWxlcyh0YXJnZXQ6IEFycmF5PEZpbGU+LCBmaWxlczogYW55ID0gW10pIHtcbiAgICB0YXJnZXQucHVzaCguLi5maWxlcyk7XG4gICAgcmV0dXJuIHRhcmdldDtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgRHJvcHpvbmVTdGF0ZSB7XG4gICAgdmFsdWU6IEFycmF5PEZpbGU+O1xuICAgIGVycm9yPzogUmVhY3QuUmVhY3RDaGlsZDtcbiAgICBjb250cm9sbGVkOiBib29sZWFuO1xuICAgIG92ZXI6IGJvb2xlYW47XG4gICAgcHJldmlld3M6IEFycmF5PEZpbGVJbWFnZVByZXZpZXc+O1xufVxuaW50ZXJmYWNlIFN0eWxlZERyb3B6b25lUHJvcHMgZXh0ZW5kcyBSZWFjdC5IVE1MQXR0cmlidXRlczxIVE1MRGl2RWxlbWVudD4ge1xuICAgIGFjdGl2ZTogYm9vbGVhbjtcbiAgICBkaXNhYmxlZD86IGJvb2xlYW47XG59XG5jb25zdCBTdHlsZWREcm9wem9uZSA9IHN0eWxlZC5kaXY8U3R5bGVkRHJvcHpvbmVQcm9wcz4odGhlbWVkKCh7IGRpc2FibGVkLCBhY3RpdmUsIHRoZW1lIH0pID0+IGNzcyBgXG4gICAgICB3aWR0aDogMTAwJTtcbiAgICAgIGhlaWdodDogMTAwJTtcbiAgICAgIG1pbi1oZWlnaHQ6IDE1MHB4O1xuICAgICAgbWFyZ2luOiAwIGF1dG87XG4gICAgICBwYWRkaW5nOiAke2Rpc3RhbmNlLm1lZGl1bX07XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgIGNvbG9yOiAke2Rpc2FibGVkID8gdGhlbWUudGV4dERpc2FibGVkIDogdGhlbWUudGV4dDN9O1xuICAgICAgYmFja2dyb3VuZC1yZXBlYXQ6IG5vLXJlcGVhdDtcbiAgICAgIGJhY2tncm91bmQtcG9zaXRpb246IGNlbnRlcjtcbiAgICAgIGJhY2tncm91bmQtc2l6ZTogY29udGFpbjtcbiAgICAgIGJhY2tncm91bmQtY29sb3I6ICR7ZGlzYWJsZWQgPyB0aGVtZS51aTMgOiBhY3RpdmUgPyB0aGVtZS51aTIgOiB0aGVtZS51aTF9O1xuICAgICAgYm9yZGVyOiAxcHggJHtkaXNhYmxlZCA/IGBzb2xpZCAke3RoZW1lLnVpMX1gIDogYGRhc2hlZCAke2FjdGl2ZSA/IHRoZW1lLnVpMCA6IHRoZW1lLnVpNH1gfTtcbiAgICAgIGN1cnNvcjogJHtkaXNhYmxlZCA/ICduby1kcm9wJyA6ICdwb2ludGVyJ307XG4gICAgICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICAgIGApKTtcbmNvbnN0IERyb3B6b25lTGFiZWwgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogZmxleDtcbiAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7XG4gIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47XG4gIGZsZXg6IDE7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuYDtcbmNvbnN0IFN0eWxlZExhYmVsID0gc3R5bGVkLnNwYW4gYFxuICBkaXNwbGF5OiB0YWJsZS1jZWxsO1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuICB0ZXh0LWFsaWduOiBjZW50ZXI7XG5gO1xuaW50ZXJmYWNlIFN0eWxlZEFjdGlvblByb3BzIHtcbiAgICBhY3RpdmU6IGJvb2xlYW47XG4gICAgZGlzYWJsZWQ/OiBib29sZWFuO1xufVxuY29uc3QgU3R5bGVkQWN0aW9uID0gc3R5bGVkLmRpdjxTdHlsZWRBY3Rpb25Qcm9wcz4gYFxuICBtYXJnaW4tdG9wOiAke2Rpc3RhbmNlLnNtYWxsfTtcbiAgdmlzaWJpbGl0eTogJHtwcm9wcyA9PiAocHJvcHMuYWN0aXZlIHx8IHByb3BzLmRpc2FibGVkID8gJ2hpZGRlbicgOiAndmlzaWJsZScpfTtcbmA7XG5jb25zdCBGaWxlSW5wdXQgPSBzdHlsZWQuaW5wdXQgYFxuICBkaXNwbGF5OiBub25lO1xuYDtcbmNvbnN0IFJlbW92ZSA9IHN0eWxlZC5kaXYgYFxuICBjdXJzb3I6IHBvaW50ZXI7XG4gIGxpbmUtaGVpZ2h0OiAxO1xuYDtcbmNsYXNzIERyb3B6b25lSW50IGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PERyb3B6b25lUHJvcHMgJiBGb3JtQ29udGV4dFByb3BzLCBEcm9wem9uZVN0YXRlPiB7XG4gICAgcHJpdmF0ZSBmaWxlSW5wdXQ6IEhUTUxJbnB1dEVsZW1lbnQgfCBudWxsO1xuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBEcm9wem9uZVByb3BzKSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgY29uc3QgdmFsdWUgPSBwcm9wcy52YWx1ZSB8fCBwcm9wcy5kZWZhdWx0VmFsdWUgfHwgW107XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBvdmVyOiBmYWxzZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZWQ6IHByb3BzLnZhbHVlICE9PSB1bmRlZmluZWQsXG4gICAgICAgICAgICB2YWx1ZSxcbiAgICAgICAgICAgIHByZXZpZXdzOiBbXSxcbiAgICAgICAgICAgIGVycm9yOiBwcm9wcy5lcnJvcixcbiAgICAgICAgfTtcbiAgICB9XG4gICAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgICAgIGNvbnN0IHsgZm9ybSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgeyBjb250cm9sbGVkIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBpZiAoIWNvbnRyb2xsZWQgJiYgZm9ybSkge1xuICAgICAgICAgICAgZm9ybS5zdWJzY3JpYmUodGhpcyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29tcG9uZW50V2lsbFVubW91bnQoKSB7XG4gICAgICAgIGNvbnN0IHsgZm9ybSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgY29uc3QgeyBjb250cm9sbGVkIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBpZiAoIWNvbnRyb2xsZWQgJiYgZm9ybSkge1xuICAgICAgICAgICAgZm9ybS51bnN1YnNjcmliZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhlOiBEcm9wem9uZVByb3BzKSB7XG4gICAgICAgIGNvbnN0IHsgY29udHJvbGxlZCwgdmFsdWUgfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGlmIChjb250cm9sbGVkICYmIGUudmFsdWUgJiYgdmFsdWUgIT09IGUudmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoKCkgPT4gKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogZS52YWx1ZSB8fCBbXSxcbiAgICAgICAgICAgICAgICBwcmV2aWV3czogW10sXG4gICAgICAgICAgICAgICAgZXJyb3I6IGUuZXJyb3IsXG4gICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJpdmF0ZSBhZGRGaWxlRW50cmllcyA9IChmaWxlczogQXJyYXk8RmlsZT4pID0+IHtcbiAgICAgICAgY29uc3QgeyBtdWx0aXBsZSwgZm9ybSwgbmFtZSA9ICcnIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuY29udHJvbGxlZCkge1xuICAgICAgICAgICAgaWYgKGZvcm0pIHtcbiAgICAgICAgICAgICAgICBmb3JtLmNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtdWx0aXBsZSA/IFsuLi50aGlzLnN0YXRlLnZhbHVlLCAuLi5maWxlc10gOiBmaWxlcyxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUocHJldlN0YXRlID0+ICh7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiBtdWx0aXBsZSA/IFsuLi5wcmV2U3RhdGUudmFsdWUsIC4uLmZpbGVzXSA6IGZpbGVzLFxuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3czogW10sXG4gICAgICAgICAgICAgICAgfSksICgpID0+IHRoaXMubm90aWZ5Q2hhbmdlcyh0aGlzLnN0YXRlLnZhbHVlKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICB0aGlzLm5vdGlmeUNoYW5nZXMobXVsdGlwbGUgPyBbLi4udGhpcy5zdGF0ZS52YWx1ZSwgLi4uZmlsZXNdIDogZmlsZXMpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBwcml2YXRlIG9uRHJhZ092ZXIgPSAoZTogUmVhY3QuRHJhZ0V2ZW50KSA9PiB7XG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICB9O1xuICAgIHByaXZhdGUgb25EcmFnRW50ZXIgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBvdmVyOiB0cnVlIH0pO1xuICAgIH07XG4gICAgcHJpdmF0ZSBvbkRyYWdMZWF2ZSA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IG92ZXI6IGZhbHNlIH0pO1xuICAgIH07XG4gICAgcHJpdmF0ZSBvbk9wZW5BY3Rpb24gPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgb25PcGVuIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBsZXQgb3BlbiA9IHRydWU7XG4gICAgICAgIGlmICh0eXBlb2Ygb25PcGVuID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBvbk9wZW4oe1xuICAgICAgICAgICAgICAgIHByZXZlbnREZWZhdWx0KCkge1xuICAgICAgICAgICAgICAgICAgICBvcGVuID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBvcGVuO1xuICAgIH07XG4gICAgcHJpdmF0ZSBvbkRyb3AgPSAoZXY6IFJlYWN0LkRyYWdFdmVudCkgPT4ge1xuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICB0aGlzLnNldFN0YXRlKHsgb3ZlcjogZmFsc2UgfSk7XG4gICAgICAgIGNvbnN0IGFjY2VwdEZpbGVzID0gdGhpcy5vbk9wZW5BY3Rpb24oKTtcbiAgICAgICAgaWYgKCF0aGlzLnByb3BzLmRpc2FibGVkICYmIGFjY2VwdEZpbGVzKSB7XG4gICAgICAgICAgICBjb25zdCBkcm9wcGVkRmlsZXMgPSBnZXRGaWxlcyhbXSwgZXYuZGF0YVRyYW5zZmVyLmZpbGVzKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVzID0gdGhpcy5wcm9wcy5tdWx0aXBsZSA/IGRyb3BwZWRGaWxlcyA6IFtkcm9wcGVkRmlsZXNbMF1dO1xuICAgICAgICAgICAgdGhpcy5hZGRGaWxlRW50cmllcyhmaWxlcyk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHByaXZhdGUgb25DbGljayA9IChldjogUmVhY3QuQ2hhbmdlRXZlbnQ8SFRNTElucHV0RWxlbWVudD4pID0+IHtcbiAgICAgICAgY29uc3QgZmlsZXMgPSBnZXRGaWxlcyhbXSwgZXYudGFyZ2V0LmZpbGVzKTtcbiAgICAgICAgaWYgKGZpbGVzKSB7XG4gICAgICAgICAgICB0aGlzLmFkZEZpbGVFbnRyaWVzKGZpbGVzKTtcbiAgICAgICAgfVxuICAgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG4gICAgcHJpdmF0ZSBzZXRJbnB1dFJlZiA9IChlbDogSFRNTElucHV0RWxlbWVudCkgPT4ge1xuICAgICAgICB0aGlzLmZpbGVJbnB1dCA9IGVsO1xuICAgIH07XG4gICAgcHJpdmF0ZSBvcGVuRmlsZVBpY2tlciA9ICgpID0+IHtcbiAgICAgICAgY29uc3Qgb3BlbiA9IHRoaXMub25PcGVuQWN0aW9uKCk7XG4gICAgICAgIGlmIChvcGVuICYmIHRoaXMuZmlsZUlucHV0KSB7XG4gICAgICAgICAgICB0aGlzLmZpbGVJbnB1dC5jbGljaygpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBwcml2YXRlIHJlbW92ZUZpbGVFbnRyeShmOiBGaWxlKSB7XG4gICAgICAgIGNvbnN0IHsgZm9ybSwgbmFtZSA9ICcnIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAoIXRoaXMuc3RhdGUuY29udHJvbGxlZCkge1xuICAgICAgICAgICAgaWYgKGZvcm0pIHtcbiAgICAgICAgICAgICAgICBmb3JtLmNoYW5nZSh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLnN0YXRlLnZhbHVlLmZpbHRlcihmaWxlID0+IGYgIT09IGZpbGUpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZShwcmV2U3RhdGUgPT4gKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHByZXZTdGF0ZS52YWx1ZS5maWx0ZXIoZmlsZSA9PiBmICE9PSBmaWxlKSxcbiAgICAgICAgICAgICAgICAgICAgcHJldmlld3M6IHByZXZTdGF0ZS5wcmV2aWV3cy5maWx0ZXIocHJldmlldyA9PiBwcmV2aWV3LmZpbGUgIT09IGYpLFxuICAgICAgICAgICAgICAgIH0pLCAoKSA9PiB0aGlzLm5vdGlmeUNoYW5nZXModGhpcy5zdGF0ZS52YWx1ZSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLnN0YXRlLnZhbHVlLmZpbHRlcihmaWxlID0+IGYgIT09IGZpbGUpO1xuICAgICAgICAgICAgdGhpcy5ub3RpZnlDaGFuZ2VzKGZpbGVzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIG5vdGlmeUNoYW5nZXMoZmlsZXM6IEFycmF5PEZpbGU+KSB7XG4gICAgICAgIGNvbnN0IHsgb25DaGFuZ2UgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGlmICh0eXBlb2Ygb25DaGFuZ2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICB2YWx1ZTogZmlsZXMsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIHJlbmRlckl0ZW0oZjogRmlsZSkge1xuICAgICAgICByZXR1cm4gKDxTdHlsZWRGaWxlSXRlbSBrZXk9e2YubmFtZX0gbmFtZT17Zi5uYW1lfT5cbiAgICAgICAgPFJlbW92ZSBvbkNsaWNrPXsoKSA9PiB0aGlzLnJlbW92ZUZpbGVFbnRyeShmKX0+XG4gICAgICAgICAgPEljb24gbmFtZT1cIlJlbW92ZUNpcmNsZVwiIHNpemU9ezF9Lz5cbiAgICAgICAgPC9SZW1vdmU+XG4gICAgICA8L1N0eWxlZEZpbGVJdGVtPik7XG4gICAgfVxuICAgIHByaXZhdGUgcmVuZGVyUHJldmlldyhmOiBGaWxlKSB7XG4gICAgICAgIGNvbnN0IHByZXZpZXcgPSB0aGlzLnN0YXRlLnByZXZpZXdzLmZpbHRlcihwcmV2aWV3ID0+IHByZXZpZXcuZmlsZSA9PT0gZilbMF07XG4gICAgICAgIGlmIChmLnNpemUgPiAxMDAwMDAwIHx8ICFmLnR5cGUubWF0Y2goL2ltYWdlLykpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlbmRlckl0ZW0oZik7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHByZXZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybiAoPFN0eWxlZEZpbGVJbWFnZVByZXZpZXcga2V5PXtmLm5hbWV9IHNyYz17cHJldmlldy5kYXRhfT5cbiAgICAgICAgICA8UmVtb3ZlIG9uQ2xpY2s9eygpID0+IHRoaXMucmVtb3ZlRmlsZUVudHJ5KGYpfT5cbiAgICAgICAgICAgIDxJY29uIG5hbWU9XCJSZW1vdmVDaXJjbGVcIiBzaXplPXsxfS8+XG4gICAgICAgICAgPC9SZW1vdmU+XG4gICAgICAgIDwvU3R5bGVkRmlsZUltYWdlUHJldmlldz4pO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSAoZmlsZSA9PiAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSByZWFkZXIucmVzdWx0O1xuICAgICAgICAgICAgdHlwZW9mIHJlc3VsdCA9PT0gJ3N0cmluZycgJiZcbiAgICAgICAgICAgICAgICB0aGlzLnNldFN0YXRlKHByZXZTdGF0ZSA9PiAoe1xuICAgICAgICAgICAgICAgICAgICBwcmV2aWV3czogW1xuICAgICAgICAgICAgICAgICAgICAgICAgLi4ucHJldlN0YXRlLnByZXZpZXdzLFxuICAgICAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogcmVzdWx0LFxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgXSxcbiAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH0pKGYpO1xuICAgICAgICByZWFkZXIucmVhZEFzRGF0YVVSTChmKTtcbiAgICAgICAgcmV0dXJuICg8U3R5bGVkRmlsZUltYWdlUHJldmlldyBrZXk9e2YubmFtZX0+XG4gICAgICAgIDxTcGlubmVyIHNpemU9XCJzbWFsbFwiLz5cbiAgICAgIDwvU3R5bGVkRmlsZUltYWdlUHJldmlldz4pO1xuICAgIH1cbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgdmFsdWUsIG92ZXIsIGVycm9yIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCB7IG1lc3NhZ2UgPSAnRHJvcCBmaWxlcyBoZXJlIHRvIHVwbG9hZCcsIG11bHRpcGxlLCBpbmZvLCBpY29uID0gJ0ZpbGVEb3dubG9hZCcsIHRoZW1lLCB2YWx1ZTogXzAsIGRlZmF1bHRWYWx1ZTogXzEsIGRpc2FibGVkLCBvbkNoYW5nZTogXzIsIHByZXZpZXc6IF8zLCBvbklucHV0OiBfNSwgY2hpbGRyZW4sIC4uLnByb3BzIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICByZXR1cm4gKDxkaXYgey4uLnByb3BzfT5cbiAgICAgICAgPFN0eWxlZERyb3B6b25lIGFjdGl2ZT17b3Zlcn0gZGlzYWJsZWQ9e2Rpc2FibGVkfSBvbkRyb3A9e3RoaXMub25Ecm9wfSBvbkRyYWdPdmVyPXt0aGlzLm9uRHJhZ092ZXJ9IG9uRHJhZ0xlYXZlPXt0aGlzLm9uRHJhZ0xlYXZlfSBvbkRyYWdFbnRlcj17dGhpcy5vbkRyYWdFbnRlcn0gb25DbGljaz17dGhpcy5vcGVuRmlsZVBpY2tlcn0+XG4gICAgICAgICAgPERyb3B6b25lTGFiZWw+XG4gICAgICAgICAgICA8SWNvbiBuYW1lPXtpY29ufSBzaXplPXsyfS8+XG4gICAgICAgICAgICA8U3R5bGVkTGFiZWw+XG4gICAgICAgICAgICAgIHttZXNzYWdlfVxuICAgICAgICAgICAgICA8RmlsZUlucHV0IGRpc2FibGVkPXtkaXNhYmxlZH0gcmVmPXt0aGlzLnNldElucHV0UmVmfSB0eXBlPVwiZmlsZVwiIG11bHRpcGxlPXttdWx0aXBsZX0gdmFsdWU9XCJcIiBvbkNoYW5nZT17dGhpcy5vbkNsaWNrfS8+XG4gICAgICAgICAgICAgIDxTdHlsZWRBY3Rpb24gYWN0aXZlPXtvdmVyfSBkaXNhYmxlZD17ZGlzYWJsZWR9PlxuICAgICAgICAgICAgICAgIDxJY29uTGluayBpY29uPVwiQWRkXCI+e2NoaWxkcmVufTwvSWNvbkxpbms+XG4gICAgICAgICAgICAgIDwvU3R5bGVkQWN0aW9uPlxuICAgICAgICAgICAgPC9TdHlsZWRMYWJlbD5cbiAgICAgICAgICA8L0Ryb3B6b25lTGFiZWw+XG4gICAgICAgIDwvU3R5bGVkRHJvcHpvbmU+XG4gICAgICAgIHt2YWx1ZSAmJiB2YWx1ZS5sZW5ndGggPiAwICYmICg8U3R5bGVkRmlsZUxpc3Q+XG4gICAgICAgICAgICB7dmFsdWUubWFwKGZpbGUgPT4gKHRoaXMucHJvcHMucHJldmlldyA/IHRoaXMucmVuZGVyUHJldmlldyhmaWxlKSA6IHRoaXMucmVuZGVySXRlbShmaWxlKSkpfVxuICAgICAgICAgIDwvU3R5bGVkRmlsZUxpc3Q+KX1cbiAgICAgICAge3Nob3dJbnB1dEluZm8oZXJyb3IsIGluZm8pfVxuICAgICAgPC9kaXY+KTtcbiAgICB9XG4gICAgc3RhdGljIGlubmVyID0ge1xuICAgICAgICBnZXQgU3R5bGVkRmlsZUl0ZW0oKSB7IHJldHVybiBTdHlsZWRGaWxlSXRlbSBhcyB0eXBlb2YgU3R5bGVkRmlsZUl0ZW07IH0sXG4gICAgICAgIGdldCBSZW1vdmUoKSB7IHJldHVybiBSZW1vdmUgYXMgdHlwZW9mIFJlbW92ZTsgfSxcbiAgICAgICAgZ2V0IEljb24oKSB7IHJldHVybiBJY29uIGFzIHR5cGVvZiBJY29uOyB9LFxuICAgICAgICBnZXQgU3R5bGVkRmlsZUltYWdlUHJldmlldygpIHsgcmV0dXJuIFN0eWxlZEZpbGVJbWFnZVByZXZpZXcgYXMgdHlwZW9mIFN0eWxlZEZpbGVJbWFnZVByZXZpZXc7IH0sXG4gICAgICAgIGdldCBTcGlubmVyKCkgeyByZXR1cm4gU3Bpbm5lciBhcyB0eXBlb2YgU3Bpbm5lcjsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZERyb3B6b25lKCkgeyByZXR1cm4gU3R5bGVkRHJvcHpvbmUgYXMgdHlwZW9mIFN0eWxlZERyb3B6b25lOyB9LFxuICAgICAgICBnZXQgRHJvcHpvbmVMYWJlbCgpIHsgcmV0dXJuIERyb3B6b25lTGFiZWwgYXMgdHlwZW9mIERyb3B6b25lTGFiZWw7IH0sXG4gICAgICAgIGdldCBTdHlsZWRMYWJlbCgpIHsgcmV0dXJuIFN0eWxlZExhYmVsIGFzIHR5cGVvZiBTdHlsZWRMYWJlbDsgfSxcbiAgICAgICAgZ2V0IEZpbGVJbnB1dCgpIHsgcmV0dXJuIEZpbGVJbnB1dCBhcyB0eXBlb2YgRmlsZUlucHV0OyB9LFxuICAgICAgICBnZXQgU3R5bGVkQWN0aW9uKCkgeyByZXR1cm4gU3R5bGVkQWN0aW9uIGFzIHR5cGVvZiBTdHlsZWRBY3Rpb247IH0sXG4gICAgICAgIGdldCBJY29uTGluaygpIHsgcmV0dXJuIEljb25MaW5rIGFzIHR5cGVvZiBJY29uTGluazsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZEZpbGVMaXN0KCkgeyByZXR1cm4gU3R5bGVkRmlsZUxpc3QgYXMgdHlwZW9mIFN0eWxlZEZpbGVMaXN0OyB9XG4gICAgfTtcbn1cbmV4cG9ydCBjb25zdCBEcm9wem9uZSA9IHdpdGhGb3JtQ29udGV4dChEcm9wem9uZUludCk7XG5Ecm9wem9uZS5kaXNwbGF5TmFtZSA9ICdEcm9wem9uZSc7XG4iXX0=
"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = require("react");
var styled_1 = require("../../utils/styled");
var Highlighted = styled_1.default.span(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n  background-color: ", ";\n"], ["\n  background-color: ", ";\n"])), styled_1.themed(function (props) { return props.theme.highlightColor; }));
/**
 * Validates that the matches provided are valid, if not it will throw an error
 *
 * @param matches
 */
function validateMatches(matches) {
    var lastMatch = -1;
    if (!Array.isArray(matches)) {
        throw Error("match must be an Array of [start, end], but provided " + JSON.stringify(matches));
    }
    matches.forEach(function (match) {
        if (!Array.isArray(match) || match.length !== 2) {
            throw Error('match must be an Array of [start, end]');
        }
        if (!Number.isInteger(match[0]) || !Number.isInteger(match[1]) || match[0] < 0 || match[1] < 0) {
            throw Error('match [start] and [end] must be a positive integers.');
        }
        if (match[0] >= match[1]) {
            throw Error('[start] must be lower than [end].');
        }
        if (match[0] <= lastMatch) {
            throw Error('match indices cannot overlap.');
        }
        lastMatch = match[1];
    });
}
/**
 * Highlight component is meant to be a simple component to display text with highlighted search.
 * Component will render a SPAN or series of SPAN with the content and highlights
 */
exports.Highlight = Object.assign((function (_a) {
    var text = _a.text, matches = _a.matches, highlight = _a.highlight, _b = _a.ignoreCase, ignoreCase = _b === void 0 ? true : _b, theme = _a.theme;
    if (!matches && undefined === highlight) {
        throw new Error('You must set either indices or highlight');
    }
    if (matches) {
        validateMatches(matches);
        var lastMatch_1 = 0;
        return (React.createElement(React.Fragment, null,
            matches.map(function (match, i) {
                var r = (React.createElement(React.Fragment, { key: i },
                    React.createElement("span", null, text.substring(lastMatch_1, match[0])),
                    React.createElement(Highlighted, { theme: theme }, text.substring(match[0], match[1]))));
                lastMatch_1 = match[1];
                return r;
            }),
            React.createElement("span", null, text.substring(lastMatch_1, text.length))));
    }
    if (highlight === '') {
        return React.createElement(React.Fragment, null, text);
    }
    // Sanitized the user input to prevent them from using RegEx patterns
    var sanitized = highlight && highlight.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    var parts = text.split(new RegExp("(" + sanitized + ")", ignoreCase ? 'gi' : 'g')).filter(Boolean);
    return (React.createElement(React.Fragment, null, parts.map(function (part, i) { return part.toLowerCase() === (highlight && highlight.toLowerCase()) ? (React.createElement(Highlighted, { theme: theme, key: i }, part)) : (React.createElement("span", { key: i }, part)); })));
}), { inner: {
        get Highlighted() { return Highlighted; }
    } });
exports.Highlight.displayName = 'Highlight';
var templateObject_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9IaWdobGlnaHQvaW5kZXgudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLDZCQUErQjtBQUMvQiw2Q0FBb0Q7QUFxQnBELElBQU0sV0FBVyxHQUFHLGdCQUFNLENBQUMsSUFBSSxrR0FBQyx3QkFDVixFQUEyQyxLQUNoRSxLQURxQixlQUFNLENBQUMsVUFBQSxLQUFLLElBQUksT0FBQSxLQUFLLENBQUMsS0FBSyxDQUFDLGNBQWMsRUFBMUIsQ0FBMEIsQ0FBQyxDQUNoRSxDQUFDO0FBQ0Y7Ozs7R0FJRztBQUNILFNBQVMsZUFBZSxDQUFDLE9BQTZCO0lBQ2xELElBQUksU0FBUyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ25CLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1FBQ3pCLE1BQU0sS0FBSyxDQUFDLDBEQUF3RCxJQUFJLENBQUMsU0FBUyxDQUFDLE9BQU8sQ0FBRyxDQUFDLENBQUM7S0FDbEc7SUFDRCxPQUFPLENBQUMsT0FBTyxDQUFDLFVBQUEsS0FBSztRQUNqQixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsSUFBSSxLQUFLLENBQUMsTUFBTSxLQUFLLENBQUMsRUFBRTtZQUM3QyxNQUFNLEtBQUssQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO1NBQ3pEO1FBQ0QsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxDQUFDLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsRUFBRTtZQUM1RixNQUFNLEtBQUssQ0FBQyxzREFBc0QsQ0FBQyxDQUFD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LENBQUMsQ0FBQztLQUNsRSxFQUFFLENBQUMsQ0FBQztBQUNULGlCQUFTLENBQUMsV0FBVyxHQUFHLFdBQVcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQsIHsgdGhlbWVkIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3R5bGVkJztcbmltcG9ydCB7IFN0YW5kYXJkUHJvcHMgfSBmcm9tICcuLi8uLi9jb21tb24nO1xuZXhwb3J0IGludGVyZmFjZSBIaWdobGlnaHRQcm9wcyBleHRlbmRzIFN0YW5kYXJkUHJvcHMge1xuICAgIC8qKlxuICAgICAqIFN0cmluZyB0aGF0IG5lZWRzIHRvIGJlIHJlbmRlcmVkXG4gICAgICovXG4gICAgdGV4dDogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIFN0cmluZyB0aGF0IG5lZWRzIHRvIGJlIGhpZ2hsaWdodGVkXG4gICAgICovXG4gICAgaGlnaGxpZ2h0Pzogc3RyaW5nO1xuICAgIC8qKlxuICAgICAqIEFycmF5IHRoYXQgZGVmaW5lcyB0aGUgaW5kaWNlcyB0byBoaWdobGlnaHQsIGVhY2ggZWxlbWVudCBpcyBhbiBhcnJheSBvZiBbc3RhcnQsIGVuZF1cbiAgICAgKiBJbiBjYXNlIHRoaXMgaXMgcHJvY2lkZWQgdGhlbiBoaWdobGlnaHQgd2lsbCBiZSBpZ25vcmVkLlxuICAgICAqL1xuICAgIG1hdGNoZXM/OiBBcnJheTxBcnJheTxudW1iZXI+PjtcbiAgICAvKipcbiAgICAgKiBEZWZpbmVzIGlmIHRoZSBzZWFyY2ggd2lsbCBiZSBjYXNlIGluc2Vuc2l0aXZlXG4gICAgICovXG4gICAgaWdub3JlQ2FzZT86IGJvb2xlYW47XG59XG5jb25zdCBIaWdobGlnaHRlZCA9IHN0eWxlZC5zcGFuIGBcbiAgYmFja2dyb3VuZC1jb2xvcjogJHt0aGVtZWQocHJvcHMgPT4gcHJvcHMudGhlbWUuaGlnaGxpZ2h0Q29sb3IpfTtcbmA7XG4vKipcbiAqIFZhbGlkYXRlcyB0aGF0IHRoZSBtYXRjaGVzIHByb3ZpZGVkIGFyZSB2YWxpZCwgaWYgbm90IGl0IHdpbGwgdGhyb3cgYW4gZXJyb3JcbiAqXG4gKiBAcGFyYW0gbWF0Y2hlc1xuICovXG5mdW5jdGlvbiB2YWxpZGF0ZU1hdGNoZXMobWF0Y2hlczogQXJyYXk8QXJyYXk8bnVtYmVyPj4pIHtcbiAgICBsZXQgbGFzdE1hdGNoID0gLTE7XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KG1hdGNoZXMpKSB7XG4gICAgICAgIHRocm93IEVycm9yKGBtYXRjaCBtdXN0IGJlIGFuIEFycmF5IG9mIFtzdGFydCwgZW5kXSwgYnV0IHByb3ZpZGVkICR7SlNPTi5zdHJpbmdpZnkobWF0Y2hlcyl9YCk7XG4gICAgfVxuICAgIG1hdGNoZXMuZm9yRWFjaChtYXRjaCA9PiB7XG4gICAgICAgIGlmICghQXJyYXkuaXNBcnJheShtYXRjaCkgfHwgbWF0Y2gubGVuZ3RoICE9PSAyKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignbWF0Y2ggbXVzdCBiZSBhbiBBcnJheSBvZiBbc3RhcnQsIGVuZF0nKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIU51bWJlci5pc0ludGVnZXIobWF0Y2hbMF0pIHx8ICFOdW1iZXIuaXNJbnRlZ2VyKG1hdGNoWzFdKSB8fCBtYXRjaFswXSA8IDAgfHwgbWF0Y2hbMV0gPCAwKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignbWF0Y2ggW3N0YXJ0XSBhbmQgW2VuZF0gbXVzdCBiZSBhIHBvc2l0aXZlIGludGVnZXJzLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaFswXSA+PSBtYXRjaFsxXSkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ1tzdGFydF0gbXVzdCBiZSBsb3dlciB0aGFuIFtlbmRdLicpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChtYXRjaFswXSA8PSBsYXN0TWF0Y2gpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdtYXRjaCBpbmRpY2VzIGNhbm5vdCBvdmVybGFwLicpO1xuICAgICAgICB9XG4gICAgICAgIGxhc3RNYXRjaCA9IG1hdGNoWzFdO1xuICAgIH0pO1xufVxuLyoqXG4gKiBIaWdobGlnaHQgY29tcG9uZW50IGlzIG1lYW50IHRvIGJlIGEgc2ltcGxlIGNvbXBvbmVudCB0byBkaXNwbGF5IHRleHQgd2l0aCBoaWdobGlnaHRlZCBzZWFyY2guXG4gKiBDb21wb25lbnQgd2lsbCByZW5kZXIgYSBTUEFOIG9yIHNlcmllcyBvZiBTUEFOIHdpdGggdGhlIGNvbnRlbnQgYW5kIGhpZ2hsaWdodHNcbiAqL1xuZXhwb3J0IGNvbnN0IEhpZ2hsaWdodCA9IE9iamVjdC5hc3NpZ24oKCgoeyB0ZXh0LCBtYXRjaGVzLCBoaWdobGlnaHQsIGlnbm9yZUNhc2UgPSB0cnVlLCB0aGVtZSB9KSA9PiB7XG4gICAgaWYgKCFtYXRjaGVzICYmIHVuZGVmaW5lZCA9PT0gaGlnaGxpZ2h0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignWW91IG11c3Qgc2V0IGVpdGhlciBpbmRpY2VzIG9yIGhpZ2hsaWdodCcpO1xuICAgIH1cbiAgICBpZiAobWF0Y2hlcykge1xuICAgICAgICB2YWxpZGF0ZU1hdGNoZXMobWF0Y2hlcyk7XG4gICAgICAgIGxldCBsYXN0TWF0Y2ggPSAwO1xuICAgICAgICByZXR1cm4gKDw+XG4gICAgICAgIHttYXRjaGVzLm1hcCgobWF0Y2gsIGkpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHIgPSAoPFJlYWN0LkZyYWdtZW50IGtleT17aX0+XG4gICAgICAgICAgICAgIDxzcGFuPnt0ZXh0LnN1YnN0cmluZyhsYXN0TWF0Y2gsIG1hdGNoWzBdKX08L3NwYW4+XG4gICAgICAgICAgICAgIDxIaWdobGlnaHRlZCB0aGVtZT17dGhlbWV9Pnt0ZXh0LnN1YnN0cmluZyhtYXRjaFswXSwgbWF0Y2hbMV0pfTwvSGlnaGxpZ2h0ZWQ+XG4gICAgICAgICAgICA8L1JlYWN0LkZyYWdtZW50Pik7XG4gICAgICAgICAgICBsYXN0TWF0Y2ggPSBtYXRjaFsxXTtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICB9KX1cbiAgICAgICAgPHNwYW4+e3RleHQuc3Vic3RyaW5nKGxhc3RNYXRjaCwgdGV4dC5sZW5ndGgpfTwvc3Bhbj5cbiAgICAgIDwvPik7XG4gICAgfVxuICAgIGlmIChoaWdobGlnaHQgPT09ICcnKSB7XG4gICAgICAgIHJldHVybiA8Pnt0ZXh0fTwvPjtcbiAgICB9XG4gICAgLy8gU2FuaXRpemVkIHRoZSB1c2VyIGlucHV0IHRvIHByZXZlbnQgdGhlbSBmcm9tIHVzaW5nIFJlZ0V4IHBhdHRlcm5zXG4gICAgY29uc3Qgc2FuaXRpemVkID0gaGlnaGxpZ2h0ICYmIGhpZ2hsaWdodC5yZXBsYWNlKC9bLiorP14ke30oKXxbXFxdXFxcXF0vZywgJ1xcXFwkJicpO1xuICAgIGNvbnN0IHBhcnRzID0gdGV4dC5zcGxpdChuZXcgUmVnRXhwKGAoJHtzYW5pdGl6ZWR9KWAsIGlnbm9yZUNhc2UgPyAnZ2knIDogJ2cnKSkuZmlsdGVyKEJvb2xlYW4pO1xuICAgIHJldHVybiAoPD5cbiAgICAgIHtwYXJ0cy5tYXAoKHBhcnQsIGkpID0+IHBhcnQudG9Mb3dlckNhc2UoKSA9PT0gKGhpZ2hsaWdodCAmJiBoaWdobGlnaHQudG9Mb3dlckNhc2UoKSkgPyAoPEhpZ2hsaWdodGVkIHRoZW1lPXt0aGVtZX0ga2V5PXtpfT5cbiAgICAgICAgICAgIHtwYXJ0fVxuICAgICAgICAgIDwvSGlnaGxpZ2h0ZWQ+KSA6ICg8c3BhbiBrZXk9e2l9PntwYXJ0fTwvc3Bhbj4pKX1cbiAgICA8Lz4pO1xufSkgYXMgUmVhY3QuRkM8SGlnaGxpZ2h0UHJvcHM+KSwgeyBpbm5lcjoge1xuICAgICAgICBnZXQgSGlnaGxpZ2h0ZWQoKSB7IHJldHVybiBIaWdobGlnaHRlZCBhcyB0eXBlb2YgSGlnaGxpZ2h0ZWQ7IH1cbiAgICB9IH0pO1xuSGlnaGxpZ2h0LmRpc3BsYXlOYW1lID0gJ0hpZ2hsaWdodCc7XG4iXX0=
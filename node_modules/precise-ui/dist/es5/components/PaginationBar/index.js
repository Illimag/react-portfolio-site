"use strict";
var __makeTemplateObject = (this && this.__makeTemplateObject) || function (cooked, raw) {
    if (Object.defineProperty) { Object.defineProperty(cooked, "raw", { value: raw }); } else { cooked.raw = raw; }
    return cooked;
};
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
var React = require("react");
var styled_1 = require("../../utils/styled");
var labels_1 = require("../../utils/labels");
var ItemControlsView_part_1 = require("./ItemControlsView.part");
var PageControls_part_1 = require("./PageControls.part");
labels_1.setLabels({
    itemsPerPageLabel: 'Items per page:',
});
function defaultItemsInfo(start, end, total) {
    return start + " - " + end + " of " + total;
}
function defaultPagesInfo(start, end) {
    return start + " of " + end + " pages";
}
function getPages(itemsPerPage, total) {
    var l = Math.ceil(total / itemsPerPage);
    var pages = [];
    for (var i = 1; i <= l; i++) {
        pages.push(i.toString());
    }
    return pages;
}
var ControlsContainer = styled_1.default.div(templateObject_1 || (templateObject_1 = __makeTemplateObject(["\n  display: flex;\n  justify-content: space-between;\n  margin-left: auto;\n  align-items: center;\n  height: 40px;\n"], ["\n  display: flex;\n  justify-content: space-between;\n  margin-left: auto;\n  align-items: center;\n  height: 40px;\n"])));
var PaginationBar = /** @class */ (function (_super) {
    __extends(PaginationBar, _super);
    function PaginationBar() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.sizeChanged = function (e) {
            var _a = _this.props, onSizeChanged = _a.onSizeChanged, availableSizes = _a.availableSizes;
            if (Array.isArray(availableSizes) && typeof onSizeChanged === 'function') {
                onSizeChanged({
                    size: availableSizes[e.index],
                });
            }
        };
        _this.changeToPrevious = function () {
            var selectedPage = _this.props.selectedPage;
            _this.changeTo(selectedPage - 1);
        };
        _this.changeToNext = function () {
            var selectedPage = _this.props.selectedPage;
            _this.changeTo(selectedPage + 1);
        };
        _this.changeToSelect = function (_a) {
            var index = _a.index;
            _this.changeTo(index);
        };
        return _this;
    }
    PaginationBar.prototype.changeTo = function (page) {
        var onPageChanged = this.props.onPageChanged;
        if (page < 0) {
            page = 0;
        }
        if (typeof onPageChanged === 'function') {
            onPageChanged({
                page: page,
            });
        }
    };
    PaginationBar.prototype.render = function () {
        var _a = this.props, availableSizes = _a.availableSizes, size = _a.size, selectedPage = _a.selectedPage, _b = _a.pagesInfo, pagesInfo = _b === void 0 ? defaultPagesInfo : _b, _c = _a.itemsInfo, itemsInfo = _c === void 0 ? defaultItemsInfo : _c, items = _a.items, onSizeChanged = _a.onSizeChanged, onPageChanged = _a.onPageChanged, props = __rest(_a, ["availableSizes", "size", "selectedPage", "pagesInfo", "itemsInfo", "items", "onSizeChanged", "onPageChanged"]);
        var pages = getPages(size, items);
        var currentItem = selectedPage * size;
        var nextItem = currentItem + size;
        return (React.createElement(ControlsContainer, null,
            Array.isArray(availableSizes) && availableSizes.length > 0 && (React.createElement(ItemControlsView_part_1.ItemControls, { label: labels_1.getPropLabel(props, 'itemsPerPageLabel'), data: availableSizes.map(function (size) { return size.toString(); }), value: "" + size, onChange: this.sizeChanged }, itemsInfo(currentItem, Math.min(nextItem, items), items))),
            React.createElement(PageControls_part_1.PageControls, { current: selectedPage, total: pages.length, changeToPrevious: this.changeToPrevious, changeToNext: this.changeToNext, changeToSelect: this.changeToSelect, pages: pages }, pagesInfo(selectedPage + 1, Math.max(pages.length, 1)))));
    };
    PaginationBar.inner = {
        get ControlsContainer() { return ControlsContainer; },
        get ItemControls() { return ItemControlsView_part_1.ItemControls; },
        get PageControls() { return PageControls_part_1.PageControls; }
    };
    return PaginationBar;
}(React.Component));
exports.PaginationBar = PaginationBar;
var templateObject_1;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9QYWdpbmF0aW9uQmFyL2luZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsNkJBQStCO0FBQy9CLDZDQUF3QztBQUN4Qyw2Q0FBa0Y7QUFDbEYsaUVBQXVEO0FBQ3ZELHlEQUFtRDtBQUVuRCxrQkFBUyxDQUFDO0lBQ04saUJBQWlCLEVBQUUsaUJBQWlCO0NBQ3ZDLENBQUMsQ0FBQztBQUNILFNBQVMsZ0JBQWdCLENBQUMsS0FBYSxFQUFFLEdBQVcsRUFBRSxLQUFhO0lBQy9ELE9BQVUsS0FBSyxXQUFNLEdBQUcsWUFBTyxLQUFPLENBQUM7QUFDM0MsQ0FBQztBQUNELFNBQVMsZ0JBQWdCLENBQUMsS0FBYSxFQUFFLEdBQVc7SUFDaEQsT0FBVSxLQUFLLFlBQU8sR0FBRyxXQUFRLENBQUM7QUFDdEMsQ0FBQztBQUNELFNBQVMsUUFBUSxDQUFDLFlBQW9CLEVBQUUsS0FBYTtJQUNqRCxJQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssR0FBRyxZQUFZLENBQUMsQ0FBQztJQUMxQyxJQUFNLEtBQUssR0FBa0IsRUFBRSxDQUFDO0lBQ2hDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEVBQUU7UUFDekIsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBUSxFQUFFLENBQUMsQ0FBQztLQUM1QjtJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2pCLENBQUM7QUFDRCxJQUFNLGlCQUFpQixHQUFHLGdCQUFNLENBQUMsR0FBRywyTEFBQyx3SEFNcEMsSUFBQSxDQUFDO0FBMkNGO0lBQW1DLGlDQUFtQztJQUF0RTtRQUFBLHFFQWtEQztRQWpEVyxpQkFBVyxHQUFHLFVBQUMsQ0FBMEI7WUFDdkMsSUFB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QUFDLENBQUMsQ0FBQztRQUNqRixJQUFJLFlBQVksS0FBSyxPQUFPLG9DQUFtQyxDQUFDLENBQUMsQ0FBQztRQUNsRSxJQUFJLFlBQVksS0FBSyxPQUFPLGdDQUFtQyxDQUFDLENBQUMsQ0FBQztLQUNyRSxDQUFDO0lBQ04sb0JBQUM7Q0FBQSxBQWxERCxDQUFtQyxLQUFLLENBQUMsU0FBUyxHQWtEakQ7QUFsRFksc0NBQWEiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkIGZyb20gJy4uLy4uL3V0aWxzL3N0eWxlZCc7XG5pbXBvcnQgeyBzZXRMYWJlbHMsIGdldFByb3BMYWJlbCwgUGFnaW5hdGlvbkJhckxhYmVscyB9IGZyb20gJy4uLy4uL3V0aWxzL2xhYmVscyc7XG5pbXBvcnQgeyBJdGVtQ29udHJvbHMgfSBmcm9tICcuL0l0ZW1Db250cm9sc1ZpZXcucGFydCc7XG5pbXBvcnQgeyBQYWdlQ29udHJvbHMgfSBmcm9tICcuL1BhZ2VDb250cm9scy5wYXJ0JztcbmltcG9ydCB7IFNlbGVjdEJ1dHRvbkNoYW5nZUV2ZW50IH0gZnJvbSAnLi4vU2VsZWN0QnV0dG9uJztcbnNldExhYmVscyh7XG4gICAgaXRlbXNQZXJQYWdlTGFiZWw6ICdJdGVtcyBwZXIgcGFnZTonLFxufSk7XG5mdW5jdGlvbiBkZWZhdWx0SXRlbXNJbmZvKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyLCB0b3RhbDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIGAke3N0YXJ0fSAtICR7ZW5kfSBvZiAke3RvdGFsfWA7XG59XG5mdW5jdGlvbiBkZWZhdWx0UGFnZXNJbmZvKHN0YXJ0OiBudW1iZXIsIGVuZDogbnVtYmVyKSB7XG4gICAgcmV0dXJuIGAke3N0YXJ0fSBvZiAke2VuZH0gcGFnZXNgO1xufVxuZnVuY3Rpb24gZ2V0UGFnZXMoaXRlbXNQZXJQYWdlOiBudW1iZXIsIHRvdGFsOiBudW1iZXIpIHtcbiAgICBjb25zdCBsID0gTWF0aC5jZWlsKHRvdGFsIC8gaXRlbXNQZXJQYWdlKTtcbiAgICBjb25zdCBwYWdlczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgIGZvciAobGV0IGkgPSAxOyBpIDw9IGw7IGkrKykge1xuICAgICAgICBwYWdlcy5wdXNoKGkudG9TdHJpbmcoKSk7XG4gICAgfVxuICAgIHJldHVybiBwYWdlcztcbn1cbmNvbnN0IENvbnRyb2xzQ29udGFpbmVyID0gc3R5bGVkLmRpdiBgXG4gIGRpc3BsYXk6IGZsZXg7XG4gIGp1c3RpZnktY29udGVudDogc3BhY2UtYmV0d2VlbjtcbiAgbWFyZ2luLWxlZnQ6IGF1dG87XG4gIGFsaWduLWl0ZW1zOiBjZW50ZXI7XG4gIGhlaWdodDogNDBweDtcbmA7XG5leHBvcnQgaW50ZXJmYWNlIFBhZ2luYXRpb25CYXJTaXplQ2hhbmdlZEV2ZW50IHtcbiAgICBzaXplOiBudW1iZXI7XG59XG5leHBvcnQgaW50ZXJmYWNlIFBhZ2luYXRpb25CYXJQYWdlQ2hhbmdlZEV2ZW50IHtcbiAgICBwYWdlOiBudW1iZXI7XG59XG5leHBvcnQgaW50ZXJmYWNlIFBhZ2luYXRpb25CYXJQcm9wcyBleHRlbmRzIFBhZ2luYXRpb25CYXJMYWJlbHMge1xuICAgIC8qKlxuICAgICAqIFRoZSBhdmFpbGFibGUgbWF4aW11bSBudW1iZXJzIG9mIGVudHJpZXMgcGVyIHBhZ2UgdG8gY2hvb3NlIGZyb20sIGlmIGFueS5cbiAgICAgKi9cbiAgICBhdmFpbGFibGVTaXplcz86IEFycmF5PG51bWJlcj47XG4gICAgLyoqXG4gICAgICogVGhlIGN1cnJlbnRseSBhY3RpdmUgcGFnZS5cbiAgICAgKi9cbiAgICBzZWxlY3RlZFBhZ2U6IG51bWJlcjtcbiAgICAvKipcbiAgICAgKiBUaGUgbWF4aW11bSBudW1iZXIgb2YgZW50cmllcyBwZXIgcGFnZS5cbiAgICAgKi9cbiAgICBzaXplOiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogVGhlIHRvdGFsIG51bWJlciBvZiBlbnRyaWVzLlxuICAgICAqL1xuICAgIGl0ZW1zOiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogUGFnZXMgaW5mbyBsYWJlbCBnZW5lcmF0b3IuXG4gICAgICogQGRlZmF1bHQgJ3tzdGFydH0gb2Yge2VuZH0gcGFnZXMnXG4gICAgICovXG4gICAgcGFnZXNJbmZvPyhzdGFydDogbnVtYmVyLCBlbmQ6IG51bWJlcik6IFJlYWN0LlJlYWN0Q2hpbGQ7XG4gICAgLyoqXG4gICAgICogSXRlbXMgaW5mbyBsYWJlbCBnZW5lcmF0b3IuXG4gICAgICogQGRlZmF1bHQgJ3tzdGFydH0gLSB7ZW5kfSBvZiB7dG90YWx9J1xuICAgICAqL1xuICAgIGl0ZW1zSW5mbz8oc3RhcnQ6IG51bWJlciwgZW5kOiBudW1iZXIsIHRvdGFsOiBudW1iZXIpOiBSZWFjdC5SZWFjdENoaWxkO1xuICAgIC8qKlxuICAgICAqIEV2ZW50IGZpcmVkIHdoZW4gdGhlIHNpemUgcGVyIHBhZ2UgaGFzIGJlZW4gY2hhbmdlZC5cbiAgICAgKi9cbiAgICBvblNpemVDaGFuZ2VkPyhlOiBQYWdpbmF0aW9uQmFyU2l6ZUNoYW5nZWRFdmVudCk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogRXZlbnQgZmlyZWQgd2hlbiB0aGUgc2VsZWN0ZWQgcGFnZSBoYXMgYmVlbiBjaGFuZ2VkLlxuICAgICAqL1xuICAgIG9uUGFnZUNoYW5nZWQ/KGU6IFBhZ2luYXRpb25CYXJQYWdlQ2hhbmdlZEV2ZW50KTogdm9pZDtcbn1cbmV4cG9ydCBjbGFzcyBQYWdpbmF0aW9uQmFyIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFBhZ2luYXRpb25CYXJQcm9wcz4ge1xuICAgIHByaXZhdGUgc2l6ZUNoYW5nZWQgPSAoZTogU2VsZWN0QnV0dG9uQ2hhbmdlRXZlbnQpID0+IHtcbiAgICAgICAgY29uc3QgeyBvblNpemVDaGFuZ2VkLCBhdmFpbGFibGVTaXplcyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoYXZhaWxhYmxlU2l6ZXMpICYmIHR5cGVvZiBvblNpemVDaGFuZ2VkID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBvblNpemVDaGFuZ2VkKHtcbiAgICAgICAgICAgICAgICBzaXplOiBhdmFpbGFibGVTaXplc1tlLmluZGV4XSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBwcml2YXRlIGNoYW5nZVRvUHJldmlvdXMgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0ZWRQYWdlIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICB0aGlzLmNoYW5nZVRvKHNlbGVjdGVkUGFnZSAtIDEpO1xuICAgIH07XG4gICAgcHJpdmF0ZSBjaGFuZ2VUb05leHQgPSAoKSA9PiB7XG4gICAgICAgIGNvbnN0IHsgc2VsZWN0ZWRQYWdlIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICB0aGlzLmNoYW5nZVRvKHNlbGVjdGVkUGFnZSArIDEpO1xuICAgIH07XG4gICAgcHJpdmF0ZSBjaGFuZ2VUb1NlbGVjdCA9ICh7IGluZGV4IH06IFNlbGVjdEJ1dHRvbkNoYW5nZUV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMuY2hhbmdlVG8oaW5kZXgpO1xuICAgIH07XG4gICAgcHJpdmF0ZSBjaGFuZ2VUbyhwYWdlOiBudW1iZXIpIHtcbiAgICAgICAgY29uc3QgeyBvblBhZ2VDaGFuZ2VkIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAocGFnZSA8IDApIHtcbiAgICAgICAgICAgIHBhZ2UgPSAwO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0eXBlb2Ygb25QYWdlQ2hhbmdlZCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgb25QYWdlQ2hhbmdlZCh7XG4gICAgICAgICAgICAgICAgcGFnZSxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBhdmFpbGFibGVTaXplcywgc2l6ZSwgc2VsZWN0ZWRQYWdlLCBwYWdlc0luZm8gPSBkZWZhdWx0UGFnZXNJbmZvLCBpdGVtc0luZm8gPSBkZWZhdWx0SXRlbXNJbmZvLCBpdGVtcywgb25TaXplQ2hhbmdlZCwgb25QYWdlQ2hhbmdlZCwgLi4ucHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IHBhZ2VzID0gZ2V0UGFnZXMoc2l6ZSwgaXRlbXMpO1xuICAgICAgICBjb25zdCBjdXJyZW50SXRlbSA9IHNlbGVjdGVkUGFnZSAqIHNpemU7XG4gICAgICAgIGNvbnN0IG5leHRJdGVtID0gY3VycmVudEl0ZW0gKyBzaXplO1xuICAgICAgICByZXR1cm4gKDxDb250cm9sc0NvbnRhaW5lcj5cbiAgICAgICAge0FycmF5LmlzQXJyYXkoYXZhaWxhYmxlU2l6ZXMpICYmIGF2YWlsYWJsZVNpemVzLmxlbmd0aCA+IDAgJiYgKDxJdGVtQ29udHJvbHMgbGFiZWw9e2dldFByb3BMYWJlbChwcm9wcywgJ2l0ZW1zUGVyUGFnZUxhYmVsJyl9IGRhdGE9e2F2YWlsYWJsZVNpemVzLm1hcChzaXplID0+IHNpemUudG9TdHJpbmcoKSl9IHZhbHVlPXtgJHtzaXplfWB9IG9uQ2hhbmdlPXt0aGlzLnNpemVDaGFuZ2VkfT5cbiAgICAgICAgICAgIHtpdGVtc0luZm8oY3VycmVudEl0ZW0sIE1hdGgubWluKG5leHRJdGVtLCBpdGVtcyksIGl0ZW1zKX1cbiAgICAgICAgICA8L0l0ZW1Db250cm9scz4pfVxuICAgICAgICA8UGFnZUNvbnRyb2xzIGN1cnJlbnQ9e3NlbGVjdGVkUGFnZX0gdG90YWw9e3BhZ2VzLmxlbmd0aH0gY2hhbmdlVG9QcmV2aW91cz17dGhpcy5jaGFuZ2VUb1ByZXZpb3VzfSBjaGFuZ2VUb05leHQ9e3RoaXMuY2hhbmdlVG9OZXh0fSBjaGFuZ2VUb1NlbGVjdD17dGhpcy5jaGFuZ2VUb1NlbGVjdH0gcGFnZXM9e3BhZ2VzfT5cbiAgICAgICAgICB7cGFnZXNJbmZvKHNlbGVjdGVkUGFnZSArIDEsIE1hdGgubWF4KHBhZ2VzLmxlbmd0aCwgMSkpfVxuICAgICAgICA8L1BhZ2VDb250cm9scz5cbiAgICAgIDwvQ29udHJvbHNDb250YWluZXI+KTtcbiAgICB9XG4gICAgc3RhdGljIGlubmVyID0ge1xuICAgICAgICBnZXQgQ29udHJvbHNDb250YWluZXIoKSB7IHJldHVybiBDb250cm9sc0NvbnRhaW5lciBhcyB0eXBlb2YgQ29udHJvbHNDb250YWluZXI7IH0sXG4gICAgICAgIGdldCBJdGVtQ29udHJvbHMoKSB7IHJldHVybiBJdGVtQ29udHJvbHMgYXMgdHlwZW9mIEl0ZW1Db250cm9sczsgfSxcbiAgICAgICAgZ2V0IFBhZ2VDb250cm9scygpIHsgcmV0dXJuIFBhZ2VDb250cm9scyBhcyB0eXBlb2YgUGFnZUNvbnRyb2xzOyB9XG4gICAgfTtcbn1cbiJdfQ==
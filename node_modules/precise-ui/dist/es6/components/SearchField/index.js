var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
import * as React from 'react';
import { Autocomplete } from '../Autocomplete';
import { debounce } from '../../utils/debounce';
import { Icon } from '../Icon';
import { light } from '../../themes';
import { Button } from '../Button';
import styled from '../../utils/styled';
const SearchContainer = styled.div `
  display: flex;
  flex-direction: row;
`;
const SearchButton = styled(Button) `
  height: 54px;
  width: 54px;
  margin: 0;
`;
const defaultDebounceDelay = 200;
/**
 * A search field for user search queries.
 */
export class SearchField extends React.Component {
    constructor(props) {
        super(props);
        this.handleKeyDown = (e) => {
            e.keyCode === 13 /* enter */ && this.fireSearch(this.state.query);
        };
        this.onSearchClick = () => {
            const { onSearch } = this.props;
            typeof onSearch === 'function' && onSearch({ query: this.state.query });
        };
        this.onClear = () => {
            const { onClear, triggerMode = 'auto' } = this.props;
            typeof onClear === 'function' && onClear();
            // In case, triggerMode is set to manual, clicking on clear should also trigger the search.
            triggerMode === 'manual' && this.fireSearch('');
        };
        this.onSuggestionSelected = (e) => {
            const { onSuggestionSelected, triggerMode = 'auto' } = this.props;
            typeof onSuggestionSelected === 'function' && onSuggestionSelected(e);
            // In case, triggerMode is set to manual, selecting a suggestion should also trigger the search.
            triggerMode === 'manual' && this.fireSearch(String(e.value));
        };
        this.change = (e) => {
            const { onChange, triggerMode = 'auto' } = this.props;
            this.setState({ query: e.value });
            typeof onChange === 'function' && onChange(e);
            triggerMode === 'auto' && this.fireSearch(e.value);
        };
        const { delay = defaultDebounceDelay } = props;
        this.state = { query: '' };
        this.fireSearch = debounce((query) => {
            const { onSearch } = this.props;
            typeof onSearch === 'function' && onSearch({ query });
        }, delay);
    }
    render() {
        const _a = this.props, { onSearch, delay, icon = 'Search', triggerMode = 'auto' } = _a, rest = __rest(_a, ["onSearch", "delay", "icon", "triggerMode"]);
        const autoTrigger = triggerMode === 'auto';
        const fieldIconColor = (rest.theme && rest.theme.text2) || light.text2;
        const buttonIconColor = (rest.theme && rest.theme.text4) || light.text4;
        const searchFieldIcon = React.createElement(Icon, { name: icon, color: fieldIconColor, size: "22px" });
        const searchButtonIcon = React.createElement(Icon, { name: icon, color: buttonIconColor, size: "22px" });
        return (React.createElement(SearchContainer, { onKeyDown: this.handleKeyDown },
            React.createElement(Autocomplete, Object.assign({}, rest, { onClear: this.onClear, onChange: this.change, onSuggestionSelected: this.onSuggestionSelected, icon: autoTrigger ? searchFieldIcon : React.createElement(React.Fragment, null) })),
            !autoTrigger && (React.createElement(SearchButton, { disabled: rest.disabled, onClick: this.onSearchClick }, searchButtonIcon))));
    }
}
SearchField.inner = {
    get Icon() { return Icon; },
    get SearchContainer() { return SearchContainer; },
    get Autocomplete() { return Autocomplete; },
    get SearchButton() { return SearchButton; }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9TZWFyY2hGaWVsZC9pbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFDL0IsT0FBTyxFQUFFLFlBQVksRUFBNkMsTUFBTSxpQkFBaUIsQ0FBQztBQUUxRixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDaEQsT0FBTyxFQUFFLElBQUksRUFBWSxNQUFNLFNBQVMsQ0FBQztBQUN6QyxPQUFPLEVBQUUsS0FBSyxFQUFFLE1BQU0sY0FBYyxDQUFDO0FBQ3JDLE9BQU8sRUFBRSxNQUFNLEVBQUUsTUFBTSxXQUFXLENBQUM7QUFDbkMsT0FBTyxNQUFNLE1BQU0sb0JBQW9CLENBQUM7QUFFeEMsTUFBTSxlQUFlLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQzs7O0NBR2xDLENBQUM7QUFDRixNQUFNLFlBQVksR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7Ozs7Q0FJbkMsQ0FBQztBQW9DRixNQUFNLG9CQUFvQixHQUFHLEdBQUcsQ0FBQztBQUVqQzs7R0FFRztBQUNILE1BQU0sT0FBTyxXQUFlLFNBQVEsS0FBSyxDQUFDLFNBQWdEO0lBRXRGLFlBQVksS0FBMEI7UUFDbEMsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBUVQsa0JBQWEsR0FBRyxDQUFDLENBQW1DLEVBQUUsRUFBRTtZQUM1RCxDQUFDLENBQUMsT0FBTyxtQkFBbUIsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDdEUsQ0FBQyxDQUFDO1FBQ00sa0JBQWEsR0FBRyxHQUFHLEVBQUU7WUFDekIsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDaEMsT0FBTyxRQUFR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SUFBSSxFQUFDLE1BQU0sR0FBRSxDQUFDO1FBQ2pGLE9BQU8sQ0FBQyxvQkFBQyxlQUFlLElBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxhQUFhO1lBQ3RELG9CQUFDLFlBQVksb0JBQUssSUFBSSxJQUFFLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTyxFQUFFLFFBQVEsRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLG9CQUFvQixFQUFFLElBQUksQ0FBQyxvQkFBb0IsRUFBRSxJQUFJLEVBQUUsV0FBVyxDQUFDLENBQUMsQ0FBQyxlQUFlLENBQUMsQ0FBQyxDQUFDLHlDQUFLLElBQUc7WUFDcEssQ0FBQyxXQUFXLElBQUksQ0FBQyxvQkFBQyxZQUFZLElBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxRQUFRLEVBQUUsT0FBTyxFQUFFLElBQUksQ0FBQyxhQUFhLElBQy9FLGdCQUFnQixDQUNKLENBQUMsQ0FDRixDQUFDLENBQUM7SUFDdEIsQ0FBQzs7QUFDTSxpQkFBSyxHQUFHO0lBQ1gsSUFBSSxJQUFJLEtBQUssT0FBTyxJQUFtQixDQUFDLENBQUMsQ0FBQztJQUMxQyxJQUFJLGVBQWUsS0FBSyxPQUFPLGVBQXlDLENBQUMsQ0FBQyxDQUFDO0lBQzNFLElBQUksWUFBWSxLQUFLLE9BQU8sWUFBbUMsQ0FBQyxDQUFDLENBQUM7SUFDbEUsSUFBSSxZQUFZLEtBQUssT0FBTyxZQUFtQyxDQUFDLENBQUMsQ0FBQztDQUNyRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgQXV0b2NvbXBsZXRlLCBBdXRvY29tcGxldGVQcm9wcywgQXV0b3N1Z2dlc3RTZWxlY3RFdmVudCB9IGZyb20gJy4uL0F1dG9jb21wbGV0ZSc7XG5pbXBvcnQgeyBJbnB1dENoYW5nZUV2ZW50IH0gZnJvbSAnLi4vLi4vY29tbW9uJztcbmltcG9ydCB7IGRlYm91bmNlIH0gZnJvbSAnLi4vLi4vdXRpbHMvZGVib3VuY2UnO1xuaW1wb3J0IHsgSWNvbiwgSWNvbk5hbWUgfSBmcm9tICcuLi9JY29uJztcbmltcG9ydCB7IGxpZ2h0IH0gZnJvbSAnLi4vLi4vdGhlbWVzJztcbmltcG9ydCB7IEJ1dHRvbiB9IGZyb20gJy4uL0J1dHRvbic7XG5pbXBvcnQgc3R5bGVkIGZyb20gJy4uLy4uL3V0aWxzL3N0eWxlZCc7XG5pbXBvcnQgeyBLZXlDb2RlcyB9IGZyb20gJy4uLy4uL3V0aWxzL2tleUNvZGVzJztcbmNvbnN0IFNlYXJjaENvbnRhaW5lciA9IHN0eWxlZC5kaXYgYFxuICBkaXNwbGF5OiBmbGV4O1xuICBmbGV4LWRpcmVjdGlvbjogcm93O1xuYDtcbmNvbnN0IFNlYXJjaEJ1dHRvbiA9IHN0eWxlZChCdXR0b24pIGBcbiAgaGVpZ2h0OiA1NHB4O1xuICB3aWR0aDogNTRweDtcbiAgbWFyZ2luOiAwO1xuYDtcbmV4cG9ydCBpbnRlcmZhY2UgU2VhcmNoRXZlbnQge1xuICAgIHF1ZXJ5OiBzdHJpbmc7XG59XG5leHBvcnQgaW50ZXJmYWNlIFNlYXJjaEZpZWxkUHJvcHM8VD4gZXh0ZW5kcyBBdXRvY29tcGxldGVQcm9wczxUPiB7XG4gICAgLyoqXG4gICAgICogQGlnbm9yZVxuICAgICAqL1xuICAgIGNoaWxkcmVuPzogdm9pZDtcbiAgICAvKipcbiAgICAgKiBUaGUgaWNvbiB0byBiZSB1c2VkIGZvciB0aGUgc2VhcmNoLlxuICAgICAqIEBkZWZhdWx0IFNlYXJjaFxuICAgICAqL1xuICAgIGljb24/OiBJY29uTmFtZTtcbiAgICAvKipcbiAgICAgKiBEZWZpbmVzIHdoZXRoZXIgdGhlIHNlYXJjaCB0cmlnZ2VycyBvblNlYXJjaCBvbiBldmVyeSBrZXlzdHJva2Ugb3JcbiAgICAgKiBieSBtYW51YWxseSBjbGlja2luZyBvbiBhIGJ1dHRvbiBvciBwcmVzc2luZyBlbnRlci5cbiAgICAgKlxuICAgICAqIEBkZWZhdWx0IFwiYXV0b1wiXG4gICAgICovXG4gICAgdHJpZ2dlck1vZGU/OiAnYXV0bycgfCAnbWFudWFsJztcbiAgICAvKipcbiAgICAgKiBUaGUgZGVib3VuY2UgdGltZSBpbiBtaWxsaXNlY29uZHMuXG4gICAgICogQGRlZmF1bHQgMjAwXG4gICAgICovXG4gICAgZGVsYXk/OiBudW1iZXI7XG4gICAgLyoqXG4gICAgICogVGhlIGV2ZW50IGZpcmVkIHdoZW4gdGhlIHNlYXJjaCBpcyB0cmlnZ2VyZWQuXG4gICAgICovXG4gICAgb25TZWFyY2g/KGV2OiBTZWFyY2hFdmVudCk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogQWx3YXlzIGB0cnVlYCBvbiBTZWFyY2hmaWVsZCBjb21wb25lbnRzLlxuICAgICAqIEBpZ25vcmVcbiAgICAgKi9cbiAgICBjbGVhcmFibGU/OiBib29sZWFuO1xufVxuY29uc3QgZGVmYXVsdERlYm91bmNlRGVsYXkgPSAyMDA7XG50eXBlIFNlYXJjaEZpZWxkU3RhdGUgPSBTZWFyY2hFdmVudDtcbi8qKlxuICogQSBzZWFyY2ggZmllbGQgZm9yIHVzZXIgc2VhcmNoIHF1ZXJpZXMuXG4gKi9cbmV4cG9ydCBjbGFzcyBTZWFyY2hGaWVsZDxUPiBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxTZWFyY2hGaWVsZFByb3BzPFQ+LCBTZWFyY2hGaWVsZFN0YXRlPiB7XG4gICAgcHJpdmF0ZSBmaXJlU2VhcmNoOiAocTogc3RyaW5nKSA9PiB2b2lkO1xuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBTZWFyY2hGaWVsZFByb3BzPFQ+KSB7XG4gICAgICAgIHN1cGVyKHByb3BzKTtcbiAgICAgICAgY29uc3QgeyBkZWxheSA9IGRlZmF1bHREZWJvdW5jZURlbGF5IH0gPSBwcm9wcztcbiAgICAgICAgdGhpcy5zdGF0ZSA9IHsgcXVlcnk6ICcnIH07XG4gICAgICAgIHRoaXMuZmlyZVNlYXJjaCA9IGRlYm91bmNlKChxdWVyeTogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB7IG9uU2VhcmNoIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICAgICAgdHlwZW9mIG9uU2VhcmNoID09PSAnZnVuY3Rpb24nICYmIG9uU2VhcmNoKHsgcXVlcnkgfSk7XG4gICAgICAgIH0sIGRlbGF5KTtcbiAgICB9XG4gICAgcHJpdmF0ZSBoYW5kbGVLZXlEb3duID0gKGU6IFJlYWN0LktleWJvYXJkRXZlbnQ8SFRNTEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIGUua2V5Q29kZSA9PT0gS2V5Q29kZXMuZW50ZXIgJiYgdGhpcy5maXJlU2VhcmNoKHRoaXMuc3RhdGUucXVlcnkpO1xuICAgIH07XG4gICAgcHJpdmF0ZSBvblNlYXJjaENsaWNrID0gKCkgPT4ge1xuICAgICAgICBjb25zdCB7IG9uU2VhcmNoIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICB0eXBlb2Ygb25TZWFyY2ggPT09ICdmdW5jdGlvbicgJiYgb25TZWFyY2goeyBxdWVyeTogdGhpcy5zdGF0ZS5xdWVyeSB9KTtcbiAgICB9O1xuICAgIHByaXZhdGUgb25DbGVhciA9ICgpID0+IHtcbiAgICAgICAgY29uc3QgeyBvbkNsZWFyLCB0cmlnZ2VyTW9kZSA9ICdhdXRvJyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgdHlwZW9mIG9uQ2xlYXIgPT09ICdmdW5jdGlvbicgJiYgb25DbGVhcigpO1xuICAgICAgICAvLyBJbiBjYXNlLCB0cmlnZ2VyTW9kZSBpcyBzZXQgdG8gbWFudWFsLCBjbGlja2luZyBvbiBjbGVhciBzaG91bGQgYWxzbyB0cmlnZ2VyIHRoZSBzZWFyY2guXG4gICAgICAgIHRyaWdnZXJNb2RlID09PSAnbWFudWFsJyAmJiB0aGlzLmZpcmVTZWFyY2goJycpO1xuICAgIH07XG4gICAgcHJpdmF0ZSBvblN1Z2dlc3Rpb25TZWxlY3RlZCA9IChlOiBBdXRvc3VnZ2VzdFNlbGVjdEV2ZW50PFQ+KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgb25TdWdnZXN0aW9uU2VsZWN0ZWQsIHRyaWdnZXJNb2RlID0gJ2F1dG8nIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICB0eXBlb2Ygb25TdWdnZXN0aW9uU2VsZWN0ZWQgPT09ICdmdW5jdGlvbicgJiYgb25TdWdnZXN0aW9uU2VsZWN0ZWQoZSk7XG4gICAgICAgIC8vIEluIGNhc2UsIHRyaWdnZXJNb2RlIGlzIHNldCB0byBtYW51YWwsIHNlbGVjdGluZyBhIHN1Z2dlc3Rpb24gc2hvdWxkIGFsc28gdHJpZ2dlciB0aGUgc2VhcmNoLlxuICAgICAgICB0cmlnZ2VyTW9kZSA9PT0gJ21hbnVhbCcgJiYgdGhpcy5maXJlU2VhcmNoKFN0cmluZyhlLnZhbHVlKSk7XG4gICAgfTtcbiAgICBwcml2YXRlIGNoYW5nZSA9IChlOiBJbnB1dENoYW5nZUV2ZW50PHN0cmluZz4pID0+IHtcbiAgICAgICAgY29uc3QgeyBvbkNoYW5nZSwgdHJpZ2dlck1vZGUgPSAnYXV0bycgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBxdWVyeTogZS52YWx1ZSB9KTtcbiAgICAgICAgdHlwZW9mIG9uQ2hhbmdlID09PSAnZnVuY3Rpb24nICYmIG9uQ2hhbmdlKGUpO1xuICAgICAgICB0cmlnZ2VyTW9kZSA9PT0gJ2F1dG8nICYmIHRoaXMuZmlyZVNlYXJjaChlLnZhbHVlKTtcbiAgICB9O1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBvblNlYXJjaCwgZGVsYXksIGljb24gPSAnU2VhcmNoJywgdHJpZ2dlck1vZGUgPSAnYXV0bycsIC4uLnJlc3QgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IGF1dG9UcmlnZ2VyID0gdHJpZ2dlck1vZGUgPT09ICdhdXRvJztcbiAgICAgICAgY29uc3QgZmllbGRJY29uQ29sb3IgPSAocmVzdC50aGVtZSAmJiByZXN0LnRoZW1lLnRleHQyKSB8fCBsaWdodC50ZXh0MjtcbiAgICAgICAgY29uc3QgYnV0dG9uSWNvbkNvbG9yID0gKHJlc3QudGhlbWUgJiYgcmVzdC50aGVtZS50ZXh0NCkgfHwgbGlnaHQudGV4dDQ7XG4gICAgICAgIGNvbnN0IHNlYXJjaEZpZWxkSWNvbiA9IDxJY29uIG5hbWU9e2ljb259IGNvbG9yPXtmaWVsZEljb25Db2xvcn0gc2l6ZT1cIjIycHhcIi8+O1xuICAgICAgICBjb25zdCBzZWFyY2hCdXR0b25JY29uID0gPEljb24gbmFtZT17aWNvbn0gY29sb3I9e2J1dHRvbkljb25Db2xvcn0gc2l6ZT1cIjIycHhcIi8+O1xuICAgICAgICByZXR1cm4gKDxTZWFyY2hDb250YWluZXIgb25LZXlEb3duPXt0aGlzLmhhbmRsZUtleURvd259PlxuICAgICAgICA8QXV0b2NvbXBsZXRlIHsuLi5yZXN0fSBvbkNsZWFyPXt0aGlzLm9uQ2xlYXJ9IG9uQ2hhbmdlPXt0aGlzLmNoYW5nZX0gb25TdWdnZXN0aW9uU2VsZWN0ZWQ9e3RoaXMub25TdWdnZXN0aW9uU2VsZWN0ZWR9IGljb249e2F1dG9UcmlnZ2VyID8gc2VhcmNoRmllbGRJY29uIDogPD48Lz59Lz5cbiAgICAgICAgeyFhdXRvVHJpZ2dlciAmJiAoPFNlYXJjaEJ1dHRvbiBkaXNhYmxlZD17cmVzdC5kaXNhYmxlZH0gb25DbGljaz17dGhpcy5vblNlYXJjaENsaWNrfT5cbiAgICAgICAgICAgIHtzZWFyY2hCdXR0b25JY29ufVxuICAgICAgICAgIDwvU2VhcmNoQnV0dG9uPil9XG4gICAgICA8L1NlYXJjaENvbnRhaW5lcj4pO1xuICAgIH1cbiAgICBzdGF0aWMgaW5uZXIgPSB7XG4gICAgICAgIGdldCBJY29uKCkgeyByZXR1cm4gSWNvbiBhcyB0eXBlb2YgSWNvbjsgfSxcbiAgICAgICAgZ2V0IFNlYXJjaENvbnRhaW5lcigpIHsgcmV0dXJuIFNlYXJjaENvbnRhaW5lciBhcyB0eXBlb2YgU2VhcmNoQ29udGFpbmVyOyB9LFxuICAgICAgICBnZXQgQXV0b2NvbXBsZXRlKCkgeyByZXR1cm4gQXV0b2NvbXBsZXRlIGFzIHR5cGVvZiBBdXRvY29tcGxldGU7IH0sXG4gICAgICAgIGdldCBTZWFyY2hCdXR0b24oKSB7IHJldHVybiBTZWFyY2hCdXR0b24gYXMgdHlwZW9mIFNlYXJjaEJ1dHRvbjsgfVxuICAgIH07XG59XG4iXX0=
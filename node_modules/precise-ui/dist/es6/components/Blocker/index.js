var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
import * as React from 'react';
import styled from '../../utils/styled';
import { transparentize } from '../../utils';
import { dark } from '../../colors';
const FixedContainer = styled.div `
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  position: fixed;
  z-index: 10000;
  overflow-x: hidden;
  overflow-y: auto;
`;
const FocusKeeper = styled.a `
  height: 0;
  width: 0;
  overflow: hidden;
`;
const StyledModalBackground = styled(FixedContainer) `
  overflow: hidden;
  z-index: 9999;
  background: ${transparentize(dark, 0.4)};
`;
/**
 * Defines a generic content blocking overlay element, e.g., for a modal dialog.
 */
export class Blocker extends React.Component {
    constructor() {
        super(...arguments);
        this.keepFirstFocus = () => {
            this.keepFocus('first');
        };
        this.keepLastFocus = () => {
            this.keepFocus('last');
        };
        this.setElement = (node) => {
            if (node && node !== this.modalNode) {
                const el = node.querySelector('*[tabindex]');
                (el || node).focus();
            }
            this.modalNode = node;
        };
        this.onContainerClick = (e) => {
            e.stopPropagation();
            if (!this.onScrollbarClick(e) &&
                (e.target === e.currentTarget || (e.target instanceof HTMLElement && e.target.parentElement === e.currentTarget))) {
                this.notifyClose(e);
            }
        };
        this.onScrollbarClick = (e) => {
            return e.target instanceof HTMLElement && e.target.offsetLeft + e.target.scrollWidth < e.clientX;
        };
        this.onKeyPress = (e) => {
            if (e.keyCode === 27 /* escape */) {
                this.notifyClose(e);
            }
        };
    }
    getFocusables() {
        if (this.modalNode) {
            return this.modalNode.querySelectorAll('a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]');
        }
        return undefined;
    }
    componentDidMount() {
        this.changeBodyOverflow(true);
    }
    componentWillUnmount() {
        this.changeBodyOverflow(false);
    }
    changeBodyOverflow(open) {
        const body = document.querySelector('body');
        if (body) {
            if (open) {
                body.style.setProperty('overflow', 'hidden');
            }
            else {
                body.style.removeProperty('overflow');
            }
        }
    }
    keepFocus(position) {
        const focusables = this.getFocusables();
        if (focusables && focusables.length > 2) {
            const nextElement = (position === 'first' ? focusables[1] : focusables[focusables.length - 2]);
            nextElement.focus();
        }
    }
    notifyClose(e) {
        const { onClose } = this.props;
        if (typeof onClose === 'function') {
            onClose(e);
        }
    }
    render() {
        const _a = this.props, { children, onClose } = _a, props = __rest(_a, ["children", "onClose"]);
        return (React.createElement(React.Fragment, null,
            React.createElement(FixedContainer, Object.assign({ ref: this.setElement, onMouseDown: this.onContainerClick, onKeyDown: this.onKeyPress }, props),
                React.createElement(FocusKeeper, { href: "#", onFocus: this.keepLastFocus }),
                children,
                React.createElement(FocusKeeper, { href: "#", onFocus: this.keepFirstFocus })),
            React.createElement(StyledModalBackground, Object.assign({}, props))));
    }
}
Blocker.inner = {
    get FixedContainer() { return FixedContainer; },
    get FocusKeeper() { return FocusKeeper; },
    get StyledModalBackground() { return StyledModalBackground; }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9CbG9ja2VyL2luZGV4LnRzeCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7QUFBQSxPQUFPLEtBQUssS0FBSyxNQUFNLE9BQU8sQ0FBQztBQUMvQixPQUFPLE1BQU0sTUFBTSxvQkFBb0IsQ0FBQztBQUV4QyxPQUFPLEVBQVksY0FBYyxFQUFFLE1BQU0sYUFBYSxDQUFDO0FBQ3ZELE9BQU8sRUFBRSxJQUFJLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFPcEMsTUFBTSxjQUFjLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQzs7Ozs7Ozs7O0NBU2pDLENBQUM7QUFDRixNQUFNLFdBQVcsR0FBRyxNQUFNLENBQUMsQ0FBQyxDQUFDOzs7O0NBSTVCLENBQUM7QUFDRixNQUFNLHFCQUFxQixHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUMsQ0FBQzs7O2dCQUdyQyxjQUFjLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQztDQUN4QyxDQUFDO0FBQ0Y7O0dBRUc7QUFDSCxNQUFNLE9BQU8sT0FBUSxTQUFRLEtBQUssQ0FBQyxTQUF1QjtJQUExRDs7UUFnQ1ksbUJBQWMsR0FBRyxHQUFHLEVBQUU7WUFDMUIsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUM1QixDQUFDLENBQUM7UUFDTSxrQkFBYSxHQUFHLEdBQUcsRUFBRTtZQUN6QixJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQzNCLENBQUMsQ0FBQztRQUNNLGVBQVUsR0FBRyxDQUFDLElBQTJCLEVBQUUsRUFBRTtZQUNqRCxJQUFJLElBQUksSUFBSSxJQUFJLEtBQUssSUFBSSxDQUFDLFNBQVMsRUFBRTtnQkFDakMsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQWdCLENBQUM7Z0JBQzVELENBQUMsRUFBRSxJQUFJLElBQUksQ0FB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O1FBQ25ELE9BQU8sQ0FBQztZQUNSLG9CQUFDLGNBQWMsa0JBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxVQUFVLEVBQUUsV0FBVyxFQUFFLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxTQUFTLEVBQUUsSUFBSSxDQUFDLFVBQVUsSUFBTSxLQUFLO2dCQUM3RyxvQkFBQyxXQUFXLElBQUMsSUFBSSxFQUFDLEdBQUcsRUFBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGFBQWEsR0FBRztnQkFDbkQsUUFBUTtnQkFDVCxvQkFBQyxXQUFXLElBQUMsSUFBSSxFQUFDLEdBQUcsRUFBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLGNBQWMsR0FBRyxDQUN0QztZQUNqQixvQkFBQyxxQkFBcUIsb0JBQUssS0FBSyxFQUFHLENBQ2xDLENBQUMsQ0FBQztJQUNQLENBQUM7O0FBQ00sYUFBSyxHQUFHO0lBQ1gsSUFBSSxjQUFjLEtBQUssT0FBTyxjQUF1QyxDQUFDLENBQUMsQ0FBQztJQUN4RSxJQUFJLFdBQVcsS0FBSyxPQUFPLFdBQWlDLENBQUMsQ0FBQyxDQUFDO0lBQy9ELElBQUkscUJBQXFCLEtBQUssT0FBTyxxQkFBcUQsQ0FBQyxDQUFDLENBQUM7Q0FDaEcsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQgZnJvbSAnLi4vLi4vdXRpbHMvc3R5bGVkJztcbmltcG9ydCB7IFN0YW5kYXJkUHJvcHMgfSBmcm9tICcuLi8uLi9jb21tb24nO1xuaW1wb3J0IHsgS2V5Q29kZXMsIHRyYW5zcGFyZW50aXplIH0gZnJvbSAnLi4vLi4vdXRpbHMnO1xuaW1wb3J0IHsgZGFyayB9IGZyb20gJy4uLy4uL2NvbG9ycyc7XG5leHBvcnQgaW50ZXJmYWNlIEJsb2NrZXJQcm9wcyBleHRlbmRzIFN0YW5kYXJkUHJvcHMge1xuICAgIC8qKlxuICAgICAqIEV2ZW50IGVtaXR0ZWQgd2hlbiB0aGUgdXNlciB3YW50cyB0byByZW1vdmUgdGhlIGJsb2NrZXIuXG4gICAgICovXG4gICAgb25DbG9zZT8oZTogUmVhY3QuU3ludGhldGljRXZlbnQ8SFRNTEVsZW1lbnQ+KTogdm9pZDtcbn1cbmNvbnN0IEZpeGVkQ29udGFpbmVyID0gc3R5bGVkLmRpdiBgXG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgcmlnaHQ6IDA7XG4gIGJvdHRvbTogMDtcbiAgcG9zaXRpb246IGZpeGVkO1xuICB6LWluZGV4OiAxMDAwMDtcbiAgb3ZlcmZsb3cteDogaGlkZGVuO1xuICBvdmVyZmxvdy15OiBhdXRvO1xuYDtcbmNvbnN0IEZvY3VzS2VlcGVyID0gc3R5bGVkLmEgYFxuICBoZWlnaHQ6IDA7XG4gIHdpZHRoOiAwO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuYDtcbmNvbnN0IFN0eWxlZE1vZGFsQmFja2dyb3VuZCA9IHN0eWxlZChGaXhlZENvbnRhaW5lcikgYFxuICBvdmVyZmxvdzogaGlkZGVuO1xuICB6LWluZGV4OiA5OTk5O1xuICBiYWNrZ3JvdW5kOiAke3RyYW5zcGFyZW50aXplKGRhcmssIDAuNCl9O1xuYDtcbi8qKlxuICogRGVmaW5lcyBhIGdlbmVyaWMgY29udGVudCBibG9ja2luZyBvdmVybGF5IGVsZW1lbnQsIGUuZy4sIGZvciBhIG1vZGFsIGRpYWxvZy5cbiAqL1xuZXhwb3J0IGNsYXNzIEJsb2NrZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8QmxvY2tlclByb3BzPiB7XG4gICAgcHJpdmF0ZSBtb2RhbE5vZGU6IEhUTUxEaXZFbGVtZW50IHwgbnVsbDtcbiAgICBwcml2YXRlIGdldEZvY3VzYWJsZXMoKTogTm9kZUxpc3RPZjxFbGVtZW50PiB8IHVuZGVmaW5lZCB7XG4gICAgICAgIGlmICh0aGlzLm1vZGFsTm9kZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMubW9kYWxOb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoJ2FbaHJlZl0sIGFyZWFbaHJlZl0sIGlucHV0Om5vdChbZGlzYWJsZWRdKSwgc2VsZWN0Om5vdChbZGlzYWJsZWRdKSwgdGV4dGFyZWE6bm90KFtkaXNhYmxlZF0pLCBidXR0b246bm90KFtkaXNhYmxlZF0pLCBpZnJhbWUsIG9iamVjdCwgZW1iZWQsICpbdGFiaW5kZXhdLCAqW2NvbnRlbnRlZGl0YWJsZV0nKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgdGhpcy5jaGFuZ2VCb2R5T3ZlcmZsb3codHJ1ZSk7XG4gICAgfVxuICAgIGNvbXBvbmVudFdpbGxVbm1vdW50KCkge1xuICAgICAgICB0aGlzLmNoYW5nZUJvZHlPdmVyZmxvdyhmYWxzZSk7XG4gICAgfVxuICAgIHByaXZhdGUgY2hhbmdlQm9keU92ZXJmbG93KG9wZW46IGJvb2xlYW4pIHtcbiAgICAgICAgY29uc3QgYm9keSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJ2JvZHknKTtcbiAgICAgICAgaWYgKGJvZHkpIHtcbiAgICAgICAgICAgIGlmIChvcGVuKSB7XG4gICAgICAgICAgICAgICAgYm9keS5zdHlsZS5zZXRQcm9wZXJ0eSgnb3ZlcmZsb3cnLCAnaGlkZGVuJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgICAgICBib2R5LnN0eWxlLnJlbW92ZVByb3BlcnR5KCdvdmVyZmxvdycpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUga2VlcEZvY3VzKHBvc2l0aW9uOiAnZmlyc3QnIHwgJ2xhc3QnKSB7XG4gICAgICAgIGNvbnN0IGZvY3VzYWJsZXMgPSB0aGlzLmdldEZvY3VzYWJsZXMoKTtcbiAgICAgICAgaWYgKGZvY3VzYWJsZXMgJiYgZm9jdXNhYmxlcy5sZW5ndGggPiAyKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0RWxlbWVudCA9IChwb3NpdGlvbiA9PT0gJ2ZpcnN0JyA/IGZvY3VzYWJsZXNbMV0gOiBmb2N1c2FibGVzW2ZvY3VzYWJsZXMubGVuZ3RoIC0gMl0pIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgbmV4dEVsZW1lbnQuZm9jdXMoKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIGtlZXBGaXJzdEZvY3VzID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmtlZXBGb2N1cygnZmlyc3QnKTtcbiAgICB9O1xuICAgIHByaXZhdGUga2VlcExhc3RGb2N1cyA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5rZWVwRm9jdXMoJ2xhc3QnKTtcbiAgICB9O1xuICAgIHByaXZhdGUgc2V0RWxlbWVudCA9IChub2RlOiBIVE1MRGl2RWxlbWVudCB8IG51bGwpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZSAhPT0gdGhpcy5tb2RhbE5vZGUpIHtcbiAgICAgICAgICAgIGNvbnN0IGVsID0gbm9kZS5xdWVyeVNlbGVjdG9yKCcqW3RhYmluZGV4XScpIGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgKGVsIHx8IG5vZGUpLmZvY3VzKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5tb2RhbE5vZGUgPSBub2RlO1xuICAgIH07XG4gICAgcHJpdmF0ZSBub3RpZnlDbG9zZShlOiBSZWFjdC5TeW50aGV0aWNFdmVudDxIVE1MRWxlbWVudD4pIHtcbiAgICAgICAgY29uc3QgeyBvbkNsb3NlIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBpZiAodHlwZW9mIG9uQ2xvc2UgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIG9uQ2xvc2UoZSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHJpdmF0ZSBvbkNvbnRhaW5lckNsaWNrID0gKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIGlmICghdGhpcy5vblNjcm9sbGJhckNsaWNrKGUpICYmXG4gICAgICAgICAgICAoZS50YXJnZXQgPT09IGUuY3VycmVudFRhcmdldCB8fCAoZS50YXJnZXQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCAmJiBlLnRhcmdldC5wYXJlbnRFbGVtZW50ID09PSBlLmN1cnJlbnRUYXJnZXQpKSkge1xuICAgICAgICAgICAgdGhpcy5ub3RpZnlDbG9zZShlKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgcHJpdmF0ZSBvblNjcm9sbGJhckNsaWNrID0gKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTEVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIHJldHVybiBlLnRhcmdldCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIGUudGFyZ2V0Lm9mZnNldExlZnQgKyBlLnRhcmdldC5zY3JvbGxXaWR0aCA8IGUuY2xpZW50WDtcbiAgICB9O1xuICAgIHByaXZhdGUgb25LZXlQcmVzcyA9IChlOiBSZWFjdC5LZXlib2FyZEV2ZW50PEhUTUxFbGVtZW50PikgPT4ge1xuICAgICAgICBpZiAoZS5rZXlDb2RlID09PSBLZXlDb2Rlcy5lc2NhcGUpIHtcbiAgICAgICAgICAgIHRoaXMubm90aWZ5Q2xvc2UoZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBjaGlsZHJlbiwgb25DbG9zZSwgLi4ucHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIHJldHVybiAoPD5cbiAgICAgICAgPEZpeGVkQ29udGFpbmVyIHJlZj17dGhpcy5zZXRFbGVtZW50fSBvbk1vdXNlRG93bj17dGhpcy5vbkNvbnRhaW5lckNsaWNrfSBvbktleURvd249e3RoaXMub25LZXlQcmVzc30gey4uLnByb3BzfT5cbiAgICAgICAgICA8Rm9jdXNLZWVwZXIgaHJlZj1cIiNcIiBvbkZvY3VzPXt0aGlzLmtlZXBMYXN0Rm9jdXN9Lz5cbiAgICAgICAgICB7Y2hpbGRyZW59XG4gICAgICAgICAgPEZvY3VzS2VlcGVyIGhyZWY9XCIjXCIgb25Gb2N1cz17dGhpcy5rZWVwRmlyc3RGb2N1c30vPlxuICAgICAgICA8L0ZpeGVkQ29udGFpbmVyPlxuICAgICAgICA8U3R5bGVkTW9kYWxCYWNrZ3JvdW5kIHsuLi5wcm9wc30vPlxuICAgICAgPC8+KTtcbiAgICB9XG4gICAgc3RhdGljIGlubmVyID0ge1xuICAgICAgICBnZXQgRml4ZWRDb250YWluZXIoKSB7IHJldHVybiBGaXhlZENvbnRhaW5lciBhcyB0eXBlb2YgRml4ZWRDb250YWluZXI7IH0sXG4gICAgICAgIGdldCBGb2N1c0tlZXBlcigpIHsgcmV0dXJuIEZvY3VzS2VlcGVyIGFzIHR5cGVvZiBGb2N1c0tlZXBlcjsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZE1vZGFsQmFja2dyb3VuZCgpIHsgcmV0dXJuIFN0eWxlZE1vZGFsQmFja2dyb3VuZCBhcyB0eXBlb2YgU3R5bGVkTW9kYWxCYWNrZ3JvdW5kOyB9XG4gICAgfTtcbn1cbiJdfQ==
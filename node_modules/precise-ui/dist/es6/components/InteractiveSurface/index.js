var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
import * as React from 'react';
import styled from '../../utils/styled';
import { trackMouse, trackTouch } from '../../utils/interactivity';
const Container = styled.div `
  position: relative;
  touch-action: ${props => (props.disabled ? 'auto' : 'none')};
  user-select: ${props => (props.disabled ? 'auto' : 'none')};
`;
/**
 * The interactive surface provides a component that reacts on touch (or click) interactivity.
 */
export class InteractiveSurface extends React.Component {
    constructor() {
        super(...arguments);
        this.mounted = false;
        this.moved = false;
        this.updateValue = (x, y, active, rect, moved) => {
            let canceled = true;
            if (this.mounted) {
                const { onChange } = this.props;
                this.moved = this.moved || moved;
                if (typeof onChange === 'function') {
                    onChange({
                        x,
                        y,
                        moved: this.moved,
                        active,
                        rect,
                        release() {
                            canceled = false;
                        },
                    });
                }
            }
            return canceled;
        };
        this.changeValue = (e) => {
            const { disabled } = this.props;
            this.moved = false;
            if (!disabled) {
                trackMouse(e, this.updateValue);
            }
        };
        this.preventValue = (e) => {
            const { disabled, opaque } = this.props;
            if (!disabled && !opaque && this.moved) {
                e.preventDefault();
                e.stopPropagation();
            }
        };
        this.changeTouchValue = (e) => {
            const { disabled } = this.props;
            this.moved = false;
            if (!disabled) {
                trackTouch(e, this.updateValue);
            }
        };
    }
    UNSAFE_componentWillMount() {
        this.mounted = true;
    }
    componentWillUnmount() {
        this.mounted = false;
    }
    render() {
        const _a = this.props, { children, disabled, onChange: _0, opaque: _1 } = _a, props = __rest(_a, ["children", "disabled", "onChange", "opaque"]);
        return (React.createElement(Container, Object.assign({}, props, { onMouseDownCapture: this.changeValue, onClickCapture: this.preventValue, onTouchStartCapture: this.changeTouchValue }), children));
    }
}
InteractiveSurface.inner = {
    get Container() { return Container; }
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9JbnRlcmFjdGl2ZVN1cmZhY2UvaW5kZXgudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQy9CLE9BQU8sTUFBTSxNQUFNLG9CQUFvQixDQUFDO0FBRXhDLE9BQU8sRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLE1BQU0sMkJBQTJCLENBQUM7QUE2Q25FLE1BQU0sU0FBUyxHQUFHLE1BQU0sQ0FBQyxHQUFHLENBQTBCOztrQkFFcEMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEtBQUssQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDO2lCQUM1QyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7Q0FDM0QsQ0FBQztBQUNGOztHQUVHO0FBQ0gsTUFBTSxPQUFPLGtCQUFtQixTQUFRLEtBQUssQ0FBQyxTQUFrQztJQUFoRjs7UUFDWSxZQUFPLEdBQUcsS0FBSyxDQUFDO1FBQ2hCLFVBQUssR0FBRyxLQUFLLENBQUM7UUFPZCxnQkFBVyxHQUFHLENBQUMsQ0FBUyxFQUFFLENBQVMsRUFBRSxNQUFlLEVBQUUsSUFBZ0IsRUFBRSxLQUFjLEVBQUUsRUFBRTtZQUM5RixJQUFJLFFBQVEsR0FBRyxJQUFJLENBQUM7WUFDcEIsSUFBSSxJQUFJLENBQUMsT0FBTyxFQUFFO2dCQUNkLE1BQU0sRUFBRSxRQUFRLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO2dCQUNoQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxLQUFLLElBQUksS0FBSyxDQUFDO2dCQUNqQyxJQUFJLE9BQU8sUUFBUSxLQUFLLFVBQVUsRUFBRTtvQkFDaEMsUUFBUSxDQUFDO3dCQUNMLENBQUM7d0JBQ0QsQ0FBQzt3QkFDRCxLQUFLLEVBQUUsSUFBSSxDQUFDLEtBQUs7d0JBQ2pCLE1BQU07d0JBQ04sSUFBSTt3QkFDSixPQUFPOzRCQUNILFFBQVEsR0FBRyxLQUFLLENBQUM7d0JBQ3JCLENBQUM7cUJBQ0osQ0FBQyxDQUFDO2lCQUNOO2FBQ0o7WUFDRCxPQUFPLFFBQVEsQ0FBQztRQUNwQixDQUFDLENBQUM7UUFDTSxnQkFBVyxHQUFHLENBQUMsQ0FBbUMsRUFBRSxFQUFFO1lBQzFELE1BQU0sRUFBRSxRQUFRLEVBQUUsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1lBQ2hDLElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1lBQ25CLElBQUksQ0FBQyxRQUFRLEVBQUU7Z0JBQ1gsVUFBVSxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7YUFDbkM7UUFDTCxDQUFDLENBQUM7UUFDTSxpQkFBWSxHQUFHLENBQUMsQ0FBbUMsRUFBRSxFQUFFO1lBQzNELE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQztZQUN4QyxJQUFJLENBQUMsUUFBUSxJQUFJLENBQUMsTUFBTSxJQUFJLElBQUksQ0FBQyxLQUFLLEVBQUU7Z0JBQ3BDLENBQUMsQ0FBQyxjQUFjLEVBQUUsQ0FBQztnQkFDbkIsQ0FBQyxDQUFDLGVBQWUsRUFBRSxDQUFDO2FBQ3ZCO1FBQ0wsQ0FBQyxDQUFDO1FBQ00scUJBQWdCLEdBQUcsQ0FBQyxDQUFtQyxFQUFFLEVBQUU7WUFDL0QsTUFBTSxFQUFFLFFBQVEsRUFBRSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUM7WUFDaEMsSUFBSSxDQUFDLEtBQUssR0FBRyxLQUFLLENBQUM7WUFDbkIsSUFBSSxDQUFDLFFBQVEsRUFBRTtnQkFDWCxVQUFVLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQzthQUNuQztRQUNMLENBQUMsQ0FBQztJQVVOLENBQUM7SUF4REcseUJBQXlCO1FBQ3JCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO0lBQ3hCLENBQUM7SUFDRCxvQkFBb0I7UUFDaEIsSUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7SUFDekIsQ0FBQztJQTBDRCxNQUFNO1FBQ0YsTUFBTSxlQUF1RSxFQUF2RSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxFQUFFLEVBQUUsRUFBRSxNQUFNLEVBQUUsRUFBRSxPQUF5QixFQUF2QixrRUFBdUIsQ0FBQztRQUM5RSxPQUFPLENBQUMsb0JBQUMsU0FBUyxvQkFBSyxLQUFLLElBQUUsa0JBQWtCLEVBQUUsSUFBSSxDQUFDLFdBQVcsRUFBRSxjQUFjLEVBQUUsSUFBSSxDQUFDLFlBQVksRUFBRSxtQkFBbUIsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLEtBQ2hKLFFBQVEsQ0FDQyxDQUFDLENBQUM7SUFDaEIsQ0FBQzs7QUFDTSx3QkFBSyxHQUFHO0lBQ1gsSUFBSSxTQUFTLEtBQUssT0FBTyxTQUE2QixDQUFDLENBQUMsQ0FBQztDQUM1RCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCBmcm9tICcuLi8uLi91dGlscy9zdHlsZWQnO1xuaW1wb3J0IHsgU3RhbmRhcmRQcm9wcyB9IGZyb20gJy4uLy4uL2NvbW1vbic7XG5pbXBvcnQgeyB0cmFja01vdXNlLCB0cmFja1RvdWNoIH0gZnJvbSAnLi4vLi4vdXRpbHMvaW50ZXJhY3Rpdml0eSc7XG5leHBvcnQgaW50ZXJmYWNlIEludGVyYWN0aXZlU3VyZmFjZUNoYW5nZUV2ZW50IHtcbiAgICAvKipcbiAgICAgKiBSZWxhdGl2ZSBob3Jpem9udGFsIGNvb3JkaW5hdGUgKDAgdG8gMSkuXG4gICAgICovXG4gICAgeDogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIFJlbGF0aXZlIHZlcnRpY2FsIGNvb3JkaW5hdGUgKDAgdG8gMSkuXG4gICAgICovXG4gICAgeTogbnVtYmVyO1xuICAgIC8qKlxuICAgICAqIEdldHMgaWYgdGhlIGRyYWdnaW5nIGlzIGN1cnJlbnRseSBhY3RpdmUuXG4gICAgICovXG4gICAgYWN0aXZlOiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIEdldHMgaWYgYW55IG1vdmUgd2FzIGRldGVjdGVkIHVwIHVudGlsIG5vdy5cbiAgICAgKi9cbiAgICBtb3ZlZDogYm9vbGVhbjtcbiAgICAvKipcbiAgICAgKiBHZXRzIHRoZSBhc3NvY2lhdGVkIGFic29sdXRlIGRpbWVuc2lvbnMuXG4gICAgICovXG4gICAgcmVjdDogQ2xpZW50UmVjdDtcbiAgICAvKipcbiAgICAgKiBSZWxlYXNlcyB0aGUgZHJhZyBoYW5kbGVyIGZyb20gdGhlIHN1cmZhY2UuXG4gICAgICovXG4gICAgcmVsZWFzZSgpOiB2b2lkO1xufVxuZXhwb3J0IGludGVyZmFjZSBJbnRlcmFjdGl2ZVN1cmZhY2VQcm9wcyBleHRlbmRzIFN0YW5kYXJkUHJvcHMge1xuICAgIC8qKlxuICAgICAqIEV2ZW50IHRoYXQgaXMgZmlyZWQgb25jZSBpbnRlcmFjdGlvbiB3aXRoIHRoZSBjb21wb25lbnQgaXMgaGFwcGVuaW5nLlxuICAgICAqL1xuICAgIG9uQ2hhbmdlPyhlOiBJbnRlcmFjdGl2ZVN1cmZhY2VDaGFuZ2VFdmVudCk6IHZvaWQ7XG4gICAgLyoqXG4gICAgICogRGV0ZXJtaW5lcyBpZiBpbnRlcmFjdGl2aXR5IGlzIGRpc2FibGVkLCBpLmUuLCB0b3VjaCBldGMuIGJlaGF2ZXMgYXMgYSBzY3JvbGwuXG4gICAgICovXG4gICAgZGlzYWJsZWQ/OiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIFBhc3NlcyB0aGUgZXZlbnQgY2FwdHVyaW5nIG9uIHRvIGNoaWxkcmVuLCBzdWNoIHRoYXQgbGlua3MgZXRjLiBjYW4gYmUgY2xpY2tlZC5cbiAgICAgKi9cbiAgICBvcGFxdWU/OiBib29sZWFuO1xuICAgIC8qKlxuICAgICAqIFRoZSBjb250ZW50IG9mIHRoZSBjb250YWluZXIuXG4gICAgICovXG4gICAgY2hpbGRyZW4/OiBSZWFjdC5SZWFjdE5vZGU7XG59XG5jb25zdCBDb250YWluZXIgPSBzdHlsZWQuZGl2PEludGVyYWN0aXZlU3VyZmFjZVByb3BzPiBgXG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG91Y2gtYWN0aW9uOiAke3Byb3BzID0+IChwcm9wcy5kaXNhYmxlZCA/ICdhdXRvJyA6ICdub25lJyl9O1xuICB1c2VyLXNlbGVjdDogJHtwcm9wcyA9PiAocHJvcHMuZGlzYWJsZWQgPyAnYXV0bycgOiAnbm9uZScpfTtcbmA7XG4vKipcbiAqIFRoZSBpbnRlcmFjdGl2ZSBzdXJmYWNlIHByb3ZpZGVzIGEgY29tcG9uZW50IHRoYXQgcmVhY3RzIG9uIHRvdWNoIChvciBjbGljaykgaW50ZXJhY3Rpdml0eS5cbiAqL1xuZXhwb3J0IGNsYXNzIEludGVyYWN0aXZlU3VyZmFjZSBleHRlbmRzIFJlYWN0LkNvbXBvbmVudDxJbnRlcmFjdGl2ZVN1cmZhY2VQcm9wcz4ge1xuICAgIHByaXZhdGUgbW91bnRlZCA9IGZhbHNlO1xuICAgIHByaXZhdGUgbW92ZWQgPSBmYWxzZTtcbiAgICBVTlNBRkVfY29tcG9uZW50V2lsbE1vdW50KCkge1xuICAgICAgICB0aGlzLm1vdW50ZWQgPSB0cnVlO1xuICAgIH1cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgdGhpcy5tb3VudGVkID0gZmFsc2U7XG4gICAgfVxuICAgIHByaXZhdGUgdXBkYXRlVmFsdWUgPSAoeDogbnVtYmVyLCB5OiBudW1iZXIsIGFjdGl2ZTogYm9vbGVhbiwgcmVjdDogQ2xpZW50UmVjdCwgbW92ZWQ6IGJvb2xlYW4pID0+IHtcbiAgICAgICAgbGV0IGNhbmNlbGVkID0gdHJ1ZTtcbiAgICAgICAgaWYgKHRoaXMubW91bnRlZCkge1xuICAgICAgICAgICAgY29uc3QgeyBvbkNoYW5nZSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgICAgIHRoaXMubW92ZWQgPSB0aGlzLm1vdmVkIHx8IG1vdmVkO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBvbkNoYW5nZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgeCxcbiAgICAgICAgICAgICAgICAgICAgeSxcbiAgICAgICAgICAgICAgICAgICAgbW92ZWQ6IHRoaXMubW92ZWQsXG4gICAgICAgICAgICAgICAgICAgIGFjdGl2ZSxcbiAgICAgICAgICAgICAgICAgICAgcmVjdCxcbiAgICAgICAgICAgICAgICAgICAgcmVsZWFzZSgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmNlbGVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGNhbmNlbGVkO1xuICAgIH07XG4gICAgcHJpdmF0ZSBjaGFuZ2VWYWx1ZSA9IChlOiBSZWFjdC5Nb3VzZUV2ZW50PEhUTUxEaXZFbGVtZW50PikgPT4ge1xuICAgICAgICBjb25zdCB7IGRpc2FibGVkIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICB0aGlzLm1vdmVkID0gZmFsc2U7XG4gICAgICAgIGlmICghZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRyYWNrTW91c2UoZSwgdGhpcy51cGRhdGVWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHByaXZhdGUgcHJldmVudFZhbHVlID0gKGU6IFJlYWN0Lk1vdXNlRXZlbnQ8SFRNTERpdkVsZW1lbnQ+KSA9PiB7XG4gICAgICAgIGNvbnN0IHsgZGlzYWJsZWQsIG9wYXF1ZSB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgaWYgKCFkaXNhYmxlZCAmJiAhb3BhcXVlICYmIHRoaXMubW92ZWQpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHByaXZhdGUgY2hhbmdlVG91Y2hWYWx1ZSA9IChlOiBSZWFjdC5Ub3VjaEV2ZW50PEhUTUxEaXZFbGVtZW50PikgPT4ge1xuICAgICAgICBjb25zdCB7IGRpc2FibGVkIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICB0aGlzLm1vdmVkID0gZmFsc2U7XG4gICAgICAgIGlmICghZGlzYWJsZWQpIHtcbiAgICAgICAgICAgIHRyYWNrVG91Y2goZSwgdGhpcy51cGRhdGVWYWx1ZSk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHJlbmRlcigpIHtcbiAgICAgICAgY29uc3QgeyBjaGlsZHJlbiwgZGlzYWJsZWQsIG9uQ2hhbmdlOiBfMCwgb3BhcXVlOiBfMSwgLi4ucHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIHJldHVybiAoPENvbnRhaW5lciB7Li4ucHJvcHN9IG9uTW91c2VEb3duQ2FwdHVyZT17dGhpcy5jaGFuZ2VWYWx1ZX0gb25DbGlja0NhcHR1cmU9e3RoaXMucHJldmVudFZhbHVlfSBvblRvdWNoU3RhcnRDYXB0dXJlPXt0aGlzLmNoYW5nZVRvdWNoVmFsdWV9PlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8L0NvbnRhaW5lcj4pO1xuICAgIH1cbiAgICBzdGF0aWMgaW5uZXIgPSB7XG4gICAgICAgIGdldCBDb250YWluZXIoKSB7IHJldHVybiBDb250YWluZXIgYXMgdHlwZW9mIENvbnRhaW5lcjsgfVxuICAgIH07XG59XG4iXX0=
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
import * as React from 'react';
import styled, { themed } from '../../utils/styled';
import { withFormContext } from '../../hoc';
import { distance } from '../../distance';
import { IndicatorKnob } from '../IndicatorKnob';
import { getFontStyle } from '../../textStyles';
import { InputNotification } from '../InputNotification';
import { PaddedContainer } from '../PaddedContainer';
const transitionDuration = '0.3s';
const transitionEase = 'cubic-bezier(0, 0, 0.25, 1)';
const ToggleContainer = styled('div') `
  ${getFontStyle({ size: 'medium' })};
  position: relative;
  display: inline-block;
  cursor: ${props => (props.disabled ? 'not-allowed' : 'pointer')};
  color: ${themed(props => props.theme.text1)};
`;
const ToggleBoxWrapper = styled.div `
  display: inline-block;
  vertical-align: middle;
  padding: ${distance.xsmall} 0;
`;
const StyledInput = styled.input `
  opacity: 0;
  position: absolute;
  top: 0;
  left: 0;
`;
const ToggleBox = styled('div') `
  outline: 0;
  display: block;
  width: ${distance.xxlarge};
  height: ${distance.medium};
  border-radius: ${distance.small};
  position: relative;
  background: ${themed(props => props.theme.ui4)};
  transition: all ${transitionDuration} ${transitionEase};
`;
const StyledLabel = styled.label `
  display: block;
  margin-bottom: ${distance.small};
`;
const StyledDesc = styled.span `
  display: inline-block;
  margin-left: ${distance.small};
  vertical-align: middle;
`;
const IndicatorKnobStyle = {
    transform: 'translate(0, -50%)',
};
class ToggleInt extends React.PureComponent {
    constructor(props) {
        super(props);
        this.handleOnClick = (e) => {
            this.changeValue();
            e.preventDefault();
        };
        this.handleCheckboxChange = () => {
            this.changeValue();
        };
        this.handleCheckboxFocus = () => {
            this.setState({
                focused: true,
            });
        };
        this.handleCheckboxBlur = () => {
            this.setState({
                focused: false,
            });
        };
        this.state = {
            controlled: typeof props.value !== 'undefined',
            value: props.value || props.defaultValue || false,
            focused: false,
            error: props.error,
        };
    }
    componentDidMount() {
        const { form } = this.props;
        const { controlled } = this.state;
        if (!controlled && form) {
            form.subscribe(this);
        }
    }
    componentWillUnmount() {
        const { form } = this.props;
        const { controlled } = this.state;
        if (!controlled && form) {
            form.unsubscribe(this);
        }
    }
    UNSAFE_componentWillReceiveProps({ value = false, error }) {
        if (this.state.controlled) {
            this.setState({ value });
        }
        this.setState({ error });
    }
    changeValue() {
        const { onChange, disabled, form, name = '' } = this.props;
        if (!disabled) {
            const { controlled, value } = this.state;
            const status = !value;
            if (!controlled) {
                if (form) {
                    form.change({
                        name,
                        value: status,
                    });
                }
                else {
                    this.setState({
                        value: status,
                    });
                }
            }
            if (typeof onChange === 'function') {
                onChange({
                    value: status,
                });
            }
        }
    }
    render() {
        const _a = this.props, { children, disabled, theme, value: _0, defaultValue: _1, onChange: _2, onInput: _3, info, label } = _a, props = __rest(_a, ["children", "disabled", "theme", "value", "defaultValue", "onChange", "onInput", "info", "label"]);
        const { value, focused, error } = this.state;
        const containerProps = Object.assign({}, props, { theme, onClick: this.handleOnClick, disabled });
        const boxProps = {
            checked: value,
            theme,
        };
        return (React.createElement(ToggleContainer, Object.assign({}, containerProps),
            label && React.createElement(StyledLabel, { theme: theme }, label),
            React.createElement(ToggleBoxWrapper, null,
                React.createElement(StyledInput, { checked: value, onChange: this.handleCheckboxChange, onFocus: this.handleCheckboxFocus, onBlur: this.handleCheckboxBlur }),
                React.createElement(ToggleBox, Object.assign({}, boxProps),
                    React.createElement(IndicatorKnob, { style: IndicatorKnobStyle, x: value ? 0.5 : 0, active: value, focus: focused, disabled: containerProps.disabled, animate: true }))),
            children && React.createElement(StyledDesc, null, children),
            (error || info) && (React.createElement(PaddedContainer, { top: "xsmall", bottom: "xsmall" },
                React.createElement(InputNotification, { error: error, info: info })))));
    }
}
ToggleInt.inner = {
    get ToggleContainer() { return ToggleContainer; },
    get StyledLabel() { return StyledLabel; },
    get ToggleBoxWrapper() { return ToggleBoxWrapper; },
    get StyledInput() { return StyledInput; },
    get ToggleBox() { return ToggleBox; },
    get IndicatorKnob() { return IndicatorKnob; },
    get StyledDesc() { return StyledDesc; },
    get PaddedContainer() { return PaddedContainer; },
    get InputNotification() { return InputNotification; }
};
/**
 * The toggle component displays a button to toggle a checked state.
 */
export const Toggle = withFormContext(ToggleInt);
Toggle.displayName = 'Toggle';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9Ub2dnbGUvaW5kZXgudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFBLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQy9CLE9BQU8sTUFBTSxFQUFFLEVBQUUsTUFBTSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFFcEQsT0FBTyxFQUFFLGVBQWUsRUFBb0IsTUFBTSxXQUFXLENBQUM7QUFDOUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNqRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sa0JBQWtCLENBQUM7QUFDaEQsT0FBTyxFQUFFLGlCQUFpQixFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDekQsT0FBTyxFQUFFLGVBQWUsRUFBRSxNQUFNLG9CQUFvQixDQUFDO0FBMEJyRCxNQUFNLGtCQUFrQixHQUFHLE1BQU0sQ0FBQztBQUNsQyxNQUFNLGNBQWMsR0FBRyw2QkFBNkIsQ0FBQztBQUNyRCxNQUFNLGVBQWUsR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDLENBQXVCO0lBQ3hELFlBQVksQ0FBQyxFQUFFLElBQUksRUFBRSxRQUFRLEVBQUUsQ0FBQzs7O1lBR3hCLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQztXQUN0RCxNQUFNLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQztDQUM1QyxDQUFDO0FBQ0YsTUFBTSxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsR0FBRyxDQUFDOzs7YUFHdkIsUUFBUSxDQUFDLE1BQU07Q0FDM0IsQ0FBQztBQUNGLE1BQU0s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OUUsSUFBSSxXQUFXLEtBQUssT0FBTyxXQUFpQyxDQUFDLENBQUMsQ0FBQztJQUMvRCxJQUFJLFNBQVMsS0FBSyxPQUFPLFNBQTZCLENBQUMsQ0FBQyxDQUFDO0lBQ3pELElBQUksYUFBYSxLQUFLLE9BQU8sYUFBcUMsQ0FBQyxDQUFDLENBQUM7SUFDckUsSUFBSSxVQUFVLEtBQUssT0FBTyxVQUErQixDQUFDLENBQUMsQ0FBQztJQUM1RCxJQUFJLGVBQWUsS0FBSyxPQUFPLGVBQXlDLENBQUMsQ0FBQyxDQUFDO0lBQzNFLElBQUksaUJBQWlCLEtBQUssT0FBTyxpQkFBNkMsQ0FBQyxDQUFDLENBQUM7Q0FDcEYsQ0FBQztBQUVOOztHQUVHO0FBQ0gsTUFBTSxDQUFDLE1BQU0sTUFBTSxHQUFHLGVBQWUsQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNqRCxNQUFNLENBQUMsV0FBVyxHQUFHLFFBQVEsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIFJlYWN0IGZyb20gJ3JlYWN0JztcbmltcG9ydCBzdHlsZWQsIHsgdGhlbWVkIH0gZnJvbSAnLi4vLi4vdXRpbHMvc3R5bGVkJztcbmltcG9ydCB7IElucHV0UHJvcHMsIElucHV0Q2hhbmdlRXZlbnQgfSBmcm9tICcuLi8uLi9jb21tb24nO1xuaW1wb3J0IHsgd2l0aEZvcm1Db250ZXh0LCBGb3JtQ29udGV4dFByb3BzIH0gZnJvbSAnLi4vLi4vaG9jJztcbmltcG9ydCB7IGRpc3RhbmNlIH0gZnJvbSAnLi4vLi4vZGlzdGFuY2UnO1xuaW1wb3J0IHsgSW5kaWNhdG9yS25vYiB9IGZyb20gJy4uL0luZGljYXRvcktub2InO1xuaW1wb3J0IHsgZ2V0Rm9udFN0eWxlIH0gZnJvbSAnLi4vLi4vdGV4dFN0eWxlcyc7XG5pbXBvcnQgeyBJbnB1dE5vdGlmaWNhdGlvbiB9IGZyb20gJy4uL0lucHV0Tm90aWZpY2F0aW9uJztcbmltcG9ydCB7IFBhZGRlZENvbnRhaW5lciB9IGZyb20gJy4uL1BhZGRlZENvbnRhaW5lcic7XG5leHBvcnQgdHlwZSBUb2dnbGVDaGFuZ2VFdmVudCA9IElucHV0Q2hhbmdlRXZlbnQ8Ym9vbGVhbj47XG5leHBvcnQgaW50ZXJmYWNlIFRvZ2dsZVByb3BzIGV4dGVuZHMgSW5wdXRQcm9wczxib29sZWFuPiB7XG4gICAgLyoqXG4gICAgICogU2V0cyB0aGUgdGV4dCBvZiBsYWJlbC5cbiAgICAgKiBAZGVmYXVsdCAnJ1xuICAgICAqL1xuICAgIGxhYmVsPzogUmVhY3QuUmVhY3RDaGlsZDtcbiAgICAvKipcbiAgICAgKiBUaGUgY29udGVudCBvZiB0aGUgdG9nZ2xlIGJ1dHRvbi5cbiAgICAgKi9cbiAgICBjaGlsZHJlbj86IFJlYWN0LlJlYWN0Tm9kZTtcbn1cbmV4cG9ydCBpbnRlcmZhY2UgVG9nZ2xlU3RhdGUge1xuICAgIHZhbHVlOiBib29sZWFuO1xuICAgIGVycm9yPzogUmVhY3QuUmVhY3RDaGlsZDtcbiAgICBjb250cm9sbGVkOiBib29sZWFuO1xuICAgIGZvY3VzZWQ6IGJvb2xlYW47XG59XG5pbnRlcmZhY2UgVG9nZ2xlQ29udGFpbmVyUHJvcHMge1xuICAgIGRpc2FibGVkPzogYm9vbGVhbjtcbn1cbmludGVyZmFjZSBUb2dnbGVCb3hQcm9wcyB7XG4gICAgY2hlY2tlZDogYm9vbGVhbjtcbiAgICB0aGVtZTogYW55O1xufVxuY29uc3QgdHJhbnNpdGlvbkR1cmF0aW9uID0gJzAuM3MnO1xuY29uc3QgdHJhbnNpdGlvbkVhc2UgPSAnY3ViaWMtYmV6aWVyKDAsIDAsIDAuMjUsIDEpJztcbmNvbnN0IFRvZ2dsZUNvbnRhaW5lciA9IHN0eWxlZCgnZGl2Jyk8VG9nZ2xlQ29udGFpbmVyUHJvcHM+IGBcbiAgJHtnZXRGb250U3R5bGUoeyBzaXplOiAnbWVkaXVtJyB9KX07XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICBjdXJzb3I6ICR7cHJvcHMgPT4gKHByb3BzLmRpc2FibGVkID8gJ25vdC1hbGxvd2VkJyA6ICdwb2ludGVyJyl9O1xuICBjb2xvcjogJHt0aGVtZWQocHJvcHMgPT4gcHJvcHMudGhlbWUudGV4dDEpfTtcbmA7XG5jb25zdCBUb2dnbGVCb3hXcmFwcGVyID0gc3R5bGVkLmRpdiBgXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgdmVydGljYWwtYWxpZ246IG1pZGRsZTtcbiAgcGFkZGluZzogJHtkaXN0YW5jZS54c21hbGx9IDA7XG5gO1xuY29uc3QgU3R5bGVkSW5wdXQgPSBzdHlsZWQuaW5wdXQgYFxuICBvcGFjaXR5OiAwO1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbmA7XG5jb25zdCBUb2dnbGVCb3ggPSBzdHlsZWQoJ2RpdicpPFRvZ2dsZUJveFByb3BzPiBgXG4gIG91dGxpbmU6IDA7XG4gIGRpc3BsYXk6IGJsb2NrO1xuICB3aWR0aDogJHtkaXN0YW5jZS54eGxhcmdlfTtcbiAgaGVpZ2h0OiAke2Rpc3RhbmNlLm1lZGl1bX07XG4gIGJvcmRlci1yYWRpdXM6ICR7ZGlzdGFuY2Uuc21hbGx9O1xuICBwb3NpdGlvbjogcmVsYXRpdmU7XG4gIGJhY2tncm91bmQ6ICR7dGhlbWVkKHByb3BzID0+IHByb3BzLnRoZW1lLnVpNCl9O1xuICB0cmFuc2l0aW9uOiBhbGwgJHt0cmFuc2l0aW9uRHVyYXRpb259ICR7dHJhbnNpdGlvbkVhc2V9O1xuYDtcbmNvbnN0IFN0eWxlZExhYmVsID0gc3R5bGVkLmxhYmVsIGBcbiAgZGlzcGxheTogYmxvY2s7XG4gIG1hcmdpbi1ib3R0b206ICR7ZGlzdGFuY2Uuc21hbGx9O1xuYDtcbmNvbnN0IFN0eWxlZERlc2MgPSBzdHlsZWQuc3BhbiBgXG4gIGRpc3BsYXk6IGlubGluZS1ibG9jaztcbiAgbWFyZ2luLWxlZnQ6ICR7ZGlzdGFuY2Uuc21hbGx9O1xuICB2ZXJ0aWNhbC1hbGlnbjogbWlkZGxlO1xuYDtcbmNvbnN0IEluZGljYXRvcktub2JTdHlsZTogUmVhY3QuQ1NTUHJvcGVydGllcyA9IHtcbiAgICB0cmFuc2Zvcm06ICd0cmFuc2xhdGUoMCwgLTUwJSknLFxufTtcbmNsYXNzIFRvZ2dsZUludCBleHRlbmRzIFJlYWN0LlB1cmVDb21wb25lbnQ8VG9nZ2xlUHJvcHMgJiBGb3JtQ29udGV4dFByb3BzLCBUb2dnbGVTdGF0ZT4ge1xuICAgIGNvbnN0cnVjdG9yKHByb3BzOiBUb2dnbGVQcm9wcykge1xuICAgICAgICBzdXBlcihwcm9wcyk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICAgICAgICBjb250cm9sbGVkOiB0eXBlb2YgcHJvcHMudmFsdWUgIT09ICd1bmRlZmluZWQnLFxuICAgICAgICAgICAgdmFsdWU6IHByb3BzLnZhbHVlIHx8IHByb3BzLmRlZmF1bHRWYWx1ZSB8fCBmYWxzZSxcbiAgICAgICAgICAgIGZvY3VzZWQ6IGZhbHNlLFxuICAgICAgICAgICAgZXJyb3I6IHByb3BzLmVycm9yLFxuICAgICAgICB9O1xuICAgIH1cbiAgICBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgICAgICAgY29uc3QgeyBmb3JtIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7IGNvbnRyb2xsZWQgfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGlmICghY29udHJvbGxlZCAmJiBmb3JtKSB7XG4gICAgICAgICAgICBmb3JtLnN1YnNjcmliZSh0aGlzKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb21wb25lbnRXaWxsVW5tb3VudCgpIHtcbiAgICAgICAgY29uc3QgeyBmb3JtIH0gPSB0aGlzLnByb3BzO1xuICAgICAgICBjb25zdCB7IGNvbnRyb2xsZWQgfSA9IHRoaXMuc3RhdGU7XG4gICAgICAgIGlmICghY29udHJvbGxlZCAmJiBmb3JtKSB7XG4gICAgICAgICAgICBmb3JtLnVuc3Vic2NyaWJlKHRoaXMpO1xuICAgICAgICB9XG4gICAgfVxuICAgIFVOU0FGRV9jb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKHsgdmFsdWUgPSBmYWxzZSwgZXJyb3IgfTogVG9nZ2xlUHJvcHMpIHtcbiAgICAgICAgaWYgKHRoaXMuc3RhdGUuY29udHJvbGxlZCkge1xuICAgICAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IHZhbHVlIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBlcnJvciB9KTtcbiAgICB9XG4gICAgcHJpdmF0ZSBjaGFuZ2VWYWx1ZSgpIHtcbiAgICAgICAgY29uc3QgeyBvbkNoYW5nZSwgZGlzYWJsZWQsIGZvcm0sIG5hbWUgPSAnJyB9ID0gdGhpcy5wcm9wcztcbiAgICAgICAgaWYgKCFkaXNhYmxlZCkge1xuICAgICAgICAgICAgY29uc3QgeyBjb250cm9sbGVkLCB2YWx1ZSB9ID0gdGhpcy5zdGF0ZTtcbiAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9ICF2YWx1ZTtcbiAgICAgICAgICAgIGlmICghY29udHJvbGxlZCkge1xuICAgICAgICAgICAgICAgIGlmIChmb3JtKSB7XG4gICAgICAgICAgICAgICAgICAgIGZvcm0uY2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogc3RhdHVzLFxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHR5cGVvZiBvbkNoYW5nZSA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgIG9uQ2hhbmdlKHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHN0YXR1cyxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwcml2YXRlIGhhbmRsZU9uQ2xpY2sgPSAoZTogUmVhY3QuTW91c2VFdmVudDxIVE1MRGl2RWxlbWVudD4pID0+IHtcbiAgICAgICAgdGhpcy5jaGFuZ2VWYWx1ZSgpO1xuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgfTtcbiAgICBwcml2YXRlIGhhbmRsZUNoZWNrYm94Q2hhbmdlID0gKCkgPT4ge1xuICAgICAgICB0aGlzLmNoYW5nZVZhbHVlKCk7XG4gICAgfTtcbiAgICBwcml2YXRlIGhhbmRsZUNoZWNrYm94Rm9jdXMgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgICAgICAgZm9jdXNlZDogdHJ1ZSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBwcml2YXRlIGhhbmRsZUNoZWNrYm94Qmx1ciA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgICAgICBmb2N1c2VkOiBmYWxzZSxcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICByZW5kZXIoKSB7XG4gICAgICAgIGNvbnN0IHsgY2hpbGRyZW4sIGRpc2FibGVkLCB0aGVtZSwgdmFsdWU6IF8wLCBkZWZhdWx0VmFsdWU6IF8xLCBvbkNoYW5nZTogXzIsIG9uSW5wdXQ6IF8zLCBpbmZvLCBsYWJlbCwgLi4ucHJvcHMgfSA9IHRoaXMucHJvcHM7XG4gICAgICAgIGNvbnN0IHsgdmFsdWUsIGZvY3VzZWQsIGVycm9yIH0gPSB0aGlzLnN0YXRlO1xuICAgICAgICBjb25zdCBjb250YWluZXJQcm9wcyA9IHtcbiAgICAgICAgICAgIC4uLnByb3BzLFxuICAgICAgICAgICAgdGhlbWUsXG4gICAgICAgICAgICBvbkNsaWNrOiB0aGlzLmhhbmRsZU9uQ2xpY2ssXG4gICAgICAgICAgICBkaXNhYmxlZCxcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgYm94UHJvcHMgPSB7XG4gICAgICAgICAgICBjaGVja2VkOiB2YWx1ZSxcbiAgICAgICAgICAgIHRoZW1lLFxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gKDxUb2dnbGVDb250YWluZXIgey4uLmNvbnRhaW5lclByb3BzfT5cbiAgICAgICAge2xhYmVsICYmIDxTdHlsZWRMYWJlbCB0aGVtZT17dGhlbWV9PntsYWJlbH08L1N0eWxlZExhYmVsPn1cbiAgICAgICAgPFRvZ2dsZUJveFdyYXBwZXI+XG4gICAgICAgICAgPFN0eWxlZElucHV0IGNoZWNrZWQ9e3ZhbHVlfSBvbkNoYW5nZT17dGhpcy5oYW5kbGVDaGVja2JveENoYW5nZX0gb25Gb2N1cz17dGhpcy5oYW5kbGVDaGVja2JveEZvY3VzfSBvbkJsdXI9e3RoaXMuaGFuZGxlQ2hlY2tib3hCbHVyfS8+XG4gICAgICAgICAgPFRvZ2dsZUJveCB7Li4uYm94UHJvcHN9PlxuICAgICAgICAgICAgPEluZGljYXRvcktub2Igc3R5bGU9e0luZGljYXRvcktub2JTdHlsZX0geD17dmFsdWUgPyAwLjUgOiAwfSBhY3RpdmU9e3ZhbHVlfSBmb2N1cz17Zm9jdXNlZH0gZGlzYWJsZWQ9e2NvbnRhaW5lclByb3BzLmRpc2FibGVkfSBhbmltYXRlLz5cbiAgICAgICAgICA8L1RvZ2dsZUJveD5cbiAgICAgICAgPC9Ub2dnbGVCb3hXcmFwcGVyPlxuICAgICAgICB7Y2hpbGRyZW4gJiYgPFN0eWxlZERlc2M+e2NoaWxkcmVufTwvU3R5bGVkRGVzYz59XG4gICAgICAgIHsoZXJyb3IgfHwgaW5mbykgJiYgKDxQYWRkZWRDb250YWluZXIgdG9wPVwieHNtYWxsXCIgYm90dG9tPVwieHNtYWxsXCI+XG4gICAgICAgICAgICA8SW5wdXROb3RpZmljYXRpb24gZXJyb3I9e2Vycm9yfSBpbmZvPXtpbmZvfS8+XG4gICAgICAgICAgPC9QYWRkZWRDb250YWluZXI+KX1cbiAgICAgIDwvVG9nZ2xlQ29udGFpbmVyPik7XG4gICAgfVxuICAgIHN0YXRpYyBpbm5lciA9IHtcbiAgICAgICAgZ2V0IFRvZ2dsZUNvbnRhaW5lcigpIHsgcmV0dXJuIFRvZ2dsZUNvbnRhaW5lciBhcyB0eXBlb2YgVG9nZ2xlQ29udGFpbmVyOyB9LFxuICAgICAgICBnZXQgU3R5bGVkTGFiZWwoKSB7IHJldHVybiBTdHlsZWRMYWJlbCBhcyB0eXBlb2YgU3R5bGVkTGFiZWw7IH0sXG4gICAgICAgIGdldCBUb2dnbGVCb3hXcmFwcGVyKCkgeyByZXR1cm4gVG9nZ2xlQm94V3JhcHBlciBhcyB0eXBlb2YgVG9nZ2xlQm94V3JhcHBlcjsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZElucHV0KCkgeyByZXR1cm4gU3R5bGVkSW5wdXQgYXMgdHlwZW9mIFN0eWxlZElucHV0OyB9LFxuICAgICAgICBnZXQgVG9nZ2xlQm94KCkgeyByZXR1cm4gVG9nZ2xlQm94IGFzIHR5cGVvZiBUb2dnbGVCb3g7IH0sXG4gICAgICAgIGdldCBJbmRpY2F0b3JLbm9iKCkgeyByZXR1cm4gSW5kaWNhdG9yS25vYiBhcyB0eXBlb2YgSW5kaWNhdG9yS25vYjsgfSxcbiAgICAgICAgZ2V0IFN0eWxlZERlc2MoKSB7IHJldHVybiBTdHlsZWREZXNjIGFzIHR5cGVvZiBTdHlsZWREZXNjOyB9LFxuICAgICAgICBnZXQgUGFkZGVkQ29udGFpbmVyKCkgeyByZXR1cm4gUGFkZGVkQ29udGFpbmVyIGFzIHR5cGVvZiBQYWRkZWRDb250YWluZXI7IH0sXG4gICAgICAgIGdldCBJbnB1dE5vdGlmaWNhdGlvbigpIHsgcmV0dXJuIElucHV0Tm90aWZpY2F0aW9uIGFzIHR5cGVvZiBJbnB1dE5vdGlmaWNhdGlvbjsgfVxuICAgIH07XG59XG4vKipcbiAqIFRoZSB0b2dnbGUgY29tcG9uZW50IGRpc3BsYXlzIGEgYnV0dG9uIHRvIHRvZ2dsZSBhIGNoZWNrZWQgc3RhdGUuXG4gKi9cbmV4cG9ydCBjb25zdCBUb2dnbGUgPSB3aXRoRm9ybUNvbnRleHQoVG9nZ2xlSW50KTtcblRvZ2dsZS5kaXNwbGF5TmFtZSA9ICdUb2dnbGUnO1xuIl19
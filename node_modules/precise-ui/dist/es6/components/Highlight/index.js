import * as React from 'react';
import styled, { themed } from '../../utils/styled';
const Highlighted = styled.span `
  background-color: ${themed(props => props.theme.highlightColor)};
`;
/**
 * Validates that the matches provided are valid, if not it will throw an error
 *
 * @param matches
 */
function validateMatches(matches) {
    let lastMatch = -1;
    if (!Array.isArray(matches)) {
        throw Error(`match must be an Array of [start, end], but provided ${JSON.stringify(matches)}`);
    }
    matches.forEach(match => {
        if (!Array.isArray(match) || match.length !== 2) {
            throw Error('match must be an Array of [start, end]');
        }
        if (!Number.isInteger(match[0]) || !Number.isInteger(match[1]) || match[0] < 0 || match[1] < 0) {
            throw Error('match [start] and [end] must be a positive integers.');
        }
        if (match[0] >= match[1]) {
            throw Error('[start] must be lower than [end].');
        }
        if (match[0] <= lastMatch) {
            throw Error('match indices cannot overlap.');
        }
        lastMatch = match[1];
    });
}
/**
 * Highlight component is meant to be a simple component to display text with highlighted search.
 * Component will render a SPAN or series of SPAN with the content and highlights
 */
export const Highlight = Object.assign((({ text, matches, highlight, ignoreCase = true, theme }) => {
    if (!matches && undefined === highlight) {
        throw new Error('You must set either indices or highlight');
    }
    if (matches) {
        validateMatches(matches);
        let lastMatch = 0;
        return (React.createElement(React.Fragment, null,
            matches.map((match, i) => {
                const r = (React.createElement(React.Fragment, { key: i },
                    React.createElement("span", null, text.substring(lastMatch, match[0])),
                    React.createElement(Highlighted, { theme: theme }, text.substring(match[0], match[1]))));
                lastMatch = match[1];
                return r;
            }),
            React.createElement("span", null, text.substring(lastMatch, text.length))));
    }
    if (highlight === '') {
        return React.createElement(React.Fragment, null, text);
    }
    // Sanitized the user input to prevent them from using RegEx patterns
    const sanitized = highlight && highlight.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    const parts = text.split(new RegExp(`(${sanitized})`, ignoreCase ? 'gi' : 'g')).filter(Boolean);
    return (React.createElement(React.Fragment, null, parts.map((part, i) => part.toLowerCase() === (highlight && highlight.toLowerCase()) ? (React.createElement(Highlighted, { theme: theme, key: i }, part)) : (React.createElement("span", { key: i }, part)))));
}), { inner: {
        get Highlighted() { return Highlighted; }
    } });
Highlight.displayName = 'Highlight';
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvY29tcG9uZW50cy9IaWdobGlnaHQvaW5kZXgudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQy9CLE9BQU8sTUFBTSxFQUFFLEVBQUUsTUFBTSxFQUFFLE1BQU0sb0JBQW9CLENBQUM7QUFxQnBELE1BQU0sV0FBVyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7c0JBQ1YsTUFBTSxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxjQUFjLENBQUM7Q0FDaEUsQ0FBQztBQUNGOzs7O0dBSUc7QUFDSCxTQUFTLGVBQWUsQ0FBQyxPQUE2QjtJQUNsRCxJQUFJLFNBQVMsR0FBRyxDQUFDLENBQUMsQ0FBQztJQUNuQixJQUFJLENBQUMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsRUFBRTtRQUN6QixNQUFNLEtBQUssQ0FBQyx3REFBd0QsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7S0FDbEc7SUFDRCxPQUFPLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFO1FBQ3BCLElBQUksQ0FBQyxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssQ0FBQyxJQUFJLEtBQUssQ0FBQyxNQUFNLEtBQUssQ0FBQyxFQUFFO1lBQzdDLE1BQU0sS0FBSyxDQUFDLHdDQUF3QyxDQUFDLENBQUM7U0FDekQ7UUFDRCxJQUFJLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksS0FBSyxDQUFDLENBQUMsQ0FBQyxHQUFHLENBQUMsSUFBSSxLQUFLLENBQUMsQ0FBQyxDQUFDLEdBQUcsQ0FBQyxFQUFFO1lB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RSxLQUFLLEVBQUU7UUFDbEMsSUFBSSxXQUFXLEtBQUssT0FBTyxXQUFpQyxDQUFDLENBQUMsQ0FBQztLQUNsRSxFQUFFLENBQUMsQ0FBQztBQUNULFNBQVMsQ0FBQyxXQUFXLEdBQUcsV0FBVyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHN0eWxlZCwgeyB0aGVtZWQgfSBmcm9tICcuLi8uLi91dGlscy9zdHlsZWQnO1xuaW1wb3J0IHsgU3RhbmRhcmRQcm9wcyB9IGZyb20gJy4uLy4uL2NvbW1vbic7XG5leHBvcnQgaW50ZXJmYWNlIEhpZ2hsaWdodFByb3BzIGV4dGVuZHMgU3RhbmRhcmRQcm9wcyB7XG4gICAgLyoqXG4gICAgICogU3RyaW5nIHRoYXQgbmVlZHMgdG8gYmUgcmVuZGVyZWRcbiAgICAgKi9cbiAgICB0ZXh0OiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogU3RyaW5nIHRoYXQgbmVlZHMgdG8gYmUgaGlnaGxpZ2h0ZWRcbiAgICAgKi9cbiAgICBoaWdobGlnaHQ/OiBzdHJpbmc7XG4gICAgLyoqXG4gICAgICogQXJyYXkgdGhhdCBkZWZpbmVzIHRoZSBpbmRpY2VzIHRvIGhpZ2hsaWdodCwgZWFjaCBlbGVtZW50IGlzIGFuIGFycmF5IG9mIFtzdGFydCwgZW5kXVxuICAgICAqIEluIGNhc2UgdGhpcyBpcyBwcm9jaWRlZCB0aGVuIGhpZ2hsaWdodCB3aWxsIGJlIGlnbm9yZWQuXG4gICAgICovXG4gICAgbWF0Y2hlcz86IEFycmF5PEFycmF5PG51bWJlcj4+O1xuICAgIC8qKlxuICAgICAqIERlZmluZXMgaWYgdGhlIHNlYXJjaCB3aWxsIGJlIGNhc2UgaW5zZW5zaXRpdmVcbiAgICAgKi9cbiAgICBpZ25vcmVDYXNlPzogYm9vbGVhbjtcbn1cbmNvbnN0IEhpZ2hsaWdodGVkID0gc3R5bGVkLnNwYW4gYFxuICBiYWNrZ3JvdW5kLWNvbG9yOiAke3RoZW1lZChwcm9wcyA9PiBwcm9wcy50aGVtZS5oaWdobGlnaHRDb2xvcil9O1xuYDtcbi8qKlxuICogVmFsaWRhdGVzIHRoYXQgdGhlIG1hdGNoZXMgcHJvdmlkZWQgYXJlIHZhbGlkLCBpZiBub3QgaXQgd2lsbCB0aHJvdyBhbiBlcnJvclxuICpcbiAqIEBwYXJhbSBtYXRjaGVzXG4gKi9cbmZ1bmN0aW9uIHZhbGlkYXRlTWF0Y2hlcyhtYXRjaGVzOiBBcnJheTxBcnJheTxudW1iZXI+Pikge1xuICAgIGxldCBsYXN0TWF0Y2ggPSAtMTtcbiAgICBpZiAoIUFycmF5LmlzQXJyYXkobWF0Y2hlcykpIHtcbiAgICAgICAgdGhyb3cgRXJyb3IoYG1hdGNoIG11c3QgYmUgYW4gQXJyYXkgb2YgW3N0YXJ0LCBlbmRdLCBidXQgcHJvdmlkZWQgJHtKU09OLnN0cmluZ2lmeShtYXRjaGVzKX1gKTtcbiAgICB9XG4gICAgbWF0Y2hlcy5mb3JFYWNoKG1hdGNoID0+IHtcbiAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG1hdGNoKSB8fCBtYXRjaC5sZW5ndGggIT09IDIpIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdtYXRjaCBtdXN0IGJlIGFuIEFycmF5IG9mIFtzdGFydCwgZW5kXScpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghTnVtYmVyLmlzSW50ZWdlcihtYXRjaFswXSkgfHwgIU51bWJlci5pc0ludGVnZXIobWF0Y2hbMV0pIHx8IG1hdGNoWzBdIDwgMCB8fCBtYXRjaFsxXSA8IDApIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKCdtYXRjaCBbc3RhcnRdIGFuZCBbZW5kXSBtdXN0IGJlIGEgcG9zaXRpdmUgaW50ZWdlcnMuJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hdGNoWzBdID49IG1hdGNoWzFdKSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcignW3N0YXJ0XSBtdXN0IGJlIGxvd2VyIHRoYW4gW2VuZF0uJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG1hdGNoWzBdIDw9IGxhc3RNYXRjaCkge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoJ21hdGNoIGluZGljZXMgY2Fubm90IG92ZXJsYXAuJyk7XG4gICAgICAgIH1cbiAgICAgICAgbGFzdE1hdGNoID0gbWF0Y2hbMV07XG4gICAgfSk7XG59XG4vKipcbiAqIEhpZ2hsaWdodCBjb21wb25lbnQgaXMgbWVhbnQgdG8gYmUgYSBzaW1wbGUgY29tcG9uZW50IHRvIGRpc3BsYXkgdGV4dCB3aXRoIGhpZ2hsaWdodGVkIHNlYXJjaC5cbiAqIENvbXBvbmVudCB3aWxsIHJlbmRlciBhIFNQQU4gb3Igc2VyaWVzIG9mIFNQQU4gd2l0aCB0aGUgY29udGVudCBhbmQgaGlnaGxpZ2h0c1xuICovXG5leHBvcnQgY29uc3QgSGlnaGxpZ2h0ID0gT2JqZWN0LmFzc2lnbigoKCh7IHRleHQsIG1hdGNoZXMsIGhpZ2hsaWdodCwgaWdub3JlQ2FzZSA9IHRydWUsIHRoZW1lIH0pID0+IHtcbiAgICBpZiAoIW1hdGNoZXMgJiYgdW5kZWZpbmVkID09PSBoaWdobGlnaHQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdZb3UgbXVzdCBzZXQgZWl0aGVyIGluZGljZXMgb3IgaGlnaGxpZ2h0Jyk7XG4gICAgfVxuICAgIGlmIChtYXRjaGVzKSB7XG4gICAgICAgIHZhbGlkYXRlTWF0Y2hlcyhtYXRjaGVzKTtcbiAgICAgICAgbGV0IGxhc3RNYXRjaCA9IDA7XG4gICAgICAgIHJldHVybiAoPD5cbiAgICAgICAge21hdGNoZXMubWFwKChtYXRjaCwgaSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgciA9ICg8UmVhY3QuRnJhZ21lbnQga2V5PXtpfT5cbiAgICAgICAgICAgICAgPHNwYW4+e3RleHQuc3Vic3RyaW5nKGxhc3RNYXRjaCwgbWF0Y2hbMF0pfTwvc3Bhbj5cbiAgICAgICAgICAgICAgPEhpZ2hsaWdodGVkIHRoZW1lPXt0aGVtZX0+e3RleHQuc3Vic3RyaW5nKG1hdGNoWzBdLCBtYXRjaFsxXSl9PC9IaWdobGlnaHRlZD5cbiAgICAgICAgICAgIDwvUmVhY3QuRnJhZ21lbnQ+KTtcbiAgICAgICAgICAgIGxhc3RNYXRjaCA9IG1hdGNoWzFdO1xuICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgIH0pfVxuICAgICAgICA8c3Bhbj57dGV4dC5zdWJzdHJpbmcobGFzdE1hdGNoLCB0ZXh0Lmxlbmd0aCl9PC9zcGFuPlxuICAgICAgPC8+KTtcbiAgICB9XG4gICAgaWYgKGhpZ2hsaWdodCA9PT0gJycpIHtcbiAgICAgICAgcmV0dXJuIDw+e3RleHR9PC8+O1xuICAgIH1cbiAgICAvLyBTYW5pdGl6ZWQgdGhlIHVzZXIgaW5wdXQgdG8gcHJldmVudCB0aGVtIGZyb20gdXNpbmcgUmVnRXggcGF0dGVybnNcbiAgICBjb25zdCBzYW5pdGl6ZWQgPSBoaWdobGlnaHQgJiYgaGlnaGxpZ2h0LnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyk7XG4gICAgY29uc3QgcGFydHMgPSB0ZXh0LnNwbGl0KG5ldyBSZWdFeHAoYCgke3Nhbml0aXplZH0pYCwgaWdub3JlQ2FzZSA/ICdnaScgOiAnZycpKS5maWx0ZXIoQm9vbGVhbik7XG4gICAgcmV0dXJuICg8PlxuICAgICAge3BhcnRzLm1hcCgocGFydCwgaSkgPT4gcGFydC50b0xvd2VyQ2FzZSgpID09PSAoaGlnaGxpZ2h0ICYmIGhpZ2hsaWdodC50b0xvd2VyQ2FzZSgpKSA/ICg8SGlnaGxpZ2h0ZWQgdGhlbWU9e3RoZW1lfSBrZXk9e2l9PlxuICAgICAgICAgICAge3BhcnR9XG4gICAgICAgICAgPC9IaWdobGlnaHRlZD4pIDogKDxzcGFuIGtleT17aX0+e3BhcnR9PC9zcGFuPikpfVxuICAgIDwvPik7XG59KSBhcyBSZWFjdC5GQzxIaWdobGlnaHRQcm9wcz4pLCB7IGlubmVyOiB7XG4gICAgICAgIGdldCBIaWdobGlnaHRlZCgpIHsgcmV0dXJuIEhpZ2hsaWdodGVkIGFzIHR5cGVvZiBIaWdobGlnaHRlZDsgfVxuICAgIH0gfSk7XG5IaWdobGlnaHQuZGlzcGxheU5hbWUgPSAnSGlnaGxpZ2h0JztcbiJdfQ==
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)
            t[p[i]] = s[p[i]];
    return t;
};
import * as React from 'react';
import styled, { themed } from '../../utils/styled';
import { ListItemNumber } from './StepIndicatorShared.part';
import { distance } from '../../distance';
import { getFontStyle } from '../../textStyles';
const StyledProgressHost = styled.ol `
  width: 100%;
  display: table;
  table-layout: fixed;
  padding: 0;
  margin: 0;
  height: 4em;
  box-sizing: border-box;
  padding-left: ${distance.medium};
`;
const HorizontalNumber = styled(ListItemNumber) `
  top: ${distance.small};
  left: -12px;
`;
const StyledProgressStep = styled.li `
  display: table-cell;
  text-align: center;
  vertical-align: top;
  position: relative;
  color: ${themed(({ theme }) => theme.text1)};

  &:before {
    content: '';
    display: block;
    border-radius: 50%;
    margin: 1em auto;
    width: ${distance.small};
    height: ${distance.small};
    position: relative;
    left: -50%;
    z-index: 1;
    background-color: ${themed(({ theme }) => theme.text1)};
  }

  &:not(:first-child):after {
    content: '';
    position: absolute;
    top: 19px;
    left: -100%;
    width: 100%;
    height: 2px;
    background-color: ${themed(({ theme }) => theme.text1)};
  }

  &.step-active {
    ${getFontStyle({ weight: 'medium' })}
    
    color: ${themed(({ theme }) => theme.text1)};

    ~ li {
      color: ${themed(({ theme }) => theme.text2)};

      &:before {
        background-color: ${themed(({ theme }) => theme.text2)};
      }

      &:after {
        background-color: ${themed(({ theme }) => theme.text2)};
      }
    }

    &:before {
      background-color: ${themed(({ theme }) => theme.ui1)};
      border: 0.5em solid ${themed(({ theme }) => theme.text1)};
      margin: 0.5em auto;
    }
  }
`;
const StyledProgressText = styled.div `
  display: inline-block;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
  position: absolute;
  left: 0;
  top: 2.5em;
`;
function createStep(header, i, active, numbered, theme) {
    return (React.createElement(StyledProgressStep, { theme: theme, key: i, className: active ? 'step-active' : '' },
        numbered && React.createElement(HorizontalNumber, { theme: theme }, i + 1),
        React.createElement(StyledProgressText, { theme: theme }, header)));
}
function getHeaders(steps, current, numbered, theme) {
    const items = steps.map((step, i) => createStep(step, i, i === current, numbered, theme));
    return {
        items,
        content: undefined,
    };
}
function getContent(children, current, numbered, theme) {
    const items = [];
    let content = undefined;
    React.Children.forEach(children, (element, i) => {
        if (element && React.isValidElement(element)) {
            const { header, children } = element.props;
            const active = i === current;
            items.push(createStep(header, i, active, numbered, theme));
            if (active) {
                content = children;
            }
        }
    });
    return {
        items,
        content,
    };
}
export const StepIndicatorHorizontal = Object.assign(((_a) => {
    var { theme, steps, current = 0, numbered, children } = _a, props = __rest(_a, ["theme", "steps", "current", "numbered", "children"]);
    const { items, content } = steps !== undefined ? getHeaders(steps, current, numbered, theme) : getContent(children, current, numbered, theme);
    return (React.createElement("div", Object.assign({}, props),
        React.createElement(StyledProgressHost, { theme: theme }, items),
        content));
}), { inner: {
        get StyledProgressHost() { return StyledProgressHost; }
    } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RlcEluZGljYXRvckhvcml6b250YWwucGFydC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL1N0ZXBJbmRpY2F0b3IvU3RlcEluZGljYXRvckhvcml6b250YWwucGFydC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUEsT0FBTyxLQUFLLEtBQUssTUFBTSxPQUFPLENBQUM7QUFDL0IsT0FBTyxNQUFNLEVBQUUsRUFBRSxNQUFNLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUVwRCxPQUFPLEVBQUUsY0FBYyxFQUFFLE1BQU0sNEJBQTRCLENBQUM7QUFFNUQsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQzFDLE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNoRCxNQUFNLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUM7Ozs7Ozs7O2tCQVFuQixRQUFRLENBQUMsTUFBTTtDQUNoQyxDQUFDO0FBQ0YsTUFBTSxnQkFBZ0IsR0FBRyxNQUFNLENBQUMsY0FBYyxDQUFDLENBQUM7U0FDdkMsUUFBUSxDQUFDLEtBQUs7O0NBRXRCLENBQUM7QUFDRixNQUFNLGtCQUFrQixHQUFHLE1BQU0sQ0FBQyxFQUFFLENBQUM7Ozs7O1dBSzFCLE1BQU0sQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUM7Ozs7Ozs7YUFPaEMsUUFBUSxDQUFDLEtBQUs7Y0FDYixRQUFRLENBQUMsS0FBSzs7Ozt3QkFJSixNQUFNLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDOzs7Ozs7Ozs7O3dCQVVsQyxNQUFNLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDOzs7O01BSXBELFlB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TSxDQUFDLE1BQU0sQ0FBRSxDQUFDLENBQUMsRUFBMkQsRUFBRSxFQUFFO1FBQS9ELEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxPQUFPLEdBQUcsQ0FBQyxFQUFFLFFBQVEsRUFBRSxRQUFRLE9BQVksRUFBVix5RUFBUTtJQUM3RyxNQUFNLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxHQUFHLEtBQUssS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsT0FBTyxFQUFFLFFBQVEsRUFBRSxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsVUFBVSxDQUFDLFFBQVEsRUFBRSxPQUFPLEVBQUUsUUFBUSxFQUFFLEtBQUssQ0FBQyxDQUFDO0lBQzlJLE9BQU8sQ0FBQyw2Q0FBUyxLQUFLO1FBQ3BCLG9CQUFDLGtCQUFrQixJQUFDLEtBQUssRUFBRSxLQUFLLElBQUcsS0FBSyxDQUFzQjtRQUM3RCxPQUFPLENBQ0osQ0FBQyxDQUFDO0FBQ1osQ0FBQyxDQUFtQyxFQUFFLEVBQUUsS0FBSyxFQUFFO1FBQ3ZDLElBQUksa0JBQWtCLEtBQUssT0FBTyxrQkFBK0MsQ0FBQyxDQUFDLENBQUM7S0FDdkYsRUFBRSxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBSZWFjdCBmcm9tICdyZWFjdCc7XG5pbXBvcnQgc3R5bGVkLCB7IHRoZW1lZCB9IGZyb20gJy4uLy4uL3V0aWxzL3N0eWxlZCc7XG5pbXBvcnQgeyBTdGVwSW5kaWNhdG9yUHJvcHMsIFN0ZXBJbmRpY2F0b3JTdGVwUHJvcHMgfSBmcm9tICcuL1N0ZXBJbmRpY2F0b3IudHlwZXMucGFydCc7XG5pbXBvcnQgeyBMaXN0SXRlbU51bWJlciB9IGZyb20gJy4vU3RlcEluZGljYXRvclNoYXJlZC5wYXJ0JztcbmltcG9ydCB7IFByZWNpc2VUaGVtZSB9IGZyb20gJy4uLy4uL2NvbW1vbic7XG5pbXBvcnQgeyBkaXN0YW5jZSB9IGZyb20gJy4uLy4uL2Rpc3RhbmNlJztcbmltcG9ydCB7IGdldEZvbnRTdHlsZSB9IGZyb20gJy4uLy4uL3RleHRTdHlsZXMnO1xuY29uc3QgU3R5bGVkUHJvZ3Jlc3NIb3N0ID0gc3R5bGVkLm9sIGBcbiAgd2lkdGg6IDEwMCU7XG4gIGRpc3BsYXk6IHRhYmxlO1xuICB0YWJsZS1sYXlvdXQ6IGZpeGVkO1xuICBwYWRkaW5nOiAwO1xuICBtYXJnaW46IDA7XG4gIGhlaWdodDogNGVtO1xuICBib3gtc2l6aW5nOiBib3JkZXItYm94O1xuICBwYWRkaW5nLWxlZnQ6ICR7ZGlzdGFuY2UubWVkaXVtfTtcbmA7XG5jb25zdCBIb3Jpem9udGFsTnVtYmVyID0gc3R5bGVkKExpc3RJdGVtTnVtYmVyKSBgXG4gIHRvcDogJHtkaXN0YW5jZS5zbWFsbH07XG4gIGxlZnQ6IC0xMnB4O1xuYDtcbmNvbnN0IFN0eWxlZFByb2dyZXNzU3RlcCA9IHN0eWxlZC5saSBgXG4gIGRpc3BsYXk6IHRhYmxlLWNlbGw7XG4gIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgdmVydGljYWwtYWxpZ246IHRvcDtcbiAgcG9zaXRpb246IHJlbGF0aXZlO1xuICBjb2xvcjogJHt0aGVtZWQoKHsgdGhlbWUgfSkgPT4gdGhlbWUudGV4dDEpfTtcblxuICAmOmJlZm9yZSB7XG4gICAgY29udGVudDogJyc7XG4gICAgZGlzcGxheTogYmxvY2s7XG4gICAgYm9yZGVyLXJhZGl1czogNTAlO1xuICAgIG1hcmdpbjogMWVtIGF1dG87XG4gICAgd2lkdGg6ICR7ZGlzdGFuY2Uuc21hbGx9O1xuICAgIGhlaWdodDogJHtkaXN0YW5jZS5zbWFsbH07XG4gICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgIGxlZnQ6IC01MCU7XG4gICAgei1pbmRleDogMTtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke3RoZW1lZCgoeyB0aGVtZSB9KSA9PiB0aGVtZS50ZXh0MSl9O1xuICB9XG5cbiAgJjpub3QoOmZpcnN0LWNoaWxkKTphZnRlciB7XG4gICAgY29udGVudDogJyc7XG4gICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgIHRvcDogMTlweDtcbiAgICBsZWZ0OiAtMTAwJTtcbiAgICB3aWR0aDogMTAwJTtcbiAgICBoZWlnaHQ6IDJweDtcbiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke3RoZW1lZCgoeyB0aGVtZSB9KSA9PiB0aGVtZS50ZXh0MSl9O1xuICB9XG5cbiAgJi5zdGVwLWFjdGl2ZSB7XG4gICAgJHtnZXRGb250U3R5bGUoeyB3ZWlnaHQ6ICdtZWRpdW0nIH0pfVxuICAgIFxuICAgIGNvbG9yOiAke3RoZW1lZCgoeyB0aGVtZSB9KSA9PiB0aGVtZS50ZXh0MSl9O1xuXG4gICAgfiBsaSB7XG4gICAgICBjb2xvcjogJHt0aGVtZWQoKHsgdGhlbWUgfSkgPT4gdGhlbWUudGV4dDIpfTtcblxuICAgICAgJjpiZWZvcmUge1xuICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke3RoZW1lZCgoeyB0aGVtZSB9KSA9PiB0aGVtZS50ZXh0Mil9O1xuICAgICAgfVxuXG4gICAgICAmOmFmdGVyIHtcbiAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogJHt0aGVtZWQoKHsgdGhlbWUgfSkgPT4gdGhlbWUudGV4dDIpfTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAmOmJlZm9yZSB7XG4gICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAke3RoZW1lZCgoeyB0aGVtZSB9KSA9PiB0aGVtZS51aTEpfTtcbiAgICAgIGJvcmRlcjogMC41ZW0gc29saWQgJHt0aGVtZWQoKHsgdGhlbWUgfSkgPT4gdGhlbWUudGV4dDEpfTtcbiAgICAgIG1hcmdpbjogMC41ZW0gYXV0bztcbiAgICB9XG4gIH1cbmA7XG5jb25zdCBTdHlsZWRQcm9ncmVzc1RleHQgPSBzdHlsZWQuZGl2IGBcbiAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICBvdmVyZmxvdzogaGlkZGVuO1xuICB3aGl0ZS1zcGFjZTogbm93cmFwO1xuICB0ZXh0LW92ZXJmbG93OiBlbGxpcHNpcztcbiAgcG9zaXRpb246IGFic29sdXRlO1xuICBsZWZ0OiAwO1xuICB0b3A6IDIuNWVtO1xuYDtcbmZ1bmN0aW9uIGNyZWF0ZVN0ZXAoaGVhZGVyOiBSZWFjdC5SZWFjdE5vZGUsIGk6IG51bWJlciwgYWN0aXZlOiBib29sZWFuLCBudW1iZXJlZD86IGJvb2xlYW4sIHRoZW1lPzogUHJlY2lzZVRoZW1lKSB7XG4gICAgcmV0dXJuICg8U3R5bGVkUHJvZ3Jlc3NTdGVwIHRoZW1lPXt0aGVtZX0ga2V5PXtpfSBjbGFzc05hbWU9e2FjdGl2ZSA/ICdzdGVwLWFjdGl2ZScgOiAnJ30+XG4gICAgICB7bnVtYmVyZWQgJiYgPEhvcml6b250YWxOdW1iZXIgdGhlbWU9e3RoZW1lfT57aSArIDF9PC9Ib3Jpem9udGFsTnVtYmVyPn1cbiAgICAgIDxTdHlsZWRQcm9ncmVzc1RleHQgdGhlbWU9e3RoZW1lfT57aGVhZGVyfTwvU3R5bGVkUHJvZ3Jlc3NUZXh0PlxuICAgIDwvU3R5bGVkUHJvZ3Jlc3NTdGVwPik7XG59XG5mdW5jdGlvbiBnZXRIZWFkZXJzKHN0ZXBzOiBBcnJheTxSZWFjdC5SZWFjdE5vZGU+LCBjdXJyZW50OiBudW1iZXIsIG51bWJlcmVkPzogYm9vbGVhbiwgdGhlbWU/OiBQcmVjaXNlVGhlbWUpIHtcbiAgICBjb25zdCBpdGVtcyA9IHN0ZXBzLm1hcCgoc3RlcCwgaSkgPT4gY3JlYXRlU3RlcChzdGVwLCBpLCBpID09PSBjdXJyZW50LCBudW1iZXJlZCwgdGhlbWUpKTtcbiAgICByZXR1cm4ge1xuICAgICAgICBpdGVtcyxcbiAgICAgICAgY29udGVudDogdW5kZWZpbmVkLFxuICAgIH07XG59XG5mdW5jdGlvbiBnZXRDb250ZW50KGNoaWxkcmVuOiBSZWFjdC5SZWFjdE5vZGUsIGN1cnJlbnQ6IG51bWJlciwgbnVtYmVyZWQ/OiBib29sZWFuLCB0aGVtZT86IFByZWNpc2VUaGVtZSkge1xuICAgIGNvbnN0IGl0ZW1zOiBBcnJheTxSZWFjdC5SZWFjdENoaWxkPiA9IFtdO1xuICAgIGxldCBjb250ZW50OiBSZWFjdC5SZWFjdE5vZGUgPSB1bmRlZmluZWQ7XG4gICAgUmVhY3QuQ2hpbGRyZW4uZm9yRWFjaChjaGlsZHJlbiwgKGVsZW1lbnQ6IFJlYWN0LlJlYWN0RWxlbWVudDxTdGVwSW5kaWNhdG9yU3RlcFByb3BzPiwgaSkgPT4ge1xuICAgICAgICBpZiAoZWxlbWVudCAmJiBSZWFjdC5pc1ZhbGlkRWxlbWVudChlbGVtZW50KSkge1xuICAgICAgICAgICAgY29uc3QgeyBoZWFkZXIsIGNoaWxkcmVuIH0gPSBlbGVtZW50LnByb3BzO1xuICAgICAgICAgICAgY29uc3QgYWN0aXZlID0gaSA9PT0gY3VycmVudDtcbiAgICAgICAgICAgIGl0ZW1zLnB1c2goY3JlYXRlU3RlcChoZWFkZXIsIGksIGFjdGl2ZSwgbnVtYmVyZWQsIHRoZW1lKSk7XG4gICAgICAgICAgICBpZiAoYWN0aXZlKSB7XG4gICAgICAgICAgICAgICAgY29udGVudCA9IGNoaWxkcmVuO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgaXRlbXMsXG4gICAgICAgIGNvbnRlbnQsXG4gICAgfTtcbn1cbmV4cG9ydCBjb25zdCBTdGVwSW5kaWNhdG9ySG9yaXpvbnRhbCA9IE9iamVjdC5hc3NpZ24oKCgoeyB0aGVtZSwgc3RlcHMsIGN1cnJlbnQgPSAwLCBudW1iZXJlZCwgY2hpbGRyZW4sIC4uLnByb3BzIH0pID0+IHtcbiAgICBjb25zdCB7IGl0ZW1zLCBjb250ZW50IH0gPSBzdGVwcyAhPT0gdW5kZWZpbmVkID8gZ2V0SGVhZGVycyhzdGVwcywgY3VycmVudCwgbnVtYmVyZWQsIHRoZW1lKSA6IGdldENvbnRlbnQoY2hpbGRyZW4sIGN1cnJlbnQsIG51bWJlcmVkLCB0aGVtZSk7XG4gICAgcmV0dXJuICg8ZGl2IHsuLi5wcm9wc30+XG4gICAgICA8U3R5bGVkUHJvZ3Jlc3NIb3N0IHRoZW1lPXt0aGVtZX0+e2l0ZW1zfTwvU3R5bGVkUHJvZ3Jlc3NIb3N0PlxuICAgICAge2NvbnRlbnR9XG4gICAgPC9kaXY+KTtcbn0pIGFzIFJlYWN0LlNGQzxTdGVwSW5kaWNhdG9yUHJvcHM+KSwgeyBpbm5lcjoge1xuICAgICAgICBnZXQgU3R5bGVkUHJvZ3Jlc3NIb3N0KCkgeyByZXR1cm4gU3R5bGVkUHJvZ3Jlc3NIb3N0IGFzIHR5cGVvZiBTdHlsZWRQcm9ncmVzc0hvc3Q7IH1cbiAgICB9IH0pO1xuIl19